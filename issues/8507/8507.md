# Ein DFÜ-Boom [8]

Die Datenübertragung kommt in Schwung: Unsere Marktübersicht zeigt, wie reichhaltig das Angebot an Akustikkopplern innerhalb eines Jahres geworden ist. Ab etwa 300 Mark gibt es jetzt Geräte mit FTZ-Nummer, beziehungsweise offizieller Zulassung durch die Bundespost — also Geräte, die nicht nur erschwinglich sind, sondern die man auch guten Gewissens benutzen kann.

Parallel dazu gibt es erfreulicherweise auch ein ausreichendes Angebot an brauchbarer Datenübertragungssoftware.

Unser Wettbewerb — das Ergebnis finden Sie in dieser Ausgabe — brachte ein sehr komfortables Terminalprogramm, das auch das Laden von Programmen aus einer Mailbox ermöglicht. An diesem Beispiel ist aber auch zu sehen, wie schnell die Entwicklung voranschreitet: Vor drei oder vier Monaten hätte dieses in Basic geschriebene Programm noch voll mit der kommerziell angebotenen Software konkurrieren können. Heute sind die um etwa 150 Mark käuflichen, in Maschinensprache geschriebenen Standardprogramme (oft inklusive Interface) schneller, sicherer und mit mehr Menüpunkten ausgestattet.

Obwohl man sich also ein gutes Terminalprogramm einfach abtippen kann, lohnt es sich immer noch, als Alternative einen Kauf in die Überlegungen einzubeziehen. Auf beiden Gebieten haben Privatleute — bei den Akustikkopplern die Bastler, bei der DFÜ-Software die Programmierer — mit ihren Produkten die kommerziellen Anbieter immer wieder so unter Druck gesetzt, daß zügig sowohl die Preise gesunken als auch die Leistungen gestiegen sind. Es ist zu hoffen, daß dieser produktive Wettbewerb nicht unnötig durch die Postvorschriften gebremst wird.

Michael Pauly, Chefredakteur

# Hannover-Messe [8-9,11]

> Die Hannover-Messe '85 bot einige interessante Neuigkeiten bei Btx, Drucker und Floppy.

Die Teilnehmerzahlen bei Btx liegen weit hinter den Erwartungen der Post zurück. Ein neues, preislich äußerst attraktives Modul für den C 64 könnte möglicherweise den Durchbruch schaffen. Noch nicht offiziell, aber hinter verschlossenen Türen war auf der Hannover-Messe ein Steckdecoder für den C 64 zu sehen, der bei einem Preis von 700 Mark den teueren Btx-fähigen Fernseher und den Decoder ersetzt.

Das Dilemma der verzögerten Einführung von preiswerten Btx-Konsumentengeräten liegt in einem einzigen integriertem Baustein, dem Eurom-Chip. Fast alle Hersteller haben sich bei der Konzeption ihrer Btx-Anlage auf diesen von Valvo zu entwicklenden Chip konzentriert. Bei der jüngsten Eurom-Generation konnten zwar die Darstellungs-Fehler früherer Serien behoben werden. Gleichzeitig aber ist ein neues Problem aufgetaucht: Die aktuelle Serie ist außerordentlich wärmeempfindlich. Wenn es diesen Chips — was sehr schnell geschehen soll — zu warm wird, kann von verläßlicher Funktion nicht mehr die Rede sein.

Durch diese anhaltende Eurom-Verzögerung gibt es bei Konsumentengeräten weiterhin nur zwei Anbieter: Blaupunkt und Loewe Opta. Auch wenn der Chipsatz wie geplant zur Verfügung stünde, die erhofften Preisvorteile würde er einstweilen nicht bringen. Die Preiserwartungen der Hersteller liegen durch die Bank bei einem Aufpreis zwischen 1200 und 1400 Mark für Btx-fähige Fernsehgeräte.

Anders sieht der Sachverhalt für C 64-Besitzer aus.

Technofor stellte den Prototyp ihres Btx-Steckdecoders auf der Hannover-Messe vor ausgewähltem Publikum vor. Es handelt sich dabei um einen vollständigen Decoder nach dem neuesten CEPT-Standard im Modulgehäuse.

Der Decoder besteht aus einer komplexen Videologik und 64 KByte dynamischen RAM. Register und RAM werden über die I/O-Kanäle bedient. Für Telesoftware soll der gesamte Computer zu Verfügung stehen. Außer dem C 64 und dem Steckdecoder braucht man noch eine Anschlußbox der Post (monatliche Gebühren von 8 Mark) oder einen Btx-fähigen Akustikkoppler.

Die abgerufenen Seiten können auf einem handelsüblichen Farbfernsehgerät oder einem Farbmonitor (beispielsweise dem 1701/ 1702) dargestellt werden. In Zusammenhang mit dem Decoder können alle Schnittstellen und Peripheriegeräte des C 64 benutzt werden. Es ist zum Beispiel möglich, sich Seiten auf Diskette zu überspielen und später wieder anzuschauen oder Batch-Aufrufe (zum Beispiel Wahlprozeduren etc.) wiederholt von der Diskette zu laden und zu starten.

Das Decodermodul ist Telesoftware-fähig (siehe dazu unseren Wettbewerb in der letzten Ausgabe). Software kann so von kommerziellen Anbietern zur ein- oder mehrmaligen Benutzung bezogen werden, oder auch zwischen Btx-Teilnehmern untereinander ausgetauscht werden. Im Herbst, wenn die Entwicklung zweier spezieller Chips abgeschlossen ist, kann der Preis für das Decodermodul nach Angaben des Herstellers unter 500 Mark sinken.

Zusätzlich soll dieses Modul die Auflösung des C 64 auf 480 (600)x240 Punkte verbessern. Zudem kann es als RAM-Floppy eingesetzt werden. Gerade durch die große Verbreitung des C 64 und dem günstigen Anschaffungspreis des Steckdecoders könnte hier die notwendige Initialzündung für eine weite Verbreitung von Btx gegeben werden.

## Drucker

Auch bei den Druckern gab es auf der Messe einiges Neues zu bestaunen. Es waren sogar Trends zu erkennen. Die Plotter gehen eine Symbiose mit Schreibmaschinen ein (Bild 1). Panasonic und Silver Reed stellten jeweils entsprechende Modelle vor. Mit vier hochwertigen Kugelschreiberminen schreiben die Printer-Plotter in vier Farben Texte und Grafiken, die auch miteinander mischbar sind.

Silver Reed stellte beispielsweise den Printer-Plotter EB50 vor. Der EB50 besitzt eine Centronics-Schnittstelle und ist somit mit einem Interface an den C 64 anschließbar. Auf einem 16-Zeichen-Display kann die Eingabe vor dem Druck kontrolliert werden. Schriftarten sind Courier und Italic, in drei verschiedenen Größen mit automatischer Unterstreichung. Auch Balken-Kurven- und Kuchendiagramme können (auch hier in drei Größen) mit einfachem Tastendruck gezeichnet werden. Der Speicher für diese Grafik hat Platz für 12 Zahlen, also zum Beispiel ausreichend für eine Jahresbilanz. Verarbeitet wird normales DIN-A4-Papier. Zu haben ist der EB50 für ungefähr 800 Mark.

Der Panasonic Printer-Plotter RK-P400C unterscheidet sich vom EB50 unter anderem durch eine 24stellige LCD-Anzeige, 10 verschiedenen Zeichengrößen, einer RS232C-Schnittstelle (ein Kabel zum Anschluß an den C 64 ist auch erhältlich) und einem Preis von 998 Mark inklusive Mehrwertsteuer.

Microscan stellte den neuen Matrixdrucker Seikosha SP-1000VC vor (Bild 2). Seme Daten: direkt anschließbar an den C 64 und die anderen Commodore-Computer (ein Kabel wird mitgeliefert). Wie schon bekannt von Seikosha, besteht eine volle Kompatibilität zum C 64, das heißt, sämtliche Steuerzeichen einschließlich Blockgrafik sowie eigendefinierte Grafik bedeuten keine Probleme beim SP-1000VC. Er beherrscht 10 verschiedene Schriftarten, mit 100 Zeichen pro Sekunde im Normaldruck und bis zu 20 Zeichen pro Sekunde bei Korrespondenzqualität (NLQ = Near Letter Quality). Eine Grafikauflösung bis 1920 Punkte pro Zeile, Druckweg-Optimierung und bidirektionalem Druck sowie Traktor- und Friktionsantrieb sind hervorzuheben. Wichtige Funktionen wie Selbsttest, Zeilen- und Seitenvorschub, linke und rechte Randbegrenzung, Korrespondenz- und Normaldruck, automatischer Einzelblatteinzug sind über die Bediener-Tastatur leicht anzuwählen. Sein Preis: 899 Mark inklusive Mehrwertsteuer.

Es ist bezeichnend, daß immer mehr Druckerhersteller mittlerweile Drucker mit direktem Anschluß an den C 64 anbieten. So zum Beispiel Star, Epson, Quen-Data, Brother und C.Itoh.

Star präsentierte aus seiner neuen Druckerpalette den SG-10C mit Commodore-Anschluß (Bild 3): Geschwindigkeit: 120 Zeichen pro Sekunde, bidirektional und druckwegoptimiert. Zeichensätze: . Schönschrift (NLQ), je 192 Normal- und Grafikzeichen, je 90 Italic- und NLQ-Zeichen und ein frei definierbares Zeichen. Der SG-10C ist voll grafikfähig, mit einer Auflösung von 7x60 Punkte pro Zoll. Doppelt- und dreifachbreiter Druck ist ebenso möglich wie Schmalschrift und reverse Schrift. Die Papierführung ist für Einzelblatt und Endlospapier ausgelegt. Der Preis des SG-10C: Etwas mehr als 1000 Mark.

Mit dem neuen Matrixdrucker GX-80 liefert Epson einen leistungsfähigen und mit unter 1000 Mark auch preiswerten Drucker (Bild 4). Der GX-80 benötigt kein spezielles Interface mehr, sondern ist mit Hilfe von ROM-Modulen bereits fertig an den betreffenden Computer, unter anderem an den C 64, angepaßt. Seine Daten: 100 Zeichen pro Sekunde, 1 KByte Puffer und ein Bereich für einen ladbaren Zeichensatz, und neben dem normalen Schriftbild ein NLQ-Zeichensatz im ROM. Mit 32 internationalen Sonderzeichen deckt er die länderspezifischen Schriftarten ab, und eine Vielzahl programmierbarer Funktionen läßt eine vielseitige Verwendung zu. Der GX-80 transportiert Einzelblätter mittels Friktionsantrieb. Eine Kassette für automatischen Einzelblatteinzug und eine Traktorführung für Endlospapier sind — sehr ungewöhnlich — optional erhältlich.

Der Riteman C + sieht ganz anders aus, als man es bisher von Matrixdruckern gewohnt ist. Das Papier (Endlospapier oder Einzelblatt) wird nicht von hinten, sondern von vorne in die verstellbaren Traktoren gelegt und läßt sich hinter dem Druckkopf abtrennen. Da der Drucker auf zwei hohen Stelzen stehen kann, bietet sich unter dem Riteman C + ein idealer Platz an für das Druckerpapier. Das spart eine Menge Platz bei Endlospapier und ist auch für Etiketten- und Einzelblattverarbeitung geeignet. Der Drucker ist MPS 801/803-kompatibel. Die wichtigsten Daten: 105 Zeichen pro Sekunde, 9x9 Matrix und grafikfähig. Schriftarten: Pica, komprimiert, Proportional, Breitschriftkombinationen, Super-/Subscript, Unterstreichungen und Unterlängen. Druckarten: Standard, Fettdruck und Doppeldruck. Er besitzt vier Internationale Zeichensätze und 82 Grafiksymbole. Angeschlossen wird der Riteman C+ wie die Commodore-Drucker über ein mitgeliefertes Kabel. Sein Preis: 998 Mark inklusive Mehrwertsteuer.

Quen-Data war mit einem Commodore-kompatiblen Matrix-Drucker, dem DMP 1100 VC vertreten. Die wichtigsten Daten: 100 Zeichen pro Sekunde, deutscher Zeichensatz, Unterlängen, hochauflösende Grafik und Blockgrafik (640x8 Punkte). Die Traktorführung ist verstell- und abnehmbar, aber auch Friktionsantrieb (für Einzelblatt) ist vorhanden. Preis: 849 Mark mit VC-Interface und 1048 Mark mit VC und Centronics-Interface.

Mit der TC-600 hat Brother eine elektronische Schreibmaschine auf den Markt gebracht, die von Brother als Handheld-Telekommunikations-Terminal bezeichnet wird. Und in der Tat ermöglicht die TC-600 den weltweiten Dialog mit allen Computern, die über Telefon erreichbar sind. Texte können aus dem 14,3 KByte Speicher mit 300 Baud gesendet und empfangen werden. Sogar ein eigenes 3y2-Zoll-Diskettenlaufwerk ist erhältlich. Und eine Steckdose brauchen Sie auch nicht unbedingt: Batteriebetrieb ist möglich. Der Preis beträgt 1365 Mark plus 169 Mark für das notwendige Kabel. Einen ausführlichen Test lesen Sie bald im 64’er Magazin.

Gleich 3 Drucker von Citizen waren auf dem Synelec-Stand zu sehen. Der MSP-10 (1699 Mark) und sein breiterer Bruder, der MSP-15 (2199 Mark) präsentierten sich im wirklich schönen Slim-Line-Design. 160 Zeichen pro Sekunde, NLQ-Schrift und viele Zeichensätze plazieren die beiden in die gehobene Leistungsgruppe. Im Low-cost-Bereich bewegt sich der Citizen TTP 680 mit 600 Mark. Der Thermodrucker erreicht eine Druckgeschwindigkeit von 50 Zeichen pro Sekunde und kann direkt an den C 64 angeschlossen werden.

Auch in bezug auf Farbe tut sich was auf dem Drucker-Markt. Der Seikosha GP-700 hat ein VC hinter seinen Namen bekommen, will heißen: direkt anschließbar an den C 64. Mit den vier Grundfarben lassen sich insgesamt sieben Farben darstellen. Preis: 1198 Mark inklusive Mehrwertsteuer.

Mit ungefähr 2300 Mark bewegt sich der Farbdrucker 5510/5520 von Juki zwar in einer anderen Preisklasse, leistet jedoch um einiges mehr. Mit 180 Zeichen pro Sekunde wirklich schnell und mit weniger als 60 db(A) noch angenehm leise, einem 2 KByte Puffer und eine ganzen Menge an Schriftarten und Zeichensätzen.

## Diskettentrends

Die Hannover-Messe zeigte es ganz deutlich: Auf dem Diskettensektor tut sich einiges. Neue Technologien und neue Formate sind im Vormarsch. Dabei werden die Disketten immer kleiner und die Speicherkapazität steigt.

Alle wichtigen Diskettenhersteller bieten inzwischen 3½-Zoll-Disketten an. Die Entscheidung von IBM (beim AT) für 3½-Zoll wird wahrscheinlich den letzten Anstoß zur allgemeinen Einführung dieses Formates geben (die anderen Formate im 3-Zoll-Bereich wie 3, 3¼ oder 3¾ dürften sich wohl nicht durchsetzen). Die 3½-Zoll-Diskette hat tatsächlich einige Vorteile gegenüber dem 5¼-Zoll-Format: Sie ist handlicher, paßt in jede Hemdtasche und ist durch das stabile Gehäuse mit der verschließbaren Schreib-/Leseöffnung optimal gegen Verschmutzung und Beschädigung gesichert. Die Speicherkapazität steht dabei den 5¼-Zoll-Disketten in nichts nach, da durch den besseren Schutz der Magnetschicht höhere Aufzeichnungsdichten möglich sind. Man darf gespannt sein, wann das erste 3½-Zoll-Laufwerk für den C 64 erhältlich sein wird.

Im Hinblick auf neue Technologien scheint sich für die Diskette der gleiche Weg wie bei der Compact Cassette im HiFi-Sektor abzuzeichnen: Bei BASF setzt man auf Chromdioxid- und Reineisen-Disketten zur Steigerung der Aufzeichnungsdichte und -qualität. Maxell plant ebenfalls die Einführung einer Reineisendiskette mit einer Kapazität von fünf Megabyte pro Diskettenseite. Auch von anderen Herstellern wird dieser Schritt in Erwägung gezogen.

Auch optische Disketten, bei denen die Information wie bei einer Videoplatte per Laserstrahl abgetastet wird, sind für die Zukunft möglicherweise auch im gehobenen Homecomputer-Bereich zu erwarten. Speicherkapazitäten um die 2,6 Gigabyte, also etwa »10600 Blocks free« — das läßt wohl des Herz jedes C 64-Besitzers höher schlagen.

(aa/gk/ev)

# Aktuell [11-12]

## James Bond — Computerspiel und Film

Eine große Fabrik in Sunvalley, die Computerchips herstellt, soll in die Luft gesprengt werden. Agent 007 (Roger More) soll dies verhindern. Soweit die Rahmenhandlung des neuen James Bond-Filmes »A View to kill« (Im Angesicht des Todes). Der Film wird am 12. Juni in England anlaufen. Eine Woche vorher, am 5. Juni, erscheint ein Computerspiel der englischen Firma Domark zu diesem Film.

Das Spiel wird aus drei Teilen bestehen, die genau an die Filmhandlung angelegt sind. Der erste Teil spielt in Paris. Im Restaurant des Eifelturms wird in James Bonds Gegenwart ein Informand erschossen. Der Mörder flüchtet dann in einem Auto quer durch Paris. Hier setzt der erste Spielteil ein. Sie müssen als 007 den Wagen verfolgen. Auf dem Monitor sehen Sie den Stadtplan von Paris, auf dem die Position Ihres und des anderen Autos gekennzeichnet ist. Weiterhin wird in 3D-Grafik der Ausblick aus dem Wagen gezeigt. Die Verfolgungsjagd kann beginnen. Schaffen Sie diesen Teil nicht gleich auf Anhieb, langweilig wird das nächste Spiel bestimmt nicht. Der Fluchtweg des Autos verändert sich mit jedem Spiel.

Haben Sie diese Hürde genommen, erhalten Sie ein Paßwort, das sich aus dem vorher eingegebenen Namen und der benötigten Zeit ergibt. Mit diesem Code gelangen Sie in den nächsten Teil des Spiels.

Mit diesem Teil gelangen Sie nach San Francisco. Sie befinden sich in einem brennenden Hochhaus. Dieser Spielteil ist ein Arcade-Adventure. Sie müssen in fünf Stockwerken mit insgesamt 75 Räumen Hilfsmittel suchen, um aus dem brennenden Haus zu entkommen. Doch achten Sie darauf: das Feuer frißt sich schnell weiter vor.

Auch hier bekommen Sie nach erfolgreicher Beendigung des Levels ein Paßwort für den dritten Teil des Spieles.

Im dritten Abschnitt befinden Sie sich in einem Höhlensystem unter dem Sunvalley. Sie müssen eine Bombe finden, entschärfen und sie aus dem Höhlensystem entfernen. Ähnlich wie bei Impossible Mission müssen Sie vorher in verschiedenen Räumen Aufgaben lösen. DieserTeil ist unter anderem ein Wettlauf gegen die Zeit. Entschärfen Sie die Bombe nicht rechtzeitig, ist Sunvalley verloren.

Am Ende des Spieles, so ist von Domark zu hören, befindet sich eine »secret animated sequence«. Genaueres erfahren Sie in der nächsten Ausgabe.

### Musik von Duran Duran

Die Titelmusik zum neuen James Bond-Film stammt von Duran Duran. Es gelang dem englischen Software-Produzenten, die Rechte an der Musik für ihr Spiel zu bekommen. Ob die Umsetzung auf den C 64 genauso gelungen ist wie bei Ghostbusters, bleibt abzuwarten. Auch dies erfahren Sie in der nächsten Ausgabe.

Bei dem Spiel handelt es sich übrigens tatsächlich um eine Neuentwicklung, die sich auf den neuen Film bezieht. Sie sollte also nicht mit dem Spiel 007 von Parker Brothers verwechselt werden, das wohl als sehr verunglückt bezeichnet werden konnte und keinen Bezug auf einen James Bond-Film hatte.

### Der Trend

Stars auf dem Bildschirm zu haben, war schon immer das Anliegen der Filmproduzenten. Doch auch die Softwareproduzenten wollen sich ein Stück des Erfolgskuchens abschneiden. Spätestens nach dem legendären Film-, Musik- und (natürlich) Softwareerfolg von »Ghostbusters« wollen alle auf der Erfolgswelle mitreiten. Nach dem Beginn der »Spiel zum Buch«-Welle kommt jetzt also auch die »Spiel zum Film«-Welle ins Rollen. Lizenzen werden nicht nur zu den Markennamen der Stars und zur Filmhandlung gekauft, sondern auch der Musik. Erst Ghostbusters, jetzt Duran Durans James Bond-Musik. Doch bei allem Trend: Warten wir lieber immer erst ab, ob das Spiel soviel Spaß bringt wie das Ansehen des Films. Der Name eines Stars macht noch lange kein gutes Spiel aus. (rg)

## Noch ein Floppy-Beschleuniger

Das System »Floppy-Flash 1541« von Mikrotronic soll das Laden und Speichern aller File-Typen auf dem Laufwerk 1541 nach Angaben des Hersteller bis zu 10mal schneller machen. Das System wird am Expansion-Port angeschlossen (der durchgeschleift ist) und bietet erweiterte DOS-Befehle auf Funktionstasten, einen speziellen Reset und ein Centronics-Interface mit Hardcopy-Funktion. Die RS232-Schnittstelle soll verbessert worden sein. Außerdem sollen ein Schnellkopierer und eine Schreibschutzfunktion eingebaut sein.

Die Umrüstarbeiten sollen weniger als 5 Minuten in Anspruch nehmen. Zum Preis von 79 Mark ist eine Erweiterung erhältlich, die den Betrieb eines zweiten Laufwerks gestatten soll. Außerdem ist ein Ein-Minuten-Schnellkopierer für 39 Mark lieferbar.

Info: Dipl.-Ing. K. Roreger, Liebigstr. 28, 4780 Lippstadt, Tel. 0 22 38/4 35 56

TODO ASIDE

## VAM ruft alle mit Computern unterversorgten Schulen zur Mitarbeit auf

Viele Schulen im Bundesgebiet verfügen noch nicht über eine ausreichende Ausstattung an Computern, um ihren Schülern eine zeitgemäße Ausbildung an diesen Systemen zu gewährleisten. In einigen Bundesländern sind zwar bereits Aktionen auch von seiten der Kultusministerien in Angriff genommen worden, um dieser Unterversorgung abzuhelfen. Dennoch verbleibt die Initiative, die jeweilige Schule mit einer ausreichenden Anzahl an Computern zu versorgen, immer noch den Lehrern, Direktoren, engagierten Schülern oder Eltern vorbehalten.

Eines hat sich auf dem Technologie-Forum, das im März '85 von Commodore veranstaltet wurde, ganz deutlich gezeigt: Der Computer wird sicher die Kreidepädagogik ersetzen, doch die Rolle des Lehrers wird in absehbarer Zeit nicht in Frage gestellt sein. Deshalb sind gerade die Lehrer, welche einen »Notstand« an ihrer Schule erkannt haben, aber auch die, die bisher noch mit einer gewissen Skepsis und Reseviertheit dem »neuen Medium« Computer gegenüberstanden, aufgerufen, den Schülern (und sich selbst) zeitgerechte Lehr- und Lernmittel zur Verfügung zu stellen.

Die Idee des VAM (Verein zur beratenden Aufklärung über die Mikrocomputertechnologie e.V.), möglichst in alle Schulen eine ausreichende Anzahl von Computern zu bringen, beruht auf der sogenannten Mietpatenschaft.

Dabei werden acht bis zehn spezielle Schulcomputer »Leibniz I« (momentan basierend auf dem C 64, der in Zukunft aber um einige Leistungsmerkmale wie Vernetzung oder Schnelladesysteme bereichert werden wird) zur Verfügung gestellt. Handwerksbetriebe, Banken, Versicherungen, mittelständische Unternehmen oder Kaufhausketten in der Umgebung der Schule übernehmen die (monatliche) Finanzierung eines oder mehrerer dieser Systeme.

Die Aktivierung dieser Unternehmen wird von den jeweiligen Initiatoren und dem VAM vorgenommen. Alle Beteiligten haben von dieser Mietpatenschaft Vorteile: Die Schulen kommen zu ihren Computern und können den Schülern zeitgemäßen Unterricht präsentieren (nicht nur in ureigensten Gebieten wie Informatik oder Mathematik, sondern auch als unterstützende Maßnahmen für eine moderne Aufbereitung der Lehrinhalte in anderen Fächern). Die Firmen der Umgebung können mit Schulabgängern rechnen, die hervorragende Kenntnisse in den neuen Formen der Datenver- und bearbeitung und der Computertechnologie aufwarten können. Für eine erste Kontaktaufnahme steht der VAM bereit.

Info: VAM, Rheinallee 6, 5300 Bonn 2, Tel. 02 28/36 35 71

## Neues Kopierprogramm

Die »Orginal Data Backup Box« ist ein 40-Spur-Error-Kopierer von Mikrotronic für 139 Mark auf Modul, das 40 Spuren und Read Errors bei unterschiedlicher Synchronisation kopieren kann. Dieses Modul enthält DOS-Befehle, Directory-Anzeige, 40-Track-Error-Backup in drei Minuten, ein Zwei-Minuten-Fast-Backup für 36 Spuren und schnelles Filecopy für ungeschütze Files. Nach Angaben des Vertreibers richtet sich dieses Modul an alle Besitzer teurer Original-Software, die Ihre Disketten im Dauereinsatz haben. Als »Original Read-Error Box« wird für 89 Mark eine Version angeboten, die sich nicht auf die Synchronisation der Spuren 37 bis 40 bezieht.

Info: Dipl.-Ing. K. Roreger, Liebigstr. 28, 4780 Lippstadt, Tel. 0 22 38/4 35 56

## Software für Friseure

Eine spezielle Brachenlösung für Friseure bietet der H.G.M. Alpenland-Vertrieb an. Das gesamte System, bestehend aus C 64, Datenspeicher, Bildschirm, Drucker, Kassendrucker und diversen Programmen wie Registrierkassen, Auswertung mit Leistungsstatistik für einen Salon und 50 Mitarbeiter, Lohn/Grafik, Hauptprogramm mit ständiger Inventur für Verkauf und Kabinett, Initialisierung, Summierung und Kassenzettel kostet 4990 Mark. Die gesamte Anlage kann auch für eine monatliche Gebühr von 120 Mark gemietet werden.

Info: H.G.M. Alpenland-Vertrieb, G. Linder, Hauptstraße 43, 8222 Ruhpolding

## Einbaumodem auch für den C 64

In Kürze soll es laut Bundespost auch für den C 64 das Einbaumodem geben. Der Termin der Einführung stand zum Redaktionsschluß noch nicht fest, wohl aber der Preis. Das Einbaumodem kostet pro Monat 20 Mark Miete. Der Anschluß erfolgt durch die Bundespost. Genauere Angaben in einer der nächsten Ausgaben.

(rg)

## Terminal 64 für Ascom-Akustikkoppler

Das Terminalprogramm »Terminal 64« wurde jetzt für den Ascom-Akustikkoppler umgesetzt und ist ab sofort erhältlich. Testbericht siehe 64'er Ausgabe 2/85.

(rg)

Bezugsquelle: Dynamics Marketing GmbH, Große Bäckerstr. 11, 2 Hamburg 1

## Gerüchte um »Eureka«

Die Gerüchteküche in Deutschland kocht. Es geht hierbei um das Abenteuerspielpaket Eureka, auf dessen Lösung 25000 englische Pfund ausgesetzt sind. Gerüchte wie »Die englische Veranstalterfirma Domark ist in Konkurs gegangen« entsprechen nicht der Wahrheit. Zum Zeitpunkt dieser Meldung ist Eureka noch nicht gelöst. Der Preis ist also noch zu haben! Unter der Hotline-Nummer 00 4418 791166 kann 24 Stunden lang der aktuelle Stand abgerufen werden.

(rg)

## 53-KByte-Terminalprogramm

Das Terminalprogramm »Terminal 86« gibt es auf EPROM und stellt 53 KByte für die Datenaufnahme zur Verfügung. Eine ständige Helpseite ist integriert und jederzeit aufrufbar. Die Übertragungsrate ist wählbar zwischen 300, 600 und 1200 Zeichen pro Sekunde. Ebenso kann man zwischen ASCII oder deutscher Tastatur wählen. Das Programm verfügt über einen eingebauten Editor, die Parametereinstellung (Parität, Voll- oder Halbduplex, etc.) erfolgt über Tastendruck und kostet 139 Mark.

Info: JJC, Crispinstr. 4, 4600 Dortmund 50

## Neuer Reparaturschnellservice in München

Reparaturen innerhalb eines Tages garantiert SEP in München. Dabei sollen nicht nur Commodore-Systeme berücksichtigt sein. SEP sieht sich speziell als Anlaufstelle für Schulen, die bisher Schwierigkeiten mit der Reparatur ihrer Schulcomputer hatten. Zudem will SEP als Anlaufstelle für Entwicklungen im Bereich Software und Hardware für Schulen verstanden sein. Neue Entwicklungen sollen dort auf ihre Tauglichkeit für den Schulunterricht untersucht werden.

Info: SEP, Hans-Pinsel-Str. 10b, 8013 Haarbei München, Tel.: 0 89/4 60 53 40

# Leserforum [14]

## Ärger mit der 1541

Ich habe einige Schwierigkeiten mit meinem Floppy-Laufwerk. Wenn es längere Zeit in Betrieb und ziemlich warm geworden ist, nimmt die Diskette kein Programm mehr an. Beim Speichern meldet die Floppy dann Fehler 20 oder 27. Das Laufwerk lädt dann auch nicht mehr, auch keine Directories von anderen Disketten. Nach längerem Abkühlen kann wiedergeladen werden, aber nicht mehr die Programme, die ich vorher abspeichern wollte. Auf dem Laufwerk ist noch Garantie und es war auch schon zur Reparatur beim Händler. Der sagte, es sei eine Neueinstellung vorgenommen worden. Aber der Fehler tritt immer wieder auf. Schadet es der Floppy wenn ich einen Reset auslöse? Dabei läuft die Floppy kurz an und die rote Lampe leuchtet.

Josef Spiertz

Ihr Problem beruht auf der thermischen Ausdehnung von Metallen. Die Mechanik des Laufwerkes dehnt sich normalerweise nur minimal aus. Bei Ihnen scheint der unglückliche Extremfall vorzuliegen, daß durch diese Ausdehnung der Schreib-/Lesekopf total verstellt wird. Dann kann die Floppy-Station weder Daten lesen noch schreiben. So, wie bei Ihnen geschildert, darf dieses Problem aber unter normalen Umständen nicht auftreten. Normalerweise ist ein mehrstündiger Betrieb, solange nicht laufend formatiert wird, ohne Probleme möglich. Es gibt hier zwei Lösungsmöglichkeiten: Entweder Sie sorgen für Kühlung, indem Sie die Floppy »offen«, das heißt ohne Gehäusedeckel, betreiben oder einen Lüfter verwenden. Die Alternative wäre, daß Sie auf einen Umtausch des Laufwerkes bei Ihrem Händler bestehen.

Bei einem Reset am Computer wird auch in der Floppy ein Reset ausgelöst. Das hat keinerlei schädliche Folgen für Floppy und Diskette.

TODO ASIDE

## Fragen Sie doch

Selbst bei sorgfältiger Lektüre von Handbüchern und Programmbeschreibungen bleiben beim Anwender immer wieder Fragen offen. Viel mehr Fragen ergeben sich bei Computer-Interessenten, die noch keine festen Kontakte zu Händlern, Herstellern oder Computerclubs haben. Sie können der Redaktion Ihre Fragen schreiben oder Probleme schildern (am einfachsten auf der Karte »Lesermeinung«). Wirveranlassen, daß sie von einem Fachmann beantwortet werden. Allgemein interessierende Fragen und Antworten werden veröffentlicht, die übrigen brieflich beantwortet.

## Vizawrite-Hilfe

Ich arbeite mit einer englischen Version von Vizawrite und suche nach einer Möglichkeit, deutsche Umlaute darstellen zu können.

Ausgabe 5/85

Bertram Hafner

Der Zeichenspeicher bei Vizawrite 64, englische Version, beginnt bei $3800 und endet bei $3FFF. Durch entsprechende POKEs können in diesem Bereich die notwendigen Änderungen vorgenommen werden. Dies ist bei Ä,Ö,Ü ohne weiteres möglich, indem man die Zeichencodes für die eckigen Klammern beziehungsweise das Pfundzeichen entsprechend ändert.

Leider stößt ein ähnliches Vorgehen bei den kleingeschriebenen Umlauten ä,ö,ü sowie bei ß auf erhebliche Schwierigkeiten, da aufgrund bestimmter AND-Verknüpfungen innerhalb des Programms die Erzeugung der entsprechenden Zeichencodes durch Tastendruck verhindert wird.

Ich selbst habe die notwendigen Änderungen in Vizawrite 64 unter großen Schwierigkeiten vorgenommen, so daß nun auf Bildschirm und Drucker alle Umlaute und ß in Verbindung mit der Commodore-Taste erzeugt werden können.

In Verbindung mit Hypra-Load kann nun sogar die nervtötende Ladezeit um den Faktor sechs verkürzt werden.

Ich bin gerne bereit, Besitzern des englischen Vizawrite ihr Originalprogramm gegen eine Unkostenvergütung entsprechend zu modifizieren.

Hanno Hettinger

## Wer kennt das Quick Data Drive?

Ich möchte mir im Sommer dieses Jahres das Quick Data Drive von NCS zulegen. Da diese Floppy-Alternative noch ziemlich wenig verbreitet ist, wäre ich an Erfahrungen anderer Leser mit diesem System interessiert.

Marc Nelles

## Listschutz geknackt

In der Ausgabe 12/84 des 64'er-Magazins wurde ein laut Autor »unknackbarer« Listschutz vorgestellt. Wer sein Programm wirklich wirksam schützen will, der sollte diesen »Schutz« allerdings nicht verwenden. Er kann nämlich durch einen einfachen POKE-Befehl (POKE 43,82) außer Gefecht gesetzt werden. Dieser POKE bewirkt ein Verschieben des Basic-Starts, so daß beim Listen die beiden Zeilen, in denen der Listschutz aktiviert wird, einfach übersprungen werden.

Der eben genannte POKE gilt zwar nur ganz speziell für das abgedruckte Listschutzprogramm, aber selbst ein mittelmäßiger Hacker kann derartige Schutzmaßnahmen leicht knacken, und sei es etwas aufwendiger mit einem Maschinensprache-Monitor.

Stefan Pastuszka

Zum Thema Listschutz erreichen uns ständig neue Zuschriften. Viele Leser suchen einen guten Listschutz für ihre Programme, ohne zu bedenken, daß ein abgedruckter Listschutz kein Schutz mehr ist, denn aus der Kenntnis der Funktionsweise ergibt sich fast zwangsläufig auch die Möglichkeit, einen solchen Schutz auch zu »knacken«, wie das obige Beispiel beweist.

## Hi-Eddi mit CP 80

Das wirklich gute Grafikprogramm Hi-Eddi fisting des Monats in Ausgabe 1/85) kann auch mit einem Melchor CP 80-Drucker zusammenarbeiten. Durch folgende Änderungen im Hi-Print ist eine Druckausgabe inklusive aller Sonderfunktionen auf dem CP-80 mit Vobis-Interface möglich:
460 DATA 4
550 DATA 27,51,21,255,255
580 DATA 27,75,255,255,255
Ärgerlich ist bei Hi-Eddi jedoch, daß man im Sprite-Edit-Modus die gesetzten Punkte nicht wieder löschen kann.

Bei meinem C 64 taucht noch ein spezielles Problem auf: Direkt nach dem Einschalten sind die Grafiken von verschiedenen Spielen total verzerrt und verschoben. Nach einiger Zeit gibt sich das allerdings wieder von selbst. Wer hat ein ähnliches Problem oder kann mir helfen?

Thomas Küpper

TODO ASIDE

## Wollen Sie antworten?

Wir veröffentlichen auf dieser Seite auch Fragen, die sich nicht ohne weiteres anhand eines guten Archivs oder aufgrund der Sachkunde eines Herstellers beziehungsweise Programmierers beantworten lassen. Das ist vor allem der Fall, wenn es um bestimmte Erfahrungen geht oder um die Suche nach speziellen Programmen. Wenn Sie eine Antwort auf eine hier veröffentlichte Frage wissen — oder eine andere, bessere Antwort als die hier gelesene, dann schreiben Sie uns. Antworten publizieren wir in einer der nächsten Ausgaben. Bei Bedarf stellen wir auch den Kontakt zwischen Lesern her.

## Software aus Amerika

Ich möchte für meinen C 64 Programme direkt aus Amerika besorgen. Meine Frage: Läuft die in Amerika angebotene Software auch auf der europäischen Version des C 64 ? Ich denke dabei insbesondere an Probleme, die sich aus unterschiedlichen TV-Normen (Pal/ NTSC), Netz- und Quarzfrequenzen ergeben können.

Ingo Zeigler

Fast die gesamte in Amerika angebotene Software läuft völlig problemlos auch auf der europäischen Version des C 64. Die unterschiedlichen TV-Normen bedingen lediglich unterschiedlich konzipierte HF-Modulatoren, haben jedoch keinen Einfluß auf die Software. Die unterschiedlichen Netz- und Taktfrequenzen dürften nur bei sehr wenig Programmen wirklich Probleme machen. Es läßt sich aber nicht pauschal sagen, bei welcher Art von Programmen Schwierigkeiten auftreten könnten. Im Einzelfall hilft leider nur Ausprobieren.

# Leser fragen — Willi Brechtl antwortet [15]

> Hallo liebe Leser, hier bin ich wieder, um Eure Fragen zu beantworten.

Ich werde mich hauptsächlich um Leserbriefe kümmern, die nicht in das sachliche Einerlei des Leserforums passen. Zum Beispiel Fragen, die sich aus dem einen oder anderen Grund nur ganz subjektiv beantworten lassen. Oft genug tauchen auch Probleme auf, die sich nicht mit einem kurzen Antwortsatz abhandeln lassen. Und wenn selbst eine längere Antwort im Rahmen des Leserforums nicht mehr ausreichen würde, dann ist das ganz klar ein Fall für Willi Brechtl.

Also: Wenn Sie als Anfänger Probleme mit Computer, Software oder Handbuch haben, dann wenden Sie sich in Zukunft doch einfach vertrauensvoll direkt an mich.

## Hardware-Sorgen

1.	Kann ein Schaden an den Geräten (Zentraleinheit, Floppy und Farbfernseher) entstehen, wenn ich sie alle drei auf einmal einschalte oder muß ich erst den Fernseher einschalten, warten bis ein Bild da ist, dann die Zentraleinheit in Betrieb setzen und nachher das Floppy-Laufwerk einschalten?
2.	Was kann an der Floppy-Station und der Diskette kaputtgehen, wenn sich eine solche während des Ein- oder Ausschaltens im Laufwerk befindet? Mir ist das schon öfter passiert, aber soweit ist noch alles ganz.
3.	Kann es sein, daß es den C 64 mit verschiedenen Betriebssystemen gibt? Mein Freund hat ein Spiel »Popeye«, das bei ihm einwandfrei läuft. Wenn wir es aber bei mir spielen wollen, macht es immer einen Aussteiger.
4.	Was kann an der Hardware kaputtgehen, wenn ich während des Betriebs ein Verbindungskabel löse?

Michael Reichel

1.	Den Geräten ist es völlig egal, in welcher Reihenfolge sie eingeschaltet werden. Besonders bequeme Menschen wie beispielsweise die 64’er-Redakteure lösen das Einschaltproblem besonders elegant: Alle Geräte werden an eine Steckdosenleiste mit Schalter angeschlossen. Liegt diese auch noch auf dem Boden, läßt sich mit einem einfachen Fußdruck die gesamte beschriebene Hardware (auch Drucker) einschalten. Vorsicht ist allerdings bei älteren Fernsehgeräten geboten. Diese vertragen es teilweise nicht, wenn die Netzspannung direkt und nicht über den eingebauten Schalter gesteuert wird.
2.	Am Floppy-Disk-Laufwerk wird normalerweise kein Schaden entstehen. Disketten können aber theoretisch durch die plötzliche Spannungsspitze im Gerät teilweise gelöscht werden. Uns ist das bisher auch noch nicht passiert, trotzdem sollte hier Vorsicht geboten sein.
3.	Es gibt verschiedene Versionen des 64er. Die Unterschiede sind allerdings minimal und treten nur vereinzelt zu Tage. So gibt es mehrere Ausführungen der CPU, was sich bei einigen sogenannten »illegealen Opcodes«, also eigentlich nicht vorgesehenen Maschinenbefehlen bemerkbar macht. Auch die Bus-, Sound- und Videobausteine werden in verschiedenen, aber fast identischen Versionen gefertigt.
4.	Das sollte man tunlichst unterlassen. Gerade die Busbausteine in der 1541-Floppy sind da sehr empfindlich. Besonders gefährlich sind hier statische Aufladungen. Wer beim Umstecken seine Floppy zerstört, weil er in geladenem Zustand die Ports berührt, der darf mit Reparaturkosten bis zu 100 Mark und mehr rechnen. Das gleiche gilt für Computer (Serieller Bus, Datasetten-Anschluß, Userport und sogar Joystickanschluß) und Drucker.

## Von Basic zur Maschinensprache?

Ist es möglich, ein Basic-Programm mit Hilfe eines Maschinenprogramms in ein Maschinenprogramm zu verwandeln? Wenn ja, womit?

Frank Wild

Solche Programme gibt es tatsächlich. Sie heißen »Basic-Compiler«. Ein solcher Compiler übersetzt ein Basic-Programm in Maschinensprache, die der Computer direkt verstehen und ausführen kann. Derart übersetzte Programme sind daher um einiges schneller als entsprechende reine Basic-Programme. Einen ausführlichen Test verschiedener Basic-Compiler für den C 64 finden Sie in den 64’er-Ausgaben 2/85 und 4/85.

## Was ist der MSE?

Ich verstehe den Aufbau der MSE-Sprache nicht. Warum sind in einer Zeile jeweils neun verschiedene Befehle?

Tim Wensky

»MSE« ist keine eigene Computersprache, sondern nur ein Eingabesystem für Programme in Maschinensprache. Diese werden in einer besonderen Form als »Hexadezimalzahlen« abgedruckt. Dieses Zahlensystem ist nicht wie die uns geläufigeren Dezimalzahlen auf der Basis 10 aufgebaut, sondern auf der Basis 16. Als zusätzliche Ziffern werden dabei einfach die ersten Buchstaben des Alphabets genommen. Statt dezimal... 8,9,10,11,12,13,14,15,16,... wird hexadezimal folgendermaßen gezählt: ...8,9,A,B,C,D,E,F,10,...

Jeweils zwei Hexadezimalziffern bilden ein »Byte«, also eine Zahl zwischen 0 und 255 (hexadezimal 00 und FF). Ein Byte entspricht also dem Inhalt einer Speicherzelle oder auch einem Maschinenbefehl. In einer MSE-Zeile stehen jeweils acht Programm-Bytes. Die letzte Zahl ist eine Prüfsumme. Sie wird verwendet, um Fehleingaben in einer Zeile weitgehend auszuschließen.

Bitte lesen Sie beim Abtippen von MSE-Programmen die zugehörige Bedienungsanleitung besonders aufmerksam durch. Versuchen Sie insbesondere nie, mit dem MSE eingegebene Programme einfach mit LOAD zu laden und mit RUN zu starten. Vielmehr müssen Sie MSE-Programme (wie alle Maschinenprogramme) mit »LOAD "name",8,1« laden.

## 63299 Bytes free?

Ich habe den Tip bekommen, daß die Befehlsfolge »POKE 56,255 / SYS 58234« beim VC 20 einen freien Speicherplatz von über 61000 Bytes ergeben soll. Ich habe nun diese Befehlsfolge auf meinem C 64 eingegeben und erhalte tatsächlich nach der Abfrage »PRINT FRE(0) + 2↑16« die Antwort »63229«.

Sind diese 63229 Bytes wirklich frei zum Programmieren und wird dadurch auch keine andere Funktion beeinflußt?

Torsten Niek

Na, da hat Sie aber wirklich einer an der Nase herumgeführt. Der POKE-Befehl setzt zwar (allerdings nur rein rechnerisch) die Speichergrenze für den Basic-Interpreter nach oben, aber sonst tut sich überhaupt nichts. Sie haben weiterhin ihre knappen 38 KByte Basic-Speicher, weil Sie mit einem POKE-Befehl schwerlich Hardware-Aufbau und Betriebssystem eines Computers ändern können. Im Gegenteil, wenn Sie versuchen mit Variablen zu arbeiten, kann das sogar zu einem Absturz des Computers führen, weil dieser verzweifelt versucht, Variableninhalte im ROM abzulegen. Dies kann natürlich nicht gut gehen.

Der SYS-Befehl hinter dem POKE ist übrigens reine Augenwischerei, denn der bewirkt nur einen Sprung in die NMI-Routine, also dasselbe, was beim Drücken der Tastenkombination RUN/STOP-RESTORE passiert.

Eine Möglichkeit, noch mehr Basic-Speicher zu erhalten, ist die Verwendung von speziellen Erweiterungen wie das Business-Basic-Moduls von Kingsoft. Einen Test hierzu finden Sie in dieser Ausgabe.

## Graphics Basic verschenken?

Ich interessiere mich für »Graphics Basic« zum C 64 und habe deshalb folgende Fragen:

1.	Kann man jetzt, nachdem die Herstellerfirma HES Konkurs gemacht hat, Kopien von Graphics Basic unter Freunden verteilen oder sogar an Außenstehende verkaufen ?
2.	Wo kann man das Handbuch zu Graphics Basic zwecks Information bestellen?

Markus Emmert, Sven Schal

1.	Gegenfrage: Wenn das Volkswagenwerk Konkurs angemeldet hätte, würden Sie dann nach Wolfsburg fahren, sich ein paar Golfs aus dem Lager holen und die Fahrzeuge unter Freunden verteilen oder an Außenstehende verkaufen ?

Also nochmals in aller Deutlichkeit: Sie dürfen fremde Software, egal ob tatsächlich kommerziell vertrieben oder nicht, nicht ohne ausdrückliche Genehmigung des Urhebers kopieren und an andere Personen weitergeben. Wenn Sie das Original haben, dürfen Sie davon zwar Kopien anfertigen, aber ausschließlich für den eigenen, privaten Gebrauch (Sicherheitskopien). Sie dürfen derartige Kopien nicht verkaufen, tauschen oder verschenken.

2.	Da Graphics Basic in Deutschland nicht mehr vertrieben wird, ist auch das Handbuch nicht mehr erhältlich.

# Erster ausführiicher Test: C 128, Teil 2 [17-22]

> In der letzten Ausgabe haben wir Ihnen die Eigenschaften und Möglichkeiten des C 128 vorgestellt. Diesmal sollen Sie erfahren, was alles im C 128 und dem neuen Diskettenlaufwerk 1571 zu finden ist, und wie es um das Betriebssystem CP/M im 128er bestellt ist.

Bild 1 zeigt die Platine des C 128. Rechts unten finden Sie die wichtigsten Bausteine der ganzen Platine: den 8502-Prozessor und den Z80. Der 8502 wurde von Commodore/MOS für den C 128 gebaut. In seinen Funktionen entspricht er dem 6510 aus dem C 64. Allerdings kann er mit 2 MHz getaktet werden, doppelt so schnell wie der 6510. Durch den Z80 »versteht« der C 128 auch CP/M-Programme. Sie können dadurch auch Programme wie Wordstar und Sprachcompiler (Pascal, Cobol und Ada) verwenden.

Rechts unten befindet sich das Gedächtnis des C 128: der 128-KByte-RAM-Speicher. 128 KByte RAM erhält man durch Parallelschaltung von sechzehn 8 KByte/ 8 Bit RAMs.

## C 128-Hardware — Bewährtes und Neues

Gleich oberhalb der RAMs finden Sie die vier Betriebssystem-ROMs mit je 16 KByte. Im freien Steckplatz für ein 32-KByte-ROM wird in der deutschen C 128-Version ein deutscher Zeichensatz untergebracht sein. Sie können dort aber auch eigene Betriebssysteme einstecken.

Neben den ROMs, die Bildgeneratoren: Der RGB-Controller und der aus dem C 64 bekannte VIC, der für den C 128 leicht überarbeitet wurde. Normalerweise befindet sich über den beiden Video-Chips ein Abschirmblech. Ebenso über dem Modulator, der ein Hochfrequenzsignal zum Anschluß eines Fernsehers erzeugt. Im 2-MHz-Modus löst der RGB-Controller den VIC, der nur mit 1 MHz arbeiten kann, ab.

Rechts neben der »Bildstelle« befindet sich der Sound-Chip, der SID. Er ist identisch mit dem 6581 aus dem C 64. Etwas weiter rechts liegt die MMU, die Memory Management Unit. Erst mit der MMU kann ein 8502-Prozessor 128 KByte Speicher mittels Bank-Switching verwalten.

Die PLA (Programmable Logic Array, vom Hersteller programmierbare Logikschaltung) und die CIAs (Complex Interface Adapter, hier zur Steuerung von Aus- und Eingängen ) haben im C 128 fast die gleichen Aufgaben wie im C 64. So verwaltet die PLA den ROM-Speicheraufbau. Sie selektiert die vom Prozessor benötigten ROMs im Computer und EPROMs auf einer eventuellen Erweiterungskarte. Die 6526-CIAs, Commodore/MOS-Entwicklungen, regeln alles, was an Daten in den C 128 hinein- und hinausgeht. CIA 1 übernimmt die Auswertung, welche Taste der Tastatur gedrückt wurde und teilt dem Prozessor mit, in welche Richtung ein Joystick weist. CIA 2 steuert die Ein- und Ausgänge des User-Ports und des seriellen IEC-Bus.

Bild 2 zeigt das Blockschaltbild des C 128. Im folgenden soll kurz der Aufbau des Systembusses erläutert werden.

### 1.	Der Prozessor-Bus

Als Prozessorbus bezeichnet man den Adreß- und Datenbus. Der Adreßbus umfaßt 16 Leitungen A0 bis A15, der Datenbus 8, D0 bis D7. Wie Sie ja sicherlich wissen, muß beim C 64 ein Datum (POKE-Wert) innerhalb des Wertebereichs von 0 — 255 liegen. Aber nicht nur beim C 64, sondern bei allen 8-Bit-Computern, da 255 die größte mit 8 Bit darstellbare Zahl ist. Es sind deshalb 16 Adreßleitungen nötig, damit ein 8-Bit-Computer 65536 Speicherstellen (64 KByte) ansprechen kann. Beide Bussysteme stellen die Verbindung des Prozessors mit den ROMs, RAMs und I/O (Input/Output)-Bausteinen her. Der Prozessorbus dient sowohl dem 8502, als auch dem Z80. Damit der Z80, der mit 4 MHz getaktet wird, mit dem 2 MHz-Bussystem arbeiten kann, wurde ihm eine entsprechende Interface-Schaltung »verpaßt«. Diese Schaltung sorgt dafür, daß der Z80 nur mit 2 MHz getaktet wird, wenn er auf den Bus zugreift.

### 2.	Der Translated Adress Bus

Dieses Bussystem wird von der MMU generiert. Das System besteht nur aus den höherwertigen Adreßleitungen TA8 bis TA15. Diese Adreßleitungen benötigt der VIC-Chip zum Zugriff auf das Zeichensatz-ROM. Dazu legt die MMU TA8 bis TA11, während der VIC arbeitet, auf einen Tri-State-Pegel, damit der VIC-Chip diese Leitungen für sich nutzen kann, als VA8 bis VA15. Das ermöglicht erst den VIC das gesamte Zeichen-ROM zu adressieren. Ein Zeichen besteht aus 8 Byte, der Zeichensatz umfaßt 256 Zeichen, insgesamt also 2048 Byte. Mit acht Leitungen könnte der VIC aber nur 256 Byte adressieren. Um aber 2048 Speicherplätze adressieren zu können, stellte eben die MMU dem VIC noch drei Tri-State-Leitungen zur Verfügung. Schaltet ein Baustein eine Leitung auf Tri-State-Pegel, entspricht das einer Leitung die in »der Luft hängt«. Technisch wird dazu einfach ein sehr hochohmiger Abschlußwiderstand in die Leitung geschaltet.

Eine andere Funktion des Translated Adress Bus ermöglicht das Arbeiten des Z80 auf dem 8502-Bussystem. Im Z80-Modus wird zu jeder Adresse von Bank 0 aus dem Bereich von $0000 bis $OFFF $D000 addiert, damit der Z80 auf das CP/M-BIOS zugreifen kann. Normalerweise liegt ja bei CP/M das BIOS im Bereich von $D000 bis $DFFF im RAM-Speicher. Da aber die ganze C 128-Organisation 8502-spezifisch ist und deshalb das BIOS in Bank 0 von $0000 bis $OFFF untergebracht ist, ist eine Konvertierung der Adressen von $D000 bis $DFFF auf $0000 bis $OFFF nötig. Und zwar immer dann, wenn vom Z80 auf das BIOS zugegriffen wird. Die Adreßkonvertierung findet nur in Bank 0 statt, nicht in Bank 1. Hier befindet sich die normale 8502-System-Zeropage.

### Der Multiplexed Adress Bus

Dieses Bussystem sichert die Zusammenarbeit des VICs mit dem Prozessor. Welche Daten über welche Leitungen fließen, bestimmt das MUX-Signal. Es wird von der MMU über die PLA erzeugt. Da die Erklärung der Funktion des Multiplexed Adress Bus hier zu weit führen würde, nur einen Umriß: Er wird vom Prozessor zur Adressierung der beiden RAM-Bänke gebraucht, zur Adressierung der VIC-Register und für Zugriffe des VIC auf das Farb-RAM und das Zeichensatz-ROM.

Zum neuen Computer gibt es auch ein neues Floppy-Laufwerk, die 1571, die wir auch unter die Lupe nahmen. Zum Test standen leider keine Unterlagen zur Verfügung.

## Das 1571-Laufwerk

Genaue Aussagen können wir über die Ladegeschwindigkeiten im C 128- und C 64-Modus geben. Im C 64-Modus hat sich nichts gegenüber der 1541 geändert, im 128er-Modus ist das Laufwerk allerdings 7- bis 8mal so schnell. So benötigt beispielsweise ein Hires-Bild (33 Blökke auf Diskette) ganze 3,2 Sekunden Ladezeit. Der Bildschirm wird während des Ladens nicht abgeschaltet.

Auch das Formatieren geht sehr viel schneller als vorher: Ganze 40 Sekunden werden zum doppelseitigen Formatieren einer Diskette benötigt. Danach stehen 1328 Blöcke zur freien Verfügung, also die doppelte Speicherkapazität einer 1541-formatierten Diskette. Noch eins fällt beim Formatieren auf: das Rattern entfällt. Den Grund dafür entdeckten wir nach dem Aufschrauben der 1571: Der mechanische Anschlag zur Kopfpositionierung wurde durch eine Lichtschranke ersetzt. Die Mechanik macht allgemein einen sehr guten und stabilen Eindruck. Interessant ist auch, daß eine weitere Lichtschranke zur Abfrage des Indexloches vorhanden ist. Alle Schreib-/Lesevorgänge funktionierten nämlich auch mit Disketten, die kein Indexloch hatten. Eine Ausnahme könnte der CP/M-Modus sein, wenn Disketten anderer Formate verwendet werden. Dies konnten wir aber mit dieser Version nicht testen, da der Floppy-Controller noch nicht auf andere Diskettenformate programmiert werden konnte.

Auch die Elektronik zeigt sich von einer guten Seite. Auf der sehr sauber aufgebauten Platine sind gegenüber der 1541 einige Chips hinzugekommen, über deren Funktion teilweise nur spekuliert werden konnte. So ist zum Beispiel eine 6526-CIA und ein WD1770-Controller vorhanden (Bild 3).

Das alte 1541-Problem der Wärmeabfuhr wurde bei der 1571 gelöst. Das ohnehin schon recht »kalte« Netzteil ist völlig von der Floppymechanik getrennt. Es können also kaum mehr Schreib-/Leseprobleme auftreten, die auf eine Wärmeleitung vom Netzteil auf die Floppymechanik zurückzuführen sind.

Wie der C 128 hat auch das Floppy-Laufwerk einen Modus, der ein früheres Commodore-Gerät, die 1541, simulieren soll. Hier gab's, zumindest bei unserer Vorabversion, noch einige Probleme. Es ist deshalb die Serienversion abzuwarten, will man ein endgültiges Urteil abgeben. Eine Kleinigkeit ist uns noch sehr positiv aufgefallen: An der Rückseite befinden sich zwei kleine DIP-Schalter, mit denen die Geräteadresse der Floppy auf Werte zwischen 8 und 11 geändert werden kann. Es wird also auch für absolute Anfänger ein problemloser Betrieb mit mehreren Laufwerken möglich sein.

## Der CP/M-Modus

Der C 128 ist der erste Commodore-Computer, der von Haus aus bereits CP/M-fähig ist. Mit diesem Betriebssystem steht dem Anwender die ganze Welt der CP/M-Software zur Verfügung, was insbesondere beim mehr professionell orientierten Anwender ein starkes Argument für den C 128 darstellen dürfte. Allerdings wurde dieser Vorteil, wie beschrieben, mit einem immensen technischen Aufwand erkauft. Während ein reiner Z80-Computer mit CP/M in der Regel überhaupt keine Probleme hat (System in den Speicher laden — fertig), sind beim C 128 eine Vielzahl soft- und hardwaremäßiger Probleme zu lösen.

Bei dem uns zur Verfügung stehenden Testgerät war denn auch das CP/M-System noch nicht in der endgültigen Version implementiert. Insbesondere die Ladegeschwindigkeit unter CP/M ließ noch sehr zu wünschen übrig. Die Ladezeit für das CP/M-System selbst betrug in der (vorläufigen) Version ziemlich genau 45 Sekunden. In der endgültigen Version wird die Geschwindigkeit allerdings deutlich höher liegen, so daß ein sinnvolles Arbeiten möglich wird.

Wer bisher nur mit dem C 64 gearbeitet hat, dem stehen bei der Umstellung auf eine CP/M-fähige Maschine natürlich einige Umstellungen bevor.

## Was ist CP/M?

Die Bezeichnung CP/M steht für »Control Program for Microcomputers«, also einfach für ein — inzwischen weitverbreitetes — Betriebssystem für Mikrocomputer. CP/M wurde bereits 1974 von Gary Kildall bei Intel entwickelt und diente ursprünglich als Dateiverwaltungs-System für einen von Intel vertriebenen Compiler für die Programmiersprache PL/M. Seit 1975 wird CP/M als allgemeines Betriebssystem kommerziell angeboten und ständig weiterentwickelt. Das Erfolgsrezept von CP/M heißt »Standard«.

Da jeder Hersteller eines Mikrocomputers in der Regel sein eigenes Betriebssystem einbaut, ergeben sich sehr große Probleme bei der Übertragung von Programmen und Daten zwischen verschiedenen Computern. Wer schon einmal versucht hat, ein VC 20-Programm an den C 64 anzupassen (oder umgekehrt), der weiß, wovon hier die Rede ist.

Das CP/M-Betriebssystem tritt nun als Vermittler zwischen Anwenderprogramm und Hardware auf. Beispielsweise fragt ein CP/M-Programm niemals die Tastatur direkt ab, denn die kann ja infolge unterschiedlicher Hardware von Computer zu Computer anders konzipiert und angesteuert sein. Statt dessen ruft das Anwenderprogramm eine Routine im CP/M-System auf, die die gewünschte Funktion ausführt. Natürlich muß das CP/M-System für jeden Computer an die spezielle Hardware angepaßt werden, aber, und das ist das Entscheidende, die Anwenderprogramme laufen unverändert, da sie ja nicht direkt auf die Hardware zugreifen.

Da alle CP/M-Programme generell im gleichen Speicherbereich liegen, treten kaum Probleme bei der Übertragung von einer CP/M-Maschine zur anderen auf.

Grundvoraussetzung für die Übertragbarkeit von Software ist allerdings die Verwendung des gleichen Mikroprozessors in allen CP/ M-Computern. Die Wahl fiel bei Intel nicht schwer: Der 8080 aus dem eigenen Hause wurde zum CP/M-Prozessor gekürt. Der Fairneß halber muß man allerdings zugeben, daß der 8080 damals (Mitte der siebziger Jahre) tatsächlich einer der leistungsfähigsten Mikroprozessoren überhaupt war.

Heutzutage wird allerdings fast ausschließlich der Z80 verwendet, der voll aufwärtskompatibel zum 8080 ist, aber über einen stark erweiterten Befehlsvorrat und mehr interne Register verfügt. Wer sich ernsthaft für CP/M interessiert, der sollte sich daher mit diesem Prozessor vertraut machen.

## Der Z80-Prozessor

Im Gegensatz zur 6502-Prozessorfamilie (zu der auch der 6510 im C 64 und der 8502 im C 128 gehört) handelt es sich beim Z80 ebenso wie beim Vorgänger 8080 um eine sogenannte »registerorientierte CPU«. Das bedeutet, daß der Z80 über eine größere Anzahl interner Register verfügt, die sowohl als Daten- wie auch als Adreßregister benutzt werden können (Bild 5).

Insgesamt stehen dem Benutzer sechs allgemeine 16-Bit-Register (BC, DE, HL, BC’, DE’, HB) zur Verfügung, die wahlweise auch als zwölf 8-Bit-Register angesprochen werden können. Daneben gibt es zwei Akkus und ebenfalls zwei Flag-Register, zwei 16-Bit-Indexregister (IX und IY), einen 16-Bit-Stackpointer (SP) und natürlich einen Programmzähler (PC). Zwei weitere Register, das Interrupt-Vektor-Register I und das Refresh-Kontroll-Register R haben spezielle Funktionen.

Die Register AF, BC, DE und HL bilden die sogenannten Primärregister, die vom 8080 übernommen wurden und die in erster Linie direkt angesprochen werden können. Mit speziellen Befehlen kann zwischen diesen Primärregistern und den »Sekundärregistern« AF’, BC’, DE’ und HB umgeschaltet werden. Die Indexregister IX und IY haben ähnliche Aufgaben wie die 6502-Register X und Y, sind jedoch 16 Bit breit.

Der Z80-Befehlssatz ist sehr umfangreich und umfaßt unter anderem auch 16-Bit-Arithmetik, Blockverschiebebefehle, automatische Such- und Ein-/Ausgabebefehle, bedingte Unterprogrammaufrufe sowie Einzelbitbefehle. Insgesamt kennt die Z80-CPU über 700 Opcodes. Um diese vielen Maschinenbefehle verschlüsseln zu können (mit einem Befehlsbyte können nur 256 Befehle codiert werden), gibt es einige spezielle »Umschaltopcodes«, die einfach bewirken, daß der Z80 intern auf eine andere Befehlstabelle umschaltet und das nächste Befehlsbyte in einer anderen Form interpretiert.

Nach diesem kurzen Ausflug zum Z80 jetzt jedoch wieder zum CP/M-Betriebssystem. Beim Studium von Handbüchern und CP/M-Literatur stößt man immer wieder auf vier Abkürzungen: BIOS, BDOS, CCP und TPA. Hinter diesen Bezeichnungen verbergen sich die wichtigsten Bestandteile eines CP/M-Systems.

BIOS steht für »Basic Input Output System«, hat aber absolut nichts mit der Programmiersprache Basic zu tun. Die Bezeichnung deutet lediglich an, daß es sich hierbei um eine Sammlung grundlegender Routinen zur Ein-/Ausgabe von Daten handelt.

Das CP/M-BIOS entspricht von der Funktion her ziemlich genau den Kernal-Routinen bei Commodore-Computern. Der gesamte Kontakt eines Anwenderprogramms mit der Hardware-Umgebung läuft über diese Routinen. Alle BIOS-Routinen werden indirekt über das BDOS, das Basic Disk Operating System, durchgeführt. Der Aufruf aller Systemroutinen geschieht durch einen Unterprogrammsprung zur Adresse 5, dem sogenannten BDOS-CALL. Die verschiedenen geforderten Funktionen werden dadurch selektiert, daß im C-Register des Z80 ein Funktionscode übergeben wird. Die Routine ab Adresse 5 verzweigt dann abhängig vom Inhalt des C-Registers zu den verschiedenen BIOS-Funktionen (Tabelle 1).

Diese beiden Teile des CP/M-Systems, BIOS und BDOS, werden beim »Booten«, also beim Laden des Systems von der Diskette, einmal in den Speicher geholt und bleiben dann ständig resident vorhanden.

Für den Kontakt zwischen CP/M und Anwender sorgt der »Console Command Processor« (CCP). Es handelt sich dabei um einen einfachen Kommando-Interpreter, der über die Tastatur eingegebene CP/M-Kommandos erkennt und ausführt. Mit CP/M-Kommandos hat es dabei eine besondere, grundlegende Bewandtnis. Hierzu ist es wichtig zu wissen, daß Dateinamen unter CP/M aus zwei Teilen bestehen, der eigentlichen Dateibezeichnung (acht Zeichen Länge) und der Namenserweiterung (»Extension«, drei Zeichen Länge). Diese Erweiterung, die durch einen Punkt vom eigentlichen Namen abgetrennt wird, gibt den Typ der Datei an.

## Kommandostruktur

Besonders wichtig ist der Dateityp »COM«. Wenn ein Dateiname die Erweiterung COM hat, dann stellt sie ein CP/M-Kommando dar. Das funktioniert folgendermaßen: Wenn der Benutzer ein Kommando eingibt, dann sucht der CCP auf der Diskette nach einer COM-Datei, die den Namen des Kommandos trägt. Diese Datei wird dann geladen und gestartet, mit anderen Worten, die Datei **ist** das Kommando.

Will man beispielsweise das Directory der Diskette sehen, dann gibt man den Befehl DIR ein. Der CCP sucht, lädt und startet daraufhin das Programm »DIR.COM«, das wiederum das Inhaltsverzeichnis der Diskette ausgibt. Derartige Kommandos heißen »transiente Kommandos«, weil sie eben nicht fest eingebaut sind, sondern nur bei Bedarf geladen werden. Der für transiente Kommandos reservierte Speicherbereich heißt »Transient Program Area« (TPA), womit auch die vierte der oben angesprochenen Abkürzungen geklärt wäre. Jedes CP/M-System verfügt auf der Systemdiskette über eine Standard-Bibliothek von wichtigen transienten Kommandos. Dazu gehören in der Regel Kommandos zum Ändern von CP/M-Parametern, zum Kopieren, Löschen, Listen und Umbenennen von Dateien und ähnliches, was man zum sinnvollen Arbeiten mit einer Diskettenstation benötigt.

Natürlich ist es möglich, diesen Befehlsvorrat zu erweitern, indem man entsprechende Assemblerroutinen schreibt oder auch einen Compiler einsetzt. Einzige Bedingung für transiente Kommandos ist die Lauffähigkeit des Maschinenprogramms in der TPA. Generell sind alle CP/M-Anwenderprogramme transiente Kommandos. Das Textverarbeitungsprogramm Wordstar heißt unter CP/M zum Beispiel »WS.COM« und wird einfach mit dem Kommando »WS« aufgerufen.

Mit dem CP/M-Betriebssystem hat der C 128-Benutzer Zugriff auf das größte Softwareangebot der Welt. Immerhin werden bereits seit zehn Jahren CP/M-Programme entwickelt und immer weiter verbessert. Textverarbeitung, Datenbanken, Tabellenkalkulation stehen in großer Auswahl ebenso zur Verfügung wie spezielle Branchenlösungen für den kommerziellen Einsatz. Statistik-Pakete, mathematische und naturwissenschaftliche Software ist in Mengen erhältlich. Wer selber programmieren will, der findet unter CP/M ein Angebot an Programmiersprachen, das von Fortran und Cobol über Pascal bis zu Ada und Lisp reicht. Unter CP/M gibt es so ziemlich alles, was auch auf Großrechnern läuft.

Allerdings soll nicht verschwiegen werden, daß trotz Standard und Kompatibilität gewisse Probleme auftreten können. So muß CP/M-Software generell erst einmal an einen speziellen Computer angepaßt werden. Das erledigt ein zu jeder Software gehöriges sogenanntes Installations-Programm, das zum Beispiel die Tastaturbelegung, Bildschirmansteuerung etc. abfragt, um beispielsweise ein Textprogramm optimal auf den jeweiligen Computer einstellen zu können. Dieser kleine Arbeitsaufwand ist aber natürlich gar nichts im Vergleich beispielsweise zur Aufgabe, etwa den Textomat oder Vizawrite an den VC 20 anzupassen.

Als Fazit darf festgehalten werden, daß dem C 128-Besitzer durch das CP/M-Betriebssystem ein riesiges Software-Potential zur Verfügung steht. Es ist zu hoffen, daß es zukünftig auch »schlüsselfertige«, also bereits an den C 128 angepaßte CP/M-Software geben wird, um dem Anwender die Mühen der Installation zu ersparen. Vor allem aber dürfte es von entscheidender Bedeutung sein, ob die Hersteller von CP/M-Software willens sind, die Preise für ihre Produkte, die sich teilweise noch im vierstelligen Bereich befinden, drastisch zu senken.

Die Chancen dafür stehen nicht schlecht, denn nachdem CP/M im professionellen Bereich inzwischen durch MS-DOS, ein 16-Bit-Betriebssystem, abgelöst worden ist, sollten die CP/M-Hersteller eigentlich schon an neuen Märkten interessiert sein, und diese neuen Märkte könnten durchaus im oberen Home-Bereich liegen. Wenn die Software jedoch teurer als der Computer ist, dürfte wohl kein Geschäft zu machen sein, aber beispielsweise Wordstar für 298 oder gar für 198 Mark — das wäre doch wohl ein Renner.

### Schlußfolgerung

Der C 128 ist ein Zwitter. Bedingt durch die sicherlich löbliche Entscheidung von Commodore den C 128 64er-kompatibel zu machen, ergaben sich bei der technischen Realisierung natürlich einige umständliche Lösungen. Die 8-Bit-Technologie ist bei Heimcomputern zwar noch weit verbreitet, dennoch zeigen einige Konkurrenten mit 16-Bit-Prozessoren wo der Weg auch bei »Kleincomputern« hingehen wird.

Auf der anderen Seite verfügt der C 128 bereits bei seiner Einführung über ein enormes Softwarepotential (C 64- und CP/M-Software). Der Anwender kann also aus dem Vollen schöpfen. Das wesentlichste Kaufkriterium wird aber der Preis sein. Wünschenswert wäre jeweils ein Kaufpreis von deutlich unter 1000 Mark für Computer, Floppy-Laufwerk und Monitor. Bei den bisherigen Preisen kommt man sehr schnell über 3000 Mark, und in dieser Kategorie gibt es Alternativen!

(ev/hm)

# Die Alternativen [24-26]

> Drucken tun Sie alle. Nur auf das »Wie« kommt es an. An dieser Stelle erklären wir Ihnen, wie Thermodrucker, Tintenstrahldrucker und Plotter funktionieren und wozu man Sie verwendet.

Sowohl Tintenstrahl- und Thermodrucker haben mit den Nadel-Druckern eines gemeinsam: den Aufbau von Zeichen aus einzelnen Punkten. Beim Druck wird immer eine senkrechte Punktreihe (5-9 Punkte) auf einmal zu Papier gebracht. Dann rückt der Druckkopf ein paar 10tel Millimeter weiter und setzt die nächste Punktreihe. So wird Stück für Stück jedes Zeichen zusammengesetzt. Die Ansteuerung des Druckkopfes übernimmt eine Elektronik im Drucker, die aus den ASCII-Codes die Punktmatrix berechnet.

## Wie funktioniert ein Thermodrucker?

Schon der Name gibt Auskunft über das Funktionsprinzip. Ob nun Thermodrucker, Thermostat oder Thermosflasche, alles was mit »Thermo« anfängt, hat in den meisten Fällen etwas mit Hitze zu tun.

### Mit Wärme drucken

Wie kann man Hitze drucken? Nun, hierzu ist ein spezielles Papier nötig, das sich schwarz verfärbt wenn es heiß wird. Das Papier stellt man durch Beschichtung mit chemischen Substanzen her, die bei Wärmezufuhr zu einer schwarzen Verbindung reagieren. Erkennen kann man dieses Papier an seiner einseitig sehr glatten Oberfläche. Nicht zu verwechseln mit dem silbrig beschichteten Papier einiger »Kurzschluß-Drucker«, welche die metallische Beschichtung beim Druck wegschweißen.

Anstelle der Nadeln hat der Druckkopf eines Thermodruckers kleine, punktförmige Plättchen die schnell aufgeheizt werden können und auch schnell wieder abkühlen. Bild 1 zeigt die schematische Anordnung der Heizplättchen in einem Thermodruckkopf. Die Heizplättchen stellen im Prinzip nichts weiter dar, als flache »Widerstände«, die senkrecht übereinander angeordnet auf einer gemeinsamen Grundplatte sitzen. Wenn bei einem Nadeldrucker bestimmte Nadeln aufs Papier geschlagen werden, erhitzt ein Thermodruckkopf einfach die entsprechenden Stellen. Das Ergebnis ist in beiden Fällen gleich: ein Muster aus schwarzen Punkten.

Allerdings ist nur das Ergebnis gleich. Die Druckgeschwindigkeit eines Thermodruckers ist weitaus geringer als die eines Impact-Matrixdruckers, wie man einen Nadeldrucker auch bezeichnet. Dafür ist beim Thermodruck fast nichts zu hören. Die eingeschränkte Geschwindigkeit eines Thermodruckers ergibt sich einfach aus der Aufheiz- und Abkühlzeit der Widerstandsplatten. Der Widerstand kann einfach nicht schlagartig aufgeheizt werden, da bei zu hohem Heizstrom die Widerstände einfach durchbrennen würden.

### Teueres Papier

Sie können sich sicherlich vorstellen, daß das Spezialpapier wesentlich mehr kostet als normales »Computerpapier«. Die Thermodrucker-Hersteller haben sich deshalb noch etwas Zusätzliches einfallen lassen, damit auch normales Papier verwendet werden kann: Den Druck über ein Carbon-Band. Anstatt das Papier »schwarz zu brennen«, werden hier schwarze Partikel vom Carbon-Band gelöst und aufs Papier übertragen. Also ähnlich einer Schreibmaschine, nur, daß das Band nicht durch einen Anschlag abfärbt, sondern durch Hitzeeinwirkung. Aber das Carbon-Band ist wesentlich teuerer als normales Druckerband und kann nur einmal verwendet werden. Aus dem Druckprinzip folgt, daß keine Durchschläge gemacht werden können.

## Tintenstrahldrucker — Wie funktionieren Sie?

Tintenstrahldrucker haben ein raffiniertes, mechanisch sehr aufwendiges Funktionsprinzip, das ein gutes Schriftbild (Bild 2) und eine hohe Druckgeschwindigkeit bei sehr leisem Druck ermöglicht. Sie vereinigen also alle Vorteile von Impact-Matrixdruckern und Thermodruckern in sich. Der einzige Nachteil: der Preis. Wesentlich unter 2000 Mark ist fast kein Drucker dieser Klasse zu haben.

Im Gegensatz zu allen anderen Druckern arbeiten diese Druckertypen nicht mit Farbbändern, sondern mit Tinte die gezielt aufs Papier gespritzt wird. Nur tröpfchenweise versteht sich. Damit die Tropfen schnell antrocknen und nicht verwischen, ist ein saugfähiges Papier Voraussetzung. Dieses Spezialpapier ist etwa anderthalb mal so teuer wie normales Computerpapier. Es kann jedoch leicht beschafft werden.

So wie bei allen anderen Matrixdruckern auch, wird immer eine senkrechte Punktreihe in einem Zug geschrieben. Sehr interessant ist das Prinzip, mit dem die Tropfen auf Papier »geschossen« werden. Bild 3 zeigt einen Druckkopf schematisch.

Für jeden Punkt auf einer senkrechten Reihe der Zeichenmatrix gibt es einen Düsenkanal (4) zur Erzeugung der Tropfen. In der Zeichnung (Kopf des Siemens PT88/89) sieht man eine Reihe von sechs Düsen. Der gezeigte Kopf des Siemens PT 88/89 hat zwei solche Reihen versetzt zueinander angeordnet. Den Abschluß der Kanülen bildet eine Platte (3), die etwa 1 mm vom Papier entfernt ist. Jeder Düsenkanal ist konzentrisch von einem Piezokeramik-Röhrchen umschlossen. Legt man eine Spannung an diese Röhrchen an, ziehen sie sich zusammen und üben so einen kleinen »Schlag« auf die Flüssigkeitssäule aus. Durch den Druckanstieg wird dann ein Tröpfchen aus der Düse geschleudert. Wie sich der Tropfen bildet, sehen Sie in Bild 4.

Piezoelektrische Kristalle haben die Eigenschaft, ihre Form in eine bestimmte Richtung zu verändern wenn eine Spannung angelegt wird. Umgekehrt liefert der Kristall einen sehr kleinen Stromstoß, wenn er gebogen wird (Piezo-Feuerzeug, Kristall-Tonabnehmer).

Bei diesem Verfahren liegt der Tintenvorratsbehälter (10, Bild 3) tiefer als die Kanülen. Das hat den Vorteil, daß in den Düsen ein statischer Unterdruck herrscht. Es kann also nur dann Tinte austreten, wenn sich das Piezoröhrchen zusammenzieht.

Das ist die übliche und verbreitetste Version des Tintenstrahldruckers. Von Hersteller zu Hersteller gibt es dabei natürlich Abweichungen. So kann der Druck auch durch schlagartiges Aufheizen von etwas Tinte bis zur Dampfbildung erzeugt werden. Innerhalb eines kleinen Behälters wird mit Hilfe einer leistungsstarken Heizspirale die Tinte in der Umgebung der Heizspirale in sehr kurzer Zeit zum Sieden gebracht, wobei sich Dampfbläschen bilden. Diese Dampfentwicklung erhöht den Systemdruck und treibt einen Tropfen Tinte aus der Düse. Durch das Verdampfen bilden sich leicht Feststoff-Rückstände, die den Heizbehälter schnell verstopfen können.

Verschiedene Entwicklungen gehen in eine andere Richtung. Die einzelnen Matrixpunkte werden nicht durch einzelne Kanülen erzeugt, sondern aus einer gemeinsamen Quelle. Die Tintentröpfchen verlassen dabei statisch aufgeladen die Piezo-»Pumpe« und werden über ein elektrisches Feld (Plattenkondensator) auf die richtige Bahn gebracht.

Da bei beiden Systemen nur sehr kleine Massen (Tintentröpfchen) bewegt werden müssen, können größere Schreibgeschwindigkeiten als bei Impact-Nadeldruckern erreicht werden.

Die Probleme die bei Tintenstrahldruckern gelöst werden müssen sind recht vielseitig. Das größte davon ist die Größe der Tintentröpfchen, die konstant sein muß. Bei ungleichen Tropfen wäre eine fleckige Schrift die Folge. Es ist also sehr wichtig, daß einmal die Kanülen genau gleichen Durchmesser haben und die Piezo-Kristalle den gleichen Druck auf die Flüssigkeitssäule erzeugen.

Recht arbeitsintensiv kann im Falle einer verstopften Düse das Reinigen des Druckkopfes werden. Der Druckkopf muß entweder ausgetauscht oder mit einer Reinigungsflüssigkeit gespült werden. Schmutzige Hände sind nach dieser Arbeit nicht selten. Beim Unterdruckverfahren, wo der Vorratsbehälter unterhalb der Düsen liegt, sind verstopfte Kanülen relativ selten. Häufiger kommen sie vor, wenn der Vorratsbehälter oberhalb angebracht ist. Die Tintensäule reicht dann nämlich bis an die Düsenöffung und kann leicht antrocknen.

## Plotter — was können Sie?

Müssen Sie häufig Kurvendiagramme zeichnen? Dann ist ein Plotter das richtige Druckgerät für Sie.

### X-Y-Plotter

Diese Schreiber, auch Flachbett-Plotter genannt, eignen sich vor allem für kleinere Papiergrößen bis DIN A2. Das Papier wird auf einer Art Zeichenbrett festgeklemmt und ein Stift (Tinte oder Filzstift) über einen beweglichen Arm, der über die gesamte Papierbreite reicht, in Längsrichtung geführt. Über eine Seilzugmechanik kann der Stift in der Breite auf dem Arm hin- und herbewegt werden. Auf diese Weise kann jeder Punkt des Papiers erreicht werden. Eine Hubmechanik am Schreibkopf hebt den Stift an, wenn nicht geschrieben werden soll.

Die Positionierung des Stiftes erfolgt, auf etwa 0,1 mm (beim 1520-Plotter 0,2 mm) genau, über zwei Schrittmotoren, die über eine Treiberelektronik angesteuert werden. Computerseitig muß in den meisten Fällen nur die x- und y-Koordinate an den Plotter übertragen werden.

### Trommel-Plotter

Sie sind für große Papierformate konstruiert worden, wo ein Flachbettplotter zuviel Platz in Anspruch nehmen würde. Anstelle einen Stift in x-Richtung mit einem Arm zu bewegen, bewegt man hier das Papier in Längsrichtung unter dem Schreibstift hin und her. Es sind dadurch keine Grenzen in der Papierlänge gesetzt. Eine Gummiwalze transportiert das Papier so, daß es auf beiden Seiten aus dem Plotter »hinaushängen« kann. Um den Schlupf möglichst gering zu halten, sind auf beiden Seiten der Walze kreisförmig Nadeln angeordnet, die zusätzlich das Papier mit hin- und herbewegen.

Die zeichnerischen Vorteile eines Plotters liegen auf der Hand. Linien werden durchgehend gezeichnet. Im Gegensatz zu Hardcopies bei Matrixdruckern, bei denen Linien aus Punkten zusammengesezt sind und dadurch etwas »zerissen« aussehen. Meistens werden Plotter zum Zeichnen von Schalt- und Bauplänen verwendet. Die Erfassung und Bearbeitung erfolgt meist mit einem CAD (Computer Aided Design)-System.

Des Preises wegen sind sie im Heimbereich kaum anzutreffen. Flachbettplotter kosten in der Regel über 2000 Mark.

## Welcher Typ paßt zu mir?
Zusammen mit den letzten beiden Ausgaben, haben wir Ihnen fast alle Drucker vorgestellt, die es gibt. Teure Exemplare über 2000 Mark haben wir mit Absicht nicht berücksichtigt. Der Preis paßt einfach nicht mehr zu einem Heimcomputer.

**Thermodrucker** gehören zu den billigsten Druckern, die es gibt. Allerdings nur in der Anschaffung. Das spezielle Thermopapier macht nämlich diese Drucker auf Dauer gesehen teuer. Auch wenn Sie auf Plastikcarbon-Band ausweichen, mit dem verschiedene Thermodrucker auch normales Papier verarbeiten, fallen hohe Gebrauchskosten an.

Durch das kaum hörbare Druckgeräusch sind diese Drucker besonders für »Nachtarbeiter« geeignet, die sich keinen Tintenstrahldrucker leisten wollen. Mit Thermodruckern können Sie Listings und Hardcopies (nicht bei allen Typen) drucken. Zum Schreiben von Briefen eignen sich die meisten wegen der schlechten Schrift (5x7 Punkte) nicht.

Empfehlen können wir diese Drucker denjenigen, die nicht zu tief in das Computer-Hobby einsteigen wollen.

**Nadel-Matrixdrucker** sind sehr weit verbreitet. Das liegt an der Vielsseitigkeit dieser Geräte. Es fällt im Heimbereich kaum ein Druckproblem an, das diese Drucker nicht bewältigen würden. Wenn Sie die Marktübersicht Matrixdrucker im 64'er 5/85 anschauen, sehen Sie, daß diese Drucker häufig über die verschiedensten Schriftarten verfügen. Sie können also sowohl Ihre Geschäftspost als auch Listings damit drucken. Die Korrespondenz in Schönschrift (etwa 50 Z/s) und die Listings in Normalschrift (etwa 100 Z/s), wobei die Normalschrift schon ein sehr gutes Schriftbild haben kann.

## Die Vielseitigen

Nadel-Matrixdrucker können jedem wärmstens empfohlen werden.

Aber mit dem Schreiben von Briefen sind die Leistungen eines Matrixdrucker nicht erschöpft. Da die Nadeln (bei den meisten Matrixdruckern) einzeln angesteuert werden können, kann jede Grafik aus einzelnen Punkten zusammengesetzt werden. Besonders gut können diese Drucker Hardcopies vom Bildschirm drucken. Eingeschränkt ist die Verwendbarkeit bei Kurven- und Liniendiagrammen, da die Auflösung zu gering ist. Hier sind die **Plotter** in ihrem Element. Da der Schreiber zwischen den vom Computer berechnetet Punkten nicht abgesetzt wird, interpoliert er quasi ein Kurven-Diagxamm. Eine durchgezogene Linie ist die Folge.

Der Kauf eines Plotters für zu Hause lohnt sich aber nur in den wenigsten Fällen, da ein Plotter nur zum Zeichnen sinnvoll verwendet werden kann. Grafikbilder in Hochauflösung zu drucken ist praktisch unmöglich. Genauso das Schreiben von Briefen. Listings sollten sie mit einem Plotter nur dann drucken, wenn Sie über zuviel Zeit verfügen.

Ein Plotter ist kein Ersatz für einen Drucker. Vielmehr ist er als Zusatzgerät zu einem Drucker gedacht, wenn es auf saubere Zeichnungen ankommt.

**Tintenstrahldrucker** vereinigen die Vorteile von Nadel- und Thermodruckern. Sie sind sehr vielseitig und leise. Allerdings können keine Durchschläge wie mit dem Nadeldrucker angefertigt werden. Das Schriftbild der »Tintenspritzer« ist nicht ganz so exakt wie das gleichteurer Matrixdrucker (Bild 2).

Brauchen Sie einen schnellen Drucker fürs Büro, beispielsweise für Kontrollprotokolle, Adressenaufkleber und Rundschreiben, sind Sie mit einem leisen Tintenstrahldrucker richtig beraten. Ebenso wenn Sie zu Hause keine Familienmitglieder mit dem Lärm eines Nadeldruckers belästigen wollen.

Typenraddrucker sind nur für Textverarbeitung interessant, wenn es auf sehr schöne Schrift ankommt. Für Listingsdruck, Hardcopies und Rundschreiben sind sie so gut wie ungeeignet.

## Das Problem mit dem Interface

Häufig werden wir gefragt, welches Interface das beste für einen bestimmten Drucker ist. Leider kann die Frage nicht absolut beantwortet werden. Es kommt nämlich ganz darauf an, was Sie investieren wollen. 100, 200 oder 500 Mark. Der Preis wird von Zusatzfunktionen wie C 64-Grafikzeichen-Darstellung etc. bestimmt. Bevor Sie sehr viel Geld ausgeben, beachten Sie aber, daß die Arbeit mit einem Interface um so schwieriger werden kann, je mehr Funktionen es bietet. Für die Praxis haben sich folgende Funktionen als sinnvoll erwiesen:

* CBM-ASCII-Wandlung; die Commodore-Zeichencodes werden der ASCII-Norm angepaßt (Standard). 
* Groß/Grafikmodus
* Groß/Kleinmodus
* Linearkanal; hier werden die Daten ungewandelt an den Drucker geschickt. Diese Funktion ist sehr wichtig zum Drucken von Hardcopies.

Sie merken also, es gibt keinen Drucker, der alles 100prozentig macht. Vor dem Kauf sollte man sich völlig im klaren über die benötigten Funktionen sein. Funktionen die man vielleicht einmal pro Jahr braucht, sollten eine Kaufentscheidung überhaupt nicht beeinflussen. Solche Sonderfunktionen können nämlich nur den alltäglichen Gebrauch eines Druckers erschweren. In der folgenden Marktübersicht finden Sie eine Auswahl von Thermodruckern, Tintenstrahldruckern und Plottern. Daß von den letzten beiden Typen nur wenige aufgeführt sind liegt einfach am hohen Preis der Geräte. Wir haben bei 2000 Mark die Grenze gezogen.

(hm)

# Test: Brother EP 44 [27]

> Die Brother EP 44 ist nicht nur ein Drucker, sondern ouch eine voll portable Schreibmaschine. Sie wird über eine RS232-Schnittstelle angesprochen.

Die Schreibmaschine ist sehr klein (55 mm x 330 x 262 mm) und paßt mit Sicherheit in jeden Aktenkoffer. Mit ihren 2,5 kg (einschießlich Batterien) fällt sie kaum ins Gewicht.

Die Schreibmaschine hat einen Textspeicher für über 3 700 Zeichen. Dort können ganze Briefe abgelegt werden, die auch nach Ausschalten des Gerätes oder bei Batteriewechsel erhalten bleiben. Die EP 44 ist zwar auch für Netzbetrieb vorgesehen, doch fehlt das Netzgerät in der Grundausstattung.

Der Textspeicher kann auch nachträglich über das 15stellige LCD-Display bearbeitet werden. Zu den Editiermöglichkeiten gehören Löschen, Einfügen, Ergänzen und Korrigieren. Die Schreibmaschine selbst läßt kaum Wünsche offen.

Doch inwieweit läßt sich die Brother EP 44 mit einem Computer wie dem C 64 ansteuern? Der Thermodrucker besitzt dazu eine integrierte RS232-Schnittstelle. Über eine spezielle Datenleitung von Brother (CA50-CMD II) kann die EP 44 direkt an den User-Port des VC 20 oder C 64 angeschlossen werden. Über die Geräte- und Sekundäradresse 2 können nun Buchstaben, Zahlen, sowie Satz- und Rechenzeichen gedruckt werden. Grafikzeichen oder Commodore-Sonderzeichen werden ignoriert oder falsch interpretiert. Die Schreibmaschine ist deshalb nicht zum Ausdruck von Listings oder Hardcopies geeignet. Sie findet ihre Verwendung ausschließlich in der Textverarbeitung, zumal der Zeichensatz die deutschen Umlaute beinhaltet und das Schriftbild beim Druck mit Thermopapier dem einer Typenradschreibmaschine sehr nahe kommt (Bild 1). Das Schriftbild mit Plastik-Carbon-Band auf normalem Papier ist nicht ganz so gut.

Schwierigkeiten traten in der Verträglichkeit zu Textverarbeitungs-Programmen auf. Das Textverarbeitungsprogramm Vizawrite ist nicht für einen RS232-Drucker vorgesehen. Wordpro 3+ akzeptiert nicht die Geräteadresse 2. Auch mit dem Programm SM-Text treten ähnliche Probleme auf. Mit Textomat-Versionen, die nach 1983 auf den Markt kamen, soll laut Firmenauskunft das Interface zusammenarbeiten.

### Easyscript, die große Ausnahme:

Nur Easyscript konnte an die EP 44 angepaßt werden. Alle anderen Textprogramme konnten hingegen auch nach längerem »Herumtüfteln« nicht in Verbindung mit der EP 44 verwendet werden.

Wichtig ist, wie der Druckerkanal eröffnet wird:
OPEN 1,2,2, CHR$(6) + CHR$(1)

Nur nach diesem OPEN-Befehl werden Texte einwandfrei ausgedruckt. Über die RS232-Leitung akzeptiert die EP 44 nur 7 Steuercodes wie:
BS (Backspace)
HT (Horizontal Tabulation)
LF (Line Feed)
CR (Carriage Return)

Wenn man schon eine programmierbare Schreibmaschine mit Textspeicher besitzt, stellt sich natürlich die Frage, ob die Programmierung auch über den Computer erfolgen kann, oder ob die gespeicherten Texte mit Hilfe des C 64/VC 20 auf Diskette oder Kassette gespeichert werden können. Leider ist das Interfacekabel hierfür nicht vorgesehen. Auf besondere Bestellung können Sie aber von Brother ein bidirektionales Interface erhalten. Der Textspeicher kann nur über die eigene Schreibmaschinentastatur bearbeitet werden. Es ist dann möglich, den in der Schreibmaschine gespeicherte Text in den C 64 zu holen. An die Brother EP 44 läßt sich direkt ein Modem anschließen. Kombiniert man sie mit einem batteriebetriebenen Akustikkoppler, so wird aus der Brother ein portables Datenterminal, mit dem man sogar aus Telefonzellen in Datenbanken oder Mailboxen herumstöbern kann.

Die Brother EP 44 ist eine wirklich gute elektrische Thermo-Matrix-Schreibmaschine mit hervorragendem Schriftbild. Wegen ihrer Größe und Gewicht eignet sie sich vor allem für kleine Arbeiten unterwegs (im Flugzeug oder Zug). Auch als Datenterminal findet die EP 44 eine gute Anwendung. Bemerkenswert ist der große Zeichensatz, der alle europäischen Sonderzeichen beinhaltet. Als Drucker für den C 64 und VC 20 eignet sich die EP 44 nur bedingt.

Für alle, die eine portable Schreibmaschine brauchen und nur ab und zu etwas über den Computer ausdrucken lassen wollen, ist die EP 44 absolut empfehlenswert.

(Christian Q. Spitzner/hm)

Info: Brother, im Rosengarten 14, Postfach 1320, 6368 Bad Vilbel, Preis 799 Mark; Druckerkabel 149,—, Netzadapter 39.—

# Marktübersicht: Drucker [28-29]

> Mit dieser Marktübersicht zeigen wir Ihnen, welche Thermo- und Tintenstrahldrucker und welche Plotter es für einen Heimcomputer wie den C 64 gibt.

In der Übersicht haben wir Drucker, die deutlich über 2000 Mark kosten, nicht berücksichtigt. Denn Geräte, die diese Preisgrenze überschreiten, sind für den Anschluß an den C 64 wenig sinnvoll, kosten sie doch fast schon viermal soviel wie der Computer selbst.

Die Marktübersicht beruht auf Herstellerangaben und erhebt keinen Anspruch auf Vollständigkeit. Außerdem sollen alle genannten Drucker an den C 64 anschließbar sein. Wenn nötig, über ein passendes Interface.

Die Vorteile der hier aufgeführten Drucker:

### Thermodrucker

Diese Geräte gehören in der Regel zu den billigeren Druckern. Brauchen aber teures Spezialpapier oder extra Plastik-Carbon-Band, wenn mit normalem Papier geschrieben werden soll.

### Tintenstrahldrucker

Wollen Sie einen leisen Drucker mit den Fähigkeiten eines Nadel-Matrixdruckers, sind diese Drucker die richtigen. Zum Druck brauchen Sie spezielle Tinte und saugfähiges Papier.

### Plotter

Plotter sind im Prinzip keine Drucker. Vielmehr: Sie haben damit fast nichts gemeinsam. Zwar können Plotter Buchstaben schreiben, aber diese Funktion dient in der Regel nur der Beschriftung von Grafiken. Die Stärke der Plotter liegt beim Zeichnen von Grafiken, die aus Linien bestehen. Eine Linien-Grafik darf nicht mit einer Hardcopy verwechselt werden. Beim Druck von Hardcopies bleibt nämlich ein Matrixdrucker ungeschlagen.

Ein Merkmal haben alle hier vorgestellten Drucker gemeinsam: Während der Arbeit sind sie fast nicht zu hören und haben schon deshalb verschiedenste Einsatzberechtigungen. Haben Sie zu Hause kleine Kinder, die schlafen sollen, während Sie Ihrem Computerhobby nachgehen? Dann wäre ein »Tintenspritzer« ein geeigneter Ersatz für einen eventuell ins Auge gefaßten Typenrad- oder Nadeldrucker.

(hm)

# Mailbox für Anfänger [30]

> Das Medium Mailbox fasziniert. Der Einsteiger zeigt allerdings oft noch eine gewisse Scheu. Anhand eines Beispiels zeigen wir, wie einfach der Umgang mit DFÜ sein kann!

Als erste und. wichtigste Regel gilt: Ist die Verbindung zu einer Ihnen fremden Mailbox hergestellt, sehen Sie sich die Anleitung an. Dies ist aus zwei Gründen wichtig. Zum einen werden in den meisten Fällen Menüaufrufe nur abgekürzt auf den Bildschirm gebracht, mit denen ein Neuling kaum etwas anfangen kann. In der Decates-Box wäre dies »Ihre Eingabe (A,P,D,0-6,9)«. Erst die Anleitung gibt Aufschluß, daß nur RETURN ohne andere Eingabe das Hauptmenü ausführlich anzeigt.

Zum anderen kann es bei nicht so ausgefeilten Boxen wie Decates vorkommen, daß Fehleingaben zum Programmabsturz führen. Wenn dann der Systemoperator nicht zur Stelle ist, ist die Box erst einmal für alle Anrufer nicht erreichbar.

Ein weiteres wichtiges Thema ist der Informationsaustausch. Diese Rubrik dient hauptsächlich zwei Zwecken. Interessante Informationen möglichst vielen DFÜ-Fans bekannt zu machen und Kontakt zwischen einzelnen herzustellen. Eingaben wie »Ich grüße alle Hacker, xyz« oder »Ich war hier, xyz« machen eine Box nur unübersichtlich und treiben die Telefonkosten in die Höhe. Damit ist also niemandem gedient!

Noch ein Hinweis zum Schluß. Gerade neue Mailboxen sind oft auf die Hilfe von ihren Anrufern angewiesen. Die meisten Betreiber einer Mailbox sind für jeden Tip und Verbesserungsvorschlag dankbar. Beachtet man diese Regeln, steht einer guten Zusammenarbeit zwischen Anrufern und Mailboxbetreibern nichts mehr im Wege.

(rg)

# Marktübersicht: Modems und Akustikkoppler [32-34]

> Die Preise für Modems und Akustikkoppler reichen von 138 bis 1590 Mark. Wo die Unterschiede bei den Geräten liegen, läßt sich, nur im direkten Vergleich feststellen. Unsere Marktübersicht hilft Ihnen, die Übersicht zu behalten.

Die »Gerätevielfalt« bei den Modems und Akustikkopplern reicht von einfachen Platinen, an denen ein Mikrofon und ein Lautsprecher angelötet sind, bis zu optisch und technisch hochwertigen Geräten. An dieser Stelle wollen wir nur kurz auf zwei Akustikkoppler hinweisen. Alle anderen Angaben entnehmen Sie bitte der Tabelle.

Der erste Akustikkoppler ist das »Akustikkoppler-Modul« von Drust. Es handelt sich hierbei um die oben erwähnte Platine. Dieses Gerät ist nur all denen zu empfehlen, die über einen absolut schalldichten Raum verfügen. Nebengeräusche machen jede Datenfernübertragung nahezu unmöglich. Leserbriefe, die die Redaktion erreichten, bestätigten unsere Testergebnisse.

Das zweite Gerät ist der Akustikkoppler »Dataphon s 21 d« (baugleich mit dem CTK 1000). Diese Gerät überzeugt durch Übertragungsgenauigkeit und niedrigen Preis.

Unsere Marktübersicht erhebt keinen Anspruch auf Vollständigkeit und beruht auf den Angaben der Hersteller.

(rg)

# Wie sage ich es meinem EPROM? [35-36,38]

> Die Programmierung von EPROMS hat ihren besonderen Reiz. Doch was ist das eigentlich, ein EPROM? Wir stellen die wichtigsten EPROM-Typen der 25er und 27er Reihe vor und zeigen Ihnen, wie man sie programmiert.

Bei Halbleiterspeichern muß man zwischen Festwert- und Schreib-/Lesespeichern unterscheiden. Die Festwertspeicher gliedern sich in ROMs (**R**ead **O**nly **M**emory), PROMs (**P**rogramable ROM), und EPROMs. Die EPROMs haben gegenüber den anderen Festwertspeichern den Vorteil, daß sie sich nach einer Programmierung wieder löschen lassen. Sie sind also für Anwendungen, in denen keine größeren Stückzahlen anfallen oder öfters Änderungen gemacht werden müssen, prädestiniert. Auch die Preise bei den Speicher-ICs haben in den letzten Jahren einen so erfreulichen Verlauf genommen, daß es sich in vielen Fällen lohnt, häufiger benötigte Programme als Modul in EPROMs zu speichern. Der Wermutstropfen bei ihrer Anwendung ist die relativ komplizierte Programmierung, für die ein eigenes Gerät benötigt wird.

## EPROM-Typen

Die ersten EPROMs benötigten noch drei Versorgungsspannungen und waren nur mit großem Aufwand zu programmieren. Da ihr Preis inzwischen auch mehr als »Liebhaberpreis« zu sehen ist, soll auf diese »antiken« Stücke nicht näher eingegangen werden. Später gingen die Hersteller dazu über, Speicherbausteine mit einer 5 Volt Spannungsversorgung zu produzieren. Dadurch wurde der Aufwand, EPROMs zu programmieren, erheblich reduziert. Der erste Typ, der 2508, hatte eine Kapazität von 1 KByte. Alle EPROMs werden nach dem sogenannten Bytewide-Prinzip gefertigt, das heißt sie haben acht Datenleitungen. Dies hat den Vorteil, daß zum Anschluß an einen 8-Bit-Mikroprozessor nur ein IC benötigt wird. Hinzu kommt, daß die Pinbelegung der EPROMs so konzipiert ist, daß sie untereinander und zu vielen statischen RAM-ICs weitgehend kompatibel sind.

EPROMs mit 2 KByte heißen 2716 oder 2516, wobei jedoch beim Kauf von 2716ern Vorsicht geboten ist, da vereinzelt auch noch ältere 3-Spannungstypen unter diesem Namen gehandelt werden. 4 KByte EPROMs gibt es im Handel unter den Bezeichnungen 2732 und 2532. Diese beiden Typen unterscheiden sich in den Pins 18 und 21. Der Grund für diese Abweichung ist darin zu suchen, daß Texas Instruments, der Hauptlieferant für 2532er, bei ihren EPROMs eine direkte Pin-Kompatibilität zu den bestehenden MaskenROMs suchte, während die meisten anderen Hersteller die 4 KByte-EPROMs aufwärtskompatibel zu den größeren 28poligen Typen machen wollte. Das Bemühen von TI wird noch deutlicher, wenn man den 2564, den 8 KByte-Typ dieses Herstellers, betrachtet. So ist es möglich, dieses 28polige IC direkt mit dem unteren Teil in einen 24poligen Sockel für ein 8 KByte-ROM zu setzen, wie zum Beispiel das Kernal-ROM des C 64, falls es gesockelt ist. Die Pins 1, 2, 27 und 28 sind einfach wie in Bild 1 gezeigt zu beschalten. Diesen Vorteil des 2564 muß man jedoch mit einem etwas höheren Preis bezahlen.

Der bei weitem verbreitetere 8 KByte-Typ ist der 2764. Er ist zur Zeit das EPROM mit dem günstigsten Preis/Bit-Verhältnis. Die Typenbezeichnung ist bei diesen EPROMs äußerst logisch aufgebaut. Die Zahl hinter der 25 beziehungsweise 27 gibt die Kapazität des Speichers in KBit an. Also: 2764 bedeutet 64 KBit oder 8 KByte. Folglich heißen die größeren Typen 27128 (16 KByte), 27256 (32 KByte) und 27512 (64 KByte). Ein EPROM mit 1 Megabit Speicherkapazität ist von NEC angekündigt, wird jedoch in einem 40poligen Gehäuse angeboten werden.

Diese immensen Speichergrößen sind aber im Moment den professionellen Anwendern vorbehalten und können von Homecomputern mit 8-Bit-CPUs nicht sinnvoll verwaltet werden. Einen sehr geeigneten Schritt hin zur leichteren Verwaltung großer EPROM-Bänke hat Intel mit ihrem 27513 (Bild 2) gemacht. Dieses EPROM ist seitenorientiert aufgebaut, das heißt es besteht aus vier EPROM-Bänken mit jeweils 16 KByte. Die Auswahl der aktiven Bank erfolgt über einen Schreibbefehl m ein internes Register des 27513. Beim Schreibbefehl werden die an den Datenleitungen D0 und D1 anliegenden Informationen übernommen und zur Seitenadresse decodiert. Beim Einschalten der Versorgungsspannung wird automatisch die Seite Null aktiviert, so daß man einen definierten Systemzustand erhält. Mit einem 27513 lassen sich also mit einem Befehl vier 16 KByte-Blöcke umschalten. Es ließen sich also auch umfangreichere Programme auf kleinere Computer umschreiben und in einem Chip unterbringen. Für den Expansion-Port des C 64 wäre dieses IC geradezu ideal. Es wird jedoch noch zirka zwei Jahre dauern, bis dieser Baustein preislich mit anderen Lösungen konkurrieren kann.

Nach soviel Zukunftsmusik nun wieder zur Realität: Der Bedeutung der einzelnen Pins eines EPROMs und der Programmierung.

## Der 2764 unter der Lupe

Das 28polige Gehäuse des 2764 (Bild2) hat 13 Adreßleitungen, A0 bis A12. Sie dienen zur Auswahl der angesprochenen Speicherstelle und sind binär codiert. Der Chip hat acht Datenleitungen OO bis 07, die bei einem Lesezugriff das Datenwort führen. Während der Programmierung müssen hier die zu programmierenden Bytes angelegt werden. Ferner gibt es noch eine Chip-Enable-(CE), eine Output-Enable-(OE) und eine Program-Leitung (PGM). Ihre Funktionen zeigt Bild 3. Die 5 Volt-Versorgungsspannung wird an Pin 28 (VC0) angeschlossen, Pin 1 (Vpp) führt während der Programmierung 21 Volt sonst 5 Volt. Alle Spannungen beziehen sich auf das mit Pin 14 (GND) verbundene Massepotential.

### Konventionelle Programmierung

Beim Programmbeginn muß PGM auf Low-Pegel liegen. Dann erst darf die Programmierspannung von 21 Volt angelegt werden. Diese Spannung kann bis zum Ende der Programmierung angelegt bleiben, muß also nicht zum Verifizieren der Daten abgeschaltet werden. Nur vor der Entnahme des ICs aus der Fassung sollte man die Spannung abschalten, um ungewollte Programmierungen oder sogar die Zerstörung des Chips zu vermeiden. Während der gesamten Programmierung muß der 2764 selektiert sein, das heißt, der Chip-Enable-Eingang auf Low-Pegel liegen. MitOE = high werden die Ausgänge des EPROMs abgeschaltet. Jetzt werden die Adresse und das entsprechende Datenwort angelegt und, wenn diese stabil anliegen, die Programmierung durch einen 50 ms langen negativen Impuls an PGM vollzogen. Jetzt werden die Daten von den Ausgängen OO bis 07 des EPROMs entfernt und der Inhalt der gerade programmierten Speicherzelle mit OE = Low-Pegel ausgelesen. Stimmt er nicht mit dem Sollwert überein, so ist entweder das IC oder das Programmiergerät nicht in Ordnung. Ist die Zelle korrekt »gebrannt«, kann man, nachdem OE wieder auf High-Pegel gebracht wurde, mit dem nächsten Byte fortfahren. Da die vollständige Programmierung eines 2764 mit diesem Verfahren zirka 7 Minuten dauert, haben sich die meisten Hersteller einen schnelleren Programmieralgorithmus ausgedacht (Bild 4), der die Programmierzeit für einen 2764 auf zirka 75 Sekunden verkürzt. Diese immense Zeiteinsparung ist vor allem für den kommerziellen Anwender wichtig, da sie oftmals die Anschaffung eines teuren Produktions-EPROMmers, der mehrere ICs gleichzeitig brennen kann, überflüssig macht. Aber auch für den Amateur ist eine solche Zeiteinsparung angenehm, zumal der schnelle Algorithmus keine umfangreichen Änderungen an der Hardware des Programmiergeräts benötigt.

## Der schnelle Programmieralgorithmus

Um die Methode der schnellen Programmierung zu verstehen, ist es hilfreich, sich eine Vorstellung von dem zu machen, was sich bei der Programmierung in einer Speicherzelle abspielt. Eine EPROM-Zelle besteht im wesentlichen aus einem Feldeffekttransistor mit isoliertem Gate. Die Spannung des Gates beeinflußt maßgeblich den Strom zwischen Source und Drain, den beiden anderen Anschlüssen des Transistors. Wird nun die Zelle bei einem Lesezugriff angesprochen, so erzeugt dieser Strom einen Spannungsabfall, der mit einem festen Wert, der Schwellspannung, verglichen wird. Ist die Spannung kleiner als die Schwellspannung, also das Potential am Gate des Zelltransistors noch zu niedrig, dann ist der korrespondierende Ausgang des Speichers auf High-Pegel. Nach dem Löschen mit UV-Licht oder beim Kauf eines neuen Chips sind die Gates der Zelltransistoren ungeladen. Deshalb haben neue EPROMs immer den Inhalt »$FF«. Durch die Programmierung wird die Ladung auf dem Gate erhöht und es kann nun, wenn man während des Programmierens öfters den Speicherinhalt überprüft, der Zeitpunkt bestimmt werden, zu dem die Daten das erste Mal richtig in den Zellen stehen. Das bedeutet jedoch nicht, daß der Inhalt nun stabil für immer in den Zellen erhalten bleibt, sondern daß die Schwellspannung zum ersten Mal überschritten wurde. Die schnellen Programmieralgorithmen messen die Zeit bis dies geschieht und programmieren dann noch einmal ein Vielfaches dieser Zeiten. Je nach Hersteller zwischen dem ein- und vierfachen).

Damit die Daten über den gesamten Temperatur- und Versorgungsspannungsbereich stabil sind, wird von allen schnellen Algorithmen eine weitere Aktion vor der eigentlichen Programmierung unternommen.

Die Versorgungsspannung wird von 5 auf 6 Volt erhöht. Die Schwellspannung, die zum Vergleich, ob eine Zelle geladen ist oder nicht, herangezogen wird, wird nämlich aus der Versorgungsspannung abgeleitet. Ist diese Schwellspannung nun etwas höher, so läßt der Algorithmus die Speicherzellen alle etwas länger brennen, als es für den normalen Betrieb eigentlich nötig wäre. Dies bringt zusätzliche Sicherheit, besonders an den Grenzen des erlaubten Betriebsbereiches und eine gute Langzeitstabilität.

## Programmiergeräte

Das Komplizierteste am Selbstbau eines EPROM-Programmiergerätes ist das programmgesteuerte Umschalten von stabilen Spannungen an den verschiedenen Pins der Wechselfassung. Um ein universell verwendbares Gerät zu erhalten, sind drei Programmierspannungen (12,5 V 21 V 25 V) und die Möglichkeit, für den schnellen Algorithmus die Versorgungsspannung auf 6 Volt zu erhöhen, vorzusehen. Die Auswahl zwischen den EPROM-Typen kann man entweder über Schalter oder rein softwareseitig machen. Die Adressen-, Daten- und Steuerleitungen werden am einfachsten über Parallel-Ports geführt, da diese sehr leicht zu programmieren sind. Ein großes Problem bleibt die Stromversorgung. Es ist wünschenswert, ohne einen zusätzlichen Netztrafo auszukommen, nicht nur weil meistens die letzte Steckdose schon besetzt ist, sondern weil es für einen unerfahrenen Bastler die unliebsame Bekanntschaft mit 220 Volt zu vermeiden hilft. Für den C 64 bietet sich die Benutzung des User-Ports an, da er die 9 Volt Wechselspannung des Computers an den Pins 10 und 11 führt. Nachteilig für den Selbstbau ist die äußerst schwierige Programmierung der I/O-Leitungen. Als Alternative zum User-Port bliebe nur noch der Expansion-Port, der einen sehr einfachen Anschluß von Portbausteinen gestattet.

Der Nachteil dieser Alternative ist die Notwendigkeit, die Programmierspannung durch einen Gleichspannungswandler aus den 5 Volt zu gewinnen. Erstens sind solche Wandler nicht gerade billig, und zweitens wird dadurch sehr schnell die Belastungsgrenze der Computerstromversorgung erreicht. Aus den 5 Volt sollten nicht mehr als 300 mA entnommen werden, während die 9 Volt-Spannung etwas unempfindlicher auf Überlastung reagiert. Wem nach diesem kleinen Einblick in die Problematik eines solchen Projektes noch nicht der Mut zum Selbstbau eines Programmiergerätes verlassen hat, dem sei angeraten, sich die Datenblätter der Hersteller zu Gemüte zu führen. Jedoch sollte ein solcher Selbstbau wirklich dem Freak vorbehalten bleiben, da mit Spannungen gearbeitet wird, die den C 64 leicht zerstören können.

## XROM und GAME

Der C 64 hat die Möglichkeit, im Expansion-Port EPROM-Module aufzunehmen, die in den Adreßbereichen $8000 bis $9FFF und $A000 bis $BFFF liegen. Um dem Computer mitzuteilen, ob in dem Expansion-Port ein EPROM steckt, hat er die Leitungen XROM und GAME. Wird XROM auf Low-Pegel gelegt, schaltet der Computer sein internes RAM von $8000 bis $9FFF ab und erzeugt für diesen Bereich einen Chip-Select (ROML), das direkt an den Chip-Select-Eingang des EPROMs gelegt werden kann. Wenn GAME auf low gelegt wird, so schaltet der C 64 seinen Basic-Interpreter ab und erzeugt für den Bereich von $A000 bis $BFFF das Chip-Select-Signal (ROMH), das ebenfalls an den Chip-Select-Eingang des EPROMs gelegt werden kann. Es ist verständlich, daß dieser Bereich nur für Maschinensprache oder andere nicht auf das Basic zugreifende Programme geeignet ist.

## Autostart

Der C 64 kann Programme im $8000-Bereich als Autostart-Programme identifizieren. Als Indiz dient ihm der CBM80-Code in den Adressen von $8004 bis $8008. Zu beachten sind die nicht dem ASCII-Code entsprechenden Buchstabencodes des C 64. Sind also die Speicherzellen von $8004 an mit den HEX-Werten $C3, $C2, $CD, $38 und $30 gefüllt, so springt der Computer indirekt über die Adresse $8000 in das Programm. ($8000 = Low-Adresse und $8001 = High-Adresse). In den Adressen $8002 und $8003 steht der neue NMI-Vektor im Low-/High-Format.

## Basic-Programme

Um Basic-Programme mit Autostart in EPROMs zu brennen, empfehlen wir einen Blick in die Ausgabe 9/84, Seite 163. In dem Artikel ist ein Verschiebeprogramm in Maschinensprache abgedruckt, womit ein nach $8100 verschobenes Basic-Programm wieder korrekt zurückgelegt und gestartet wird.

Mit dieser Hilfe müßte es möglich sein, ein einfaches Programm zu schreiben, das ein Basic-Programm einfach hinter den Lader schreibt und für den Prommer als HEX-Datei zum Beispiel nach $2000 schiebt.

## EEPROMs

Eine neue Entwicklung der Halbleiterindustrie ist das EEPROM, ein Speicher, der sich elektrisch löschen läßt (statt wie bisher mit UV-Licht) und seinen Inhalt beim Abschalten der Versorgungsspannung nicht verliert. Diese Bausteine müssen zum Programmieren nicht aus der Schaltung entfernt werden. Die Schreibdauer liegt bei zirka 10 ms. Das ist verglichen mit RAM-ICs sehr hoch. Deshalb gibt es, vor allem von kleineren amerikanischen Firmen, Speicher, die ein statisches RAM mit einem EEPROM auf einem Chip kombinieren. Solche NOVRAMs (**N**onvolatile **R**andom **A**ccess **M**emory) haben die kurzen Zugriffszeiten eines RAMs und die Möglichkeit, mit einem Befehl den gesamten RAM-Inhalt auf einmal in die EEPROM-Zellen zu schreiben. Es müssen aber noch einige technische Probleme beseitigt werden, wie etwa die zur Zeit auf zirka 10000 Schreibzyklen pro Speicherzelle beschränkte Lebensdauer.

(Klaus Zietlow, Arnd Wängler/ah)

# Frisch gebrannt ist halb gespeichert [39-40,160]

> Die andere Hälfte, die Sie zum Programmieren von EPROMs brauchen, ist ein EPROM-Programmiergerät. Unser Vergleichstest stellt einige Modelle auf eine harte Probe.

Es ist fast ein Jahr her, seit wir Ihnen das letzte Mal EPROM-Programmiergeräte vorgestellt haben. Damals galt jemand, der sich seine eigenen Speicherbausteine programmierte noch als Insider und Freak. Mittlerweile, und die täglich bei uns eingehenden Anfragen beweisen das, beschäftigt sich ein Großteil der C 64-Besitzer mit dieser Art der Datenspeicherung. Mit gutem Grund, denn erst die Programmierung von EPROMs/PROMs erlaubt es, »Ladezeiten« auf Nanosekunden zu reduzieren. So sind beispielweise Änderungen des Betriebssystems oder neue Zeichensätze am besten im Computer aufgehoben. Der Erfolg und das Interesse der Hypra-Perfekt-Kernal-Version zeigt, wie reizvoll gerade diese Anwendungsart ist.

Um aber in der Lage zu sein, EPROMs/PROMs zu programmieren, benötigt man ein Zusatzgerät. Diese Erweiterung, die entweder am User-Port (Regelfall) oder aber am Expansion-Port (Ausnahme) angeschlossen wird, erfüllt mehrere Aufgaben. Zum einen ist es möglich, EPROMs zu lesen und deren Inhalt auf Diskette abzuspeichern, zum anderen können beliebige Programme von Diskette auf ein neues EPROM übertragen werden.

Eines unserer Testgeräte kann sogar ähnlich wie ein Floppy-Laufwerk bedient werden und erlaubt Befehle wie GET, INPUT, PRINT, LOAD, SAVE. Dadurch kann es auch die brandneuen EEPROMs (Electrical Ereasable Programmable Read Only Memorys) verarbeiten.

Keines unserer Testgeräte kostet mehr als 300 Mark. Selbst wenn man den Preis des Computers noch hinzurechnet, erhält man eine EPROM-»Brennerei«, die Leistungen wie eine professionelle Anlage hat, aber nur einen Bruchteil davon kostet.

Unser Testfeld bestand aus insgesamt sechs Geräten, von denen aber eines disqualifiziert werden mußte. Es war eine fast 100prozentige Kopie des EPROM 64 von Roßmöller (Nummer 1 im Bild). Sowohl die Software, als auch der Aufbau der Hardware wurde vom Prinzip her nicht verändert. Es wird eben nicht nur bei Rolex und Cartier geklaut, sondern auch im Zusatzgerätehandel.

Der EPROM 64 nahm nochmals am Test teil, aber als Referenzgerät. Alle Testkandidaten wurden mit den Leistungen des EPROM 64 verglichen, der ja immerhin schon eine über ein Jahr alte Entwicklung ist. Zum Test waren angetreten: Das Thienel-Programmiergerät (Nummer 5), das Gerät von John Hall (Nummer 4), das Dela-Programmiergerät (Nummer 3) und der PP 64 von Indutronic (Nummer 2).

## Der Super-EPROMmer

Gleich vom ersten Moment an hat der PP 64 von Indutronic (Nummer 2) einen sehr guten Eindruck gemacht. Er ist sehr sauber aufgebaut, bedarf keiner zusätzlichen Schalter mehr auf der Platine, hat ein ausführliches Handbuch und besticht durch seine Leistungsfähigkeit. Mit dem PP 64 können nicht nur so gut wie alle EPROM-Typen (siehe Tabelle) programmiert werden, er verfügt auch über eine Funktion, mit der EPROMs von Basic aus wie ein Floppy-Laufwerk angesprochen werden. Man kann sich sogar eine Art Directory des EPROMs anlegen. Auch Befehle wie OPEN und PRINT# sind möglich, die Geräteadresse des Gerätes ist in diesen Fällen 16. Zusätzlich zu dieser Funktion bietet die mitgelieferte Software einiges an Bedienungskomfort, der eigentlich kaum Wünsche offen läßt (Tabelle).

Der PP 64 beweist, daß nicht unbedingt jedes EPROM mit ein und demselben Programmieralgorithmus gebrannt werden muß. Je nach gewähltem EPROM-Typ wird einer von vier verschiedenen Algorithmen verwendet. Das stellt nicht nur sicher, daß EPROMs die für sie optimale Programmierzeit bekommen, sondern auch eine lange Lebensdauer der EPROMs. Bei einem immer noch relativ hohen Preis für EPROMs ist das besonders wichtig. Es ist ein einfaches Rechenexempel: Ein schlechtes Programmiergerät zerstört so manches EPROM schon nach kurzer Zeit. Ein gutes Programmiergerät erlaubt aber die EPROMs in ihrer ursprünglichen Funktion, nämlich als mehrfach lösch- und beschreibbaren Speicherbaustein zu verwenden. Die vier Programmieralgorithmen des PP 64 garantieren das. Allerdings ist er mit einem Preis von 1953 österreichischen Schillingen (279 Mark) auch nicht gerade billig. Zu den weiteren Besonderheiten gehören eine Löschroutine beim Programmieren von EEPROMs und ein automatisches Verify jedes programmierten Bytes. Durch seinen Anschluß am User-Port des C 64 ist der PP 64 universell am C 64/VC 20 ohne weitere Stromzuführung zu betreiben. Alle Programmierspannungen werden aus den dort zur Verfügung stehenden 9 Volt/5 Volt erzeugt. Die Belastung des Netzteils hält sich dabei in Grenzen. Seine weit gefächerten Programmierfähigkeiten, seine komfortable Software und sein Normenkonformität machen den PP 64 zum Spitzenreiter unseres Tests. Er schlägt damit auch unseren letztjährigen Testsieger.

## Der Preiswerte

Das Programmiergerät von Dela (Nummer 3) ist das preiswerteste der getesteten Geräte. Bei einem Preis von 159 Mark für das fertige Gerät (Bausatz 79 Mark ohne Sockel, 109 Mark mit Textool-Sockel) bietet das Dela-Programmiergerät durchaus sehenswerte Leistungen. Zwar programmiert es nur EPROMs vom Typ 27xxx bis hin zum 27128, da diese aber wohl die gebräuchlichsten sein dürften, reicht es in den meisten Fällen. Auch das Dela-Programmiergerät wird am User-Port angeschlossen und kommt ebenfalls ohne zusätzliche Schalter aus. So gesehen ist er sogar besser als unser Referenzgerät, bei dem ja immer noch zwei Schalter bedient werden müssen. Die zugehörige Software erfüllt fast alle Ansprüche. Es ist sogar ein Monitor eingebaut, dessen Funktionen durchaus professionell sind. Er kennt die Befehle LOAD, SAVE, FILL, DISASSEMBLE, MEMORYDISPLAY, HUNT, TRANSFER, GO, WALK sowie eine Hex-Dez-Umrechnung. Nur zwei Dinge sind es, die beim Arbeiten mit dem Dela-Programmiergerät fehlen: Zum einen ist keine Funktion vorgesehen, um den Speicherinhalt des EPROMs mit dem des C 64 zu vergleichen, zum anderen wird keine Plausibilitätskontrolle der Eingaben durchgeführt. Eingabefehler beim Programmieren sind deshalb nicht auszuschließen.

Die wesentlichste Besonderheit des Dela-Programmiergerätes sind seine zwei Programmiergeschwindigkeiten. Im Normalmodus wird mit 50 Millisekunden programmiert, ein 2764-EPROM benötigt auf diese Weise ungefähr 7 Minuten. Im Fast-Modus wird die Programmierzeit auf 2 bis 5 Millisekunden pro Byte herabgesetzt. Das gleiche EPROM ist dann schon nach 22 Sekunden fertig. Positiv ist auch, daß leere Bytes ($FF) nicht programmiert werden (denn das ist ja der normale Inhalt eines EPROMs). Mit dem Einzel-Byte-Modus können auch Teile eines EPROMs programmiert werden. Das Dela-Programmiergerät zeichnet sich vor allem durch seinen Preis und die doch recht gute Software aus. Wie sich EPROMs, die im Fast-Modus programmiert wurden auf Dauer verhalten, läßt sich leider erst in ein paar Jahren sagen, denn dann besteht die Gefahr des Datenverlustes.

## Module leicht erstellt

Das Programmiergerät von John Hall (Nummer 4) beschränkt sich ebenfalls auf die Programmierung der 27xxx-Reihe. Allerdings können mit diesem Programmiergerät auch EPROMs vom Typ 27256 gebrannt werden. Dafür kostet das John-Hall-Programmiergerät aber mit 198 Mark auch 30 Mark mehr als das Dela-Programmiergerät. Damit sind die besonderen Fähigkeiten des John-Hall-Programmiergerätes allerdings bei weitem noch nicht erschöpft. Zwar muß bei ihm immer noch ein Schalter betätigt werden, der Rest wird aber von der sehr komfortablen Software eingestellt. Sie erlaubt vor allem das freie Verlegen der Treibersoftware in verschiedene Bereiche, so daß es in den seltensten Fällen zu Konflikten mit Programmen, die einen bestimmten Speicherbereich belegen, kommt. Die eigentliche Besonderheit dieses Gerätes ist aber die Fähigkeit, von jedem Basic-Programm bis zu 8 KByte Länge ein selbststartendes Modul zu erstellen. In diesem Modul werden Verschieberoutinen und Initialisierungsbefehle automatisch mitprogrammiert. Basic-Programme mit mehr als 8 KByte müssen aus mehreren Programmiervorgängen zusammengesetzt werden.

Das John-Hall-Programmiergerät verfügt über einen automatischen Leertest und ist voll menügesteuert. Zusammen mit der ebenfalls von diesem Hersteller erhältlichen 128-KByte-Platine können somit regelrechte ROM-Erweiterungen von enormer Größe gebaut werden. Da das John-Hall-Programmiergerät nur einen Programmieralgorithmus von 50 Millisekunden besitzt, dauert das Programmieren eines 2764-EPROMs zirka 7 Minuten. Gemessen an seinen Fähigkeiten, kann diesem Gerät ein befriedigendes Preis-/Leistungs-Verhältnis bescheinigt werden.

## Es geht auch am Expansion-Port

Das Thienel-Programmiergerät wird im Gegensatz zu den anderen Geräten am Expansion-Port angeschlossen. Er benötigt deshalb auch eine zusätzliche Stromversorgung. Dafür zeichnet sich das Gerät aber durch seine enorme Leistungsfähigkeit aus. Die Treibersoftware befindet sich direkt auf dem Gerät und startet automatisch (abschaltbar). Zusätzlich ist sogar noch ein weiterer Steckplatz für ein 2764-EPROM vorgesehen. Bei diesem Gerät müssen keinerlei Schalter bedient werden, denn die Auswahl der EPROM-Typen wird rein über Software gesteuert. Fast alle derzeit wichtigen Typen sind programmierbar. EEPROMs wurden dabei allerdings nicht berücksichtigt. Die Software erlaubt das komfortable aber leider auch falsche Programmieren. Mit dem eingebauten Monitor werden Programme eingeladen, beziehungsweise ausgelesene EPROMs abgespeichert. Alle anderen wesentlichen Funktionen erreicht man durch einfache Auswahl aus einem Menü.

Bei der Programmierzeit wurde ein Kompromiß zwischen Geschwindigkeit und Datensicherheit eingegangen. Während des Tests gab es allerdings keinerlei Schwierigkeiten mit den programmierten EPROMs. Sie enthielten alle eingegebenen Werte. Einziger Nachteil dieses ab 248 Mark teuren Gerätes ist wohl der nicht durchgeschleifte Expansion-Port. Nach dem Einsetzen des Brenners ist dieser belegt und kann nicht mehr für andere Module verwendet werden.

Von Roßmöller wurde ein wesentlich verbessertes EPROM-Programmiergerät angekündigt. Damit sollen sich auch EPROMs und EEPROMs vom Typ 27512 programmieren lassen. Weiterhin soll dieses Gerät mit einer RS232- und einer Centronics-Schnittstelle (6-KByte-Druckerpuffer) ausgestattet sein. Dies soll zusammen mit einer 6502-CPU den Anschluß an alle Computer mit dieser Schnittstelle ermöglichen. Das Brennen von Basic-Programmen mit Autostart soll ebenso wie ein wesentlich verbessertes Video-Signal das Gesamtbild abrunden. Der Einführungspreis liegt nach Angaben des Herstellers bei 398 Mark. Über Lieferzeiten war noch nichts zu erfahren.

## Fazit

Es hat sich etwas getan. Die Hersteller von EPROM-Programmiergeräten haben erkannt, daß hier ein weites Betätigungsfeld für den Anwender liegt. Dementsprechend ausgereift sind auch die getesteten Geräte. Es war kein Gerät im Test, das nicht als gut bezeichnet werden könnte. Besonders gefallen hat der PP 64. Auch das Dela-Programmiergerät mit seinem unschlagbaren Preis kann mit zur Spitzengruppe gezählt werden. Tapfer geschlagen hat sich auch unser bisheriges Referenzgerät (das mittlerweile 198 Mark kostet), das bis auf die nicht mehr zeitgemäße Einstellung per Schalter nur vom PP 64 geschlagen wurde. Interessant dürfte auch der »Neue« von Roßmöller werden.

(Arnd Wängler/ah)

# Aus eins mach vier [41-43]

> Wir stellten schon mehrere geänderte Betriebssysteme für den C 64 vor. Das beste Beispiel ist das Hypra-Perfekt. Diese Bauanleitung setzt der ganzen Sache die Krone auf: Absturzfreies Umschalten zwischen vier Betriebssystemen.

Die Idee zu dieser Schaltung lieferte eigentlich das Hypra-Load-Programm in der Betriebssystemversion, welches ein neues EPROM im Kernalsteckplatz U 4 erfordert. Mit etwa 98 Prozent der Programme funktioniert dies hervorragend. Für die restlichen 2 Prozent, mit denen es Schwierigkeiten gibt, hilft allerdings nur, das Originalkernal wieder einzusetzen. Meistens ist das der Fall, wenn Kassetten-Routinen benötigt werden. Eine Umgehung des ständigen Ein- und Ausbaus bietet sich mit einer Betriebssystemumschaltung an. So könnte ein Programm mit Hypra-Load geladen und anschließend auf das Originalsystem zurückgeschaltet werden. Dadurch wäre eine 100prozentige Programmverträglichkeit gewährleistet. Allerdings nur, wenn beim Umschalten, der Computer nicht »abstürzt«.

Aus diesen Gedanken heraus wurde diese Schaltung entwickelt. Sie hat die oben beschriebenen Vorteile und bietet noch die Möglichkeit der Umschaltung zwischen dem Original-Kernal und drei zusätzlichen Betriebssystemen.

## Etwas Theorie

Wie wird dem Computer ein Umschalten des Betriebssystems mitgeteilt? Für den Computer stellt das Betriebssystem eine Ansammlung von Befehlen, Sprungadressen und Routinen in einem bestimmten Adreßbereich dar. Beim C 64 ist es der Bereich 57344 bis 65535 ($E000 bis $FFFF). Will der Computer aus irgendeinem Grund auf das Betriebssystem zugreifen, aktiviert er den Speicherbaustein für diesen Adreßbereich und legt ihn auf den Adreß- und Datenbus. Was für eine Art Speicherbaustein (ROM, RAM oder EPROM) das ist, ist ihm völlig egal. Hauptsache er findet in dem Adreßbereich einen Speicher vor.

Für uns ist es aber nun sehr wichtig zu wissen, nach welchem System der Computer seine Speicherbausteine verwaltet, damit ohne Absturz ein neues Betriebssystem aktiviert werden kann. Das Zusammenspiel der einzelnen RAM/ROM-Bausteine wird von einem einzigen IC gesteuert. Dieses IC befindet sich im Steckplatz U 17 und ist ein sogenannter PLA-Chip (Programable-Logic-Array). Dieses IC wird bei der Fertigung nach Herstellerangaben programmiert und erhält so besondere Logikeigenschaften, die eine Vielzahl von herkömmlichen Gatterfunktionen nachbilden. Dieser PLA-Baustein ist im C 64 dem Prozessor untergeordnet und nimmt diesem weitgehend die Verwaltung der Speicherbausteine im gesamten Adressierungsbereich ab. Die PLA, auch Adreßraummanager genannt, sorgt dafür, daß auf entsprechende Befehle der CPU immer der richtige Baustein angesprochen wird und daß immer nur ein RAM/ROM-Baustein aktiv auf dem Adreß- oder Datenbus zugreift, damit keine »Kurzschlüsse« entstehen. Jeder RAM/ ROM-Baustein ist über eine Leitung mit dem Manager verbunden. Sie heißt Chipselect- oder Enableleitung. Sie aktiviert die einzelnen Speicher über ein Low-Signal und blendet dadurch den entsprechenden Adreßbereich ein. Um beispielsweise das Betriebssystem zu aktivieren, legt der Manager die

Kernalleitung auf Low-Pegel (Pin 20 am Kernal-ROM) und hält alle anderen Leitungen auf High-Pegel. Damit ein anderes Betriebssystem aktiviert wird, muß man nur die Kernalleitung zum anderen Betriebssystem durchschalten und es natürlich auch mit den Adreß- und Datenleitungen verbinden. Will man drei neue und das alte System benutzen, benötigt man eigentlich nur einen 4fach Umschalter, der die Chipselect-Leitung verteilt. Allerdings hat die ganze Sache einen Haken.

Der Computer läuft mit einer Taktfrequenz von 1 MHz. Entsprechend schnell werden die einzelnen Speicher-ICs auch geschaltet. Würde man mit einem einfachen Umschalter ein anderes Betriebssystem auswählen, wäre während der Umschaltphase, die ja immerhin selbst bei »Fingerakrobaten« einige Millisekunden dauert, gar kein Betriebssystem verfügbar und der Computer würde ins »Leere« springen. Um das zu verhindern, darf eigentlich nur umgeschaltet werden, wenn auf das Betriebssystem gerade nicht zugegriffen wird. Hier setzt diese Schaltung an. Sie speichert den Umschaltimpuls so lange, bis das Kernal-ROM nicht mehr aktiv ist und gibt dann das andere angewählte Betriebssystem frei.

### Wie funktioniert die absturzfreie Umschaltung?

Zuerst etwas Grundsätzliches zur Arbeitsweise der beiden ICs. Sollten Sie sich für die Technik nicht interessieren, können Sie dieses Kapitel auch überschlagen.

IC 1 beinhaltet vier D-Register (bistabile Gatter, Flip-Flops) mit zwei Eingängen E und D (Bild 1) und zwei Ausgängen Q und Q. Der Eingang E ist ein Enable, das heißt ein Freigabe-Eingang. Liegt dieser Eingang auf High-Pegel, wird das an D anliegende Signal sofort zum Ausgang Q übertragen. Q führt dagegen immer das entgegengesetzte Signal zu Q. Deshalb auch der Strich über dem Buchstaben. Wird an E ein Low-Signal gelegt, wird das in diesem Augenblick an D anliegende Signal gespeichert. Das heißt, daß Signaländerungen an D nicht wirksam sind, solange E auf Low-Pegel liegt. Das D-Register ist also nichts anderes als ein 1-Bit-Speicher, den man freigeben oder sperren kann. DR 1-3 sind völlig identisch.

Die technische Bezeichnung für IC 2 lautet: 3-Bit-Binärdecoder/Demultiplexer (3-8) mit Adressen-Zwischenspeicher. Das hört sich komplizierter an als es ist. Die drei Eingänge A0 bis A2 (Bild 1) wirken so, wie die D-Register DRl-3. Der Eingang LE (Latch Enable) bestimmt die Funktion der Adreßeingänge A0 bis A2. Liegt LE auf High-Pegel, werden die zuletzt an den Eingängen A0 bis A2 anliegenden Pegel gespeichert. Liegt dagegen ein Low-Pegel an LE, werden die Signale an A0 bis A2 an die Ausgänge weitergegeben. Nun sind bei diesem IC die Ausgänge der Speicher nicht herausgeführt, wie bei IC 1, sondern führen auf einen internen 1 aus 8-Decoder. Die Ausgänge Q0 bis Q 7 sind die Ausgänge dieses Decoders, der wie folgt arbeitet: Von seinen acht Ausgängen kann immer nur einer Low-Pegel führen. Welcher, das bestimmt die als 3-Bit-Binärzahl an den Eingängen A0 bis A2. Mit 3 Bit lassen sich ja bekanntlich die Dezimalzahlen von 0 bis 7 darstellen. Als Beispiel: an A0 bis A2 liegt die Bitkombination 101 an. Dezimal ist das 5, somit liegt Q5 auf Low-Pegel, und zwar so lange, wie diese Bitkombination anliegt. Alle anderen Ausgänge führen High-Pegel.

Weiterhin hat IC2 zwei Freigabe-Eingänge E1 und E2, die vollkommen unabhängig von den anderen Eingängen arbeiten. Mit El oder E2 können alle Ausgänge Q0-Q7 gleichzeitig auf High-Pegel gelegt werden. Dazu muß an E1 ein High- oder an E2 ein Low-Signal anliegen.

Anschaulicher wird es an einem Beispiel: Wir wollen mit Hilfe eines 3-Bit-Wortes irgendein Signal, sagen wir ein Rechtecksignal, nacheinander an vier verschiedene Stellen leiten. Dazu legen wir das 3-Bit-Wort an die Adreßeingänge A0 bis A2 an. El wird auf Masse gelegt, da nur ein Freigabeeingang benötigt wird. Wie bringen wir aber nun zum Beispiel Ausgang Q5 dazu, unser Rechtecksignal zu übertragen? Zuerst wird an A0 bis A2 die Bitkombination 101 angelegt, mit der wir Ausgang Q5 bestimmen. Dann wird das Rechtecksignal gleichzeitig an LE und an E2 gelegt. Liegt das Rechtecksignal gerade auf High-Pegel, sind alle Ausgänge, somit auch Q5, auf High-Pegel. Geht das Rechtecksignal auf Low-Pegel, gibt E2 die Ausgänge frei, und das Low-Signal an LE überträgt sich auf den adressierten Ausgang; hier Q5. Geht das Rechtecksignal wieder auf High-Pegel, beginnt alles von vorn. Das ist genau das, was wir wollen. Wird an A0 bis A2 jetzt ein anderer Ausgang adressiert, wird das Eingangssignal auf den anderen übertragen.

Nachdem nun die Funktion der einzelnen ICs etwas verdeutlicht wurde, zur eigentlichen Umschaltung. Die Auswahl des Betriebssystems erfolgt über die Schalter S1 (a und b). Die Auswahlsignale gelangen nicht direkt auf die Adreßeingänge, sondern erst über die D-Register DR1 und DR2. Die beiden Register haben die Aufgabe, den Pegelwechsel vom Schalter »schön rechteckig« zu machen.

### Hinweise zum Aufbau

Das Layout für die Umschaltplatine zeigt Bild 2, die Stückliste Tabelle 1. Beachten Sie beim Ätzen, daß einige Leiterzüge sehr schmal sind und nicht verschwinden.

Nach erfolgreicher Herstellung der Leiterplatte wird diese gebohrt. Die angedeuteten Löcher zum Anschluß der Steckverbinder dürfen nicht durchbrochen werden, da die Steckverbinder als Adaptersockel später direkt von hinten auf die Platine gelötet werden. Zuerst sollten die Drahtbrücken eingesetzt werden und dann die Widerstände und IC-Sockel. Zur Befestigung der Adaptersockel lötet man diese erst an den zwei Endpunkten an und richtet sie rechtwinklig aus. Danach sollte man ausprobieren, ob die ganze Sache auch paßt. Erst dann sollten die Steckverbinder endgültig mit der Platine verlötet werden. Den 4fach-Umschalter schließt man am günstigsten mit Flachbandleitung an. Um Leiterzüge auf der Platine zu sparen, wird die eigentliche Verdrahtung des Schalters erst an den Anschlußpins des Schalters selbst durchgeführt. Der Schalter wird laut Schaltplan »binär« verdrahtet: die Schalterausgänge müssen beim Weiterschalten die Binärzahlen 00-01-10-11 liefern. Das ist einfach möglich, indem man die entsprechenden Schaltereingänge mit R4 (5 Volt) verbindet oder offen läßt. Durch das Offenlassen entsteht über R2 oder R3 Low-Pegel.

Die Leuchtdioden sollen eigentlich nur dem Spieltrieb von Computerfreaks entgegenkommen. Die LEDs werden über die noch freien vier Kontakte des Umschalters geschaltet. Die Versorgungsleitung für die Leuchtdioden kommt über R1 von der Platine. Wollen Sie die LEDs nicht einbauen, kann der 470-Ohm-Widerstand selbstverständlich ersatzlos entfallen. Es ist dann auch nur noch ein 2x4-Umschalter notwendig.

Ist die Platine nun so weit bestückt, können die Betriebssysteme eingesetzt werden. Dazu kommt das Kernal-ROM aus Steckplatz U4 in die 24polige Fassung. Wenn Sie eine C 64-Version mit fest eingelötetem ROM haben, sollten Sie sich von einem Lötkolben-Profi eine Fassung einbauen lassen. In die Fassungen 1 bis 3 auf der Platine werden die Betriebssystems-EPROMs gesteckt. Achten Sie unbedingt darauf, die EPROMs und das ROM richtig herum in die Fassungen zu stecken (Bestückungsplan, Bild 3). Möglich sind nur 2764- oder 27C64-Typen, die ohne Schwierigkeiten zu beschaffen sind. Die C-Typen sind CMOS-Ausführungen und bieten den Vorteil der geringen Stromaufnahme. Hat man nur ein neues Betriebssystem, muß dieses unbedingt in Fassung 1 eingesteckt werden, das nächste in Fassung 2 und das dritte in Fassung 3. Sollte eine Fassung frei bleiben, darf diese natürlich nicht über den Schalter angewählt werden. Ein Absturz des Computers bliebe mit Sicherheit nicht aus.

Ist alles soweit fertig (vorher nochmal auf Lötbrücken untersuchen!), kann die Platine in den Steckplatz U4 eingesetzt werden. Die EPROMs müssen nach dem Einsetzen links von U4 stehen und alle Markierungskerben der ICs auf die C 64-Rückseite zeigen. Der Wahlschalter kommt zunächst in Stellung 1. Nach dem Einschalten des Computers sollte dieser sich normal melden. Dann kann umgeschaltet werden. Schaltet man auf Hypra-Perfekt, dürfte auf dem Bildschirm keine Veränderung feststellbar sein. Aber an der geänderten Funktionstastenbelegungwird es schnell klar, daß man ein anderes Betriebssystem aktiviert hat. Noch ein Wort zur Umschaltung: Der Computer wird natürlich nur dann nicht »abstürzen«, wenn innerhalb der Betriebssysteme zur Umschaltzeit die gleichen Routinen benutzt werden. Konkret: Benutzt man ein System mit Hypra-Load, darf natürlich während des Ladens nicht auf das normale Kernal umgeschaltet werden, weil die Laderoutine mit der originalen nicht identisch ist. Bei anderen Betriebssystemen muß man das von Fall zu Fall ausprobieren. Am sichersten ist ein Umschalten immer im Direktmodus. Kaputtgehen kann während des Umschaltens nichts. Spätestens nach einem Reset ist der Rechner wieder einsatzbereit.

(Andreas Gerzen/hm)

# Auf zu neuen Welten [44-47]

> Der parallele IEEE-Bus ist eine der wichtigsten Verbindungen der »großen« Commodore-Computer zur Außenwelt. Mit unserem Selbstbau-Interface eröffnen Sie Ihrem C 64 die gesamte Palette der Commodore-Peripherie.

Ohne Zweifel, es lohnt sich! Speicherkapazitäten von mehreren MByte, beschleunigte Lade- und Speichervorgänge sowie eine rasante Dateiverarbeitung machen die »großen« Peripheriegeräte, wie das Diskettenlaufwerk CBM 4040, interessant. Das einzige Problem ist die im C 64 eingebaute Schnittstelle. Der serielle IEEE-488-Bus (auch als IEC-Bus bezeichnet) ist nicht zum Anschluß dieser Geräte geeignet. Aber der C 64 wäre nicht der C 64, der seinen weltweiten Siegeszug angetreten hat, wenn man dieses Hindernis nicht überwinden könnte. Unser Selbstbau-Interface verwandelt den Expansion-Port in eine IEEE-488-Schnittstelle, wie sie von den CBM-Computern her bekannt ist.

Dabei sind im wesentlichen zwei Hindernisse zu überwinden. Einerseits müssen die Daten des C 64 zwischengespeichert und aufbereitet werden. Andererseits muß dem C 64 mitgeteilt werden, daß er seine Daten nicht mehr wie gewohnt seriell, sondern parallel ausgibt. Die Hauptaufgabe der Bedienung des IEEE-Busses übernimmt dabei ein 6821-Schnittstellenbaustein. Mehrere Gründe sprechen für diesen Ein-/Ausgabebaustein. Da ist zum einen der ausgesprochen günstige Preis. Er ist in nahezu jedem Elektronikversand unter 10 Mark zu haben. Ein 6526, wie er im C 64 sogar gleich zweimal vorhanden ist, kostet dagegen zirka 45 Mark. Zum anderen ist der 6821, im Gegensatz zum ebenfalls möglichen 6522, ohne Probleme an den C 64 anschließbar. Der 6522 verträgt das Timing des C 64 nicht und benötigt deshalb noch eine Zusatzschaltung, die das Taktsignal des C 64 etwas verzögert. Der 6821 läßt sich übrigens durch die stromsparende CMOS-Variante 6321 problemlos ersetzen.

Die Daten werden vom C 64 allerdings nicht direkt auf den IEEE-Bus, sondern über einen Bustreiber 74LS245 geführt. Dies ist nötig, um den 6821 (6321) vor Beschädigungzu schützen und zugleich den sicheren Betrieb von mehreren Geräten am Bus zu gewährleisten. Die Steuersignale werden dabei über den Inverter-Baustein 4069 geführt.

## Die Realisierung

Der verwendete PIA-(**P**arallel **I**nterface **A**dapter)-Baustein 6821 enthält zwei Ports. Jeder Port verfügt über drei Register: das Dateneingabe- und Datenausgaberegister, das Datenrichtungsregister und das Control-/Statusregister. Diese Register wurden auf einige bisher unbenutzte Register des C 64 gelegt. Im einzelnen befinden sich diese in folgenden Speicherzellen:

TODO TABLE

$DE00 Datenregister A/Datenrichtungsregister A
$DE01 Controllregister A
$DE02 Datenregister B/Datenrichtungsregister B
$DE03 Controllregister B

Die Unterscheidung zwischen dem Datenrichtungs- und Ein-/Ausgaberegister erfolgt über das Bit 2 des Controllregisters. Ist es gelöscht (0), dann ist das Datenrichtungsregister selektiert. Im Datenrichtungsregister ist jeder Ein-/Ausgabeleitung ein Bit zugeordnet. Der Zustand dieses Bits legt fest, ob die betreffende Leitung Eingang oder Ausgang ist. Ist das Bit gesetzt, so ist die zugeordnete Leitung Ausgang, ist das Bit gelöscht, so wird die Leitung als Einganggeschaltet. Beim IEEE-488-Modul sind diese Leitungen wie in Bild 1 abgebildet, geschaltet.

Natürlich kann man das IEEE-Modul auch als eine Art Userport-Erweiterung benutzen. In der Regel wird man aber Geräte wie Diskettenlaufwerke (4040, 8050, 8250, 2031, SFD1001) oder aber Drucker und Meßgeräte anschließen. Dazu benötigt man noch ein spezielles Anschlußkabel, das auf der Computerseite mit einem TRW 251-12-50-170 und auf der Peripherieseite mit einem 24poligen Amphenol-Stecker verbunden ist. Die Anschlußbelegung ist im Verdrahtungsschema (Bild 2) abgebildet.

## Die Software

Wie bei fast allen Erweiterungen des Betriebssystems trat auch beim IEEE-488-Interface das Problem des Speicherbereichs auf. Die Lösung sollte sich mit fertiger Software bestens vertragen und trotzdem sofort nach dem Einschalten zur Verfügung stehen. Anstelle der Kassettenroutinen wurde die Treibersoftware für das Interface einprogrammiert. Da dort aber noch Platz war, haben wir das von der Test/Demo-Diskette bekannte DOS 5.1 implementiert. Die zusätzlichen Befehle dieser DOS-Erweiterung sind in Bild 3 zusammengefaßt. Um aber Probleme mit fertiger Software auszuschließen, muß das DOS 5.1 mit den Tasten CTRL und + eingeschaltet werden.

Der wesentlichste Grund, warum sich Diskettenlaufwerke wie die sehr gute SFD 1001 bisher nicht durchsetzen konnten, ist einerseits der Preis und andererseits das vom 1541-Floppy-Laufwerk unterschiedliche Aufzeichnungsformat. Kaum ein Anbieter professioneller Software konnte sich bisher dazu entschließen, seine Programme auch in diesem Format anzubieten. Durch einen kleinen Trick ist es möglich, mit unserem Interface Programme vom 1541 auf das 8250-Format (das SFD-1001-Laufwerk ist praktisch ein halbiertes 8250-Laufwerk) zu überspielen. Die Speicherzelle 2 des C 64 wurde zum Steuerregister umfunktioniert. Im Normalfall steht dort eine 4. Das bedeutet, daß der Drucker auch mit dem IEEE-488-Interface weiterhin seriell betrieben werden kann. Und nun der Trick: Schreibt man in Speicherzelle 2 eine 8, so wird nicht das parallele Diskettenlaufwerk, sondern die 1541 angesprochen. Stellt man die Geräteadresse des parallelen Laufwerks auf 9, so kann man mit jedem Kopierprogramm für zwei Laufwerke vom Laufwerk 8 (1541) auf Laufwerk 9 (zum Beispiel SFD 1001) Programme übertragen. Die normale Geräteadresse (ohne Umstellung) des parallelen Laufwerks ist aber weiterhin die 8. Natürlich können Sie auf diese Weise auch jede andere erlaubte Geräteadresse seriell ansprechen, Sie brauchen dazu nur die Geräteadresse in Speicherzelle 2 zu schreiben (Beispiel: POKE 2,8 um das 1541-Laufwerk anzusprechen).

## Das Listing

Die Software (Listing 1) wird irrt Overlay-Verfahren auf das Original-Kernal kopiert. Dazu wird vom Programm zunächst das Betriebssystem in den Bereich ab $6000 verschoben. In einer POKE-Schleife werden die notwendigen Veränderungen vorgenommen. Nach Beendigung des Programmablaufs befindet sich im Speicherbereich des C 64 ab $6000 bis $8000 das komplett neue Kernal. Sie können es nun entweder direkt mit einem Monitor abspeichern (was zu empfehlen ist) oder aber gleich in ein 2764-EPROM brennen. Dieses EPROM wird dann mit einem Adapter anstelle des Kernal-ROMs in den U4-Steckplatz des C 64 eingebaut. Die Herstellung eines solchen Adapters haben wir in Ausgabe 4/85 ausführlich beschrieben. Es werden aber auch von verschiedenen Herstellern ähnliche Adapter angeboten.

### Wie erhalte ich meine Platine?

Das Platinen-Layout und das fertige IEEE-Interface (Arbeitsversion) im Maßstab 1 : 1 finden Sie in Bild 4, 5 und 6. Das 44polige Ende der Platine ist zum Einstecken in den Expansion-Port vorgesehen. An der 24poligen Seite werden die Peripheriegeräte angeschlossen. Die Bestückungsseite der Platine erkennen Sie an den zwei Lötpunkten für einen Kondensator. Er muß sich in diesem Fall rechts oben auf der Expansion-Port-Seite befinden. Zur Bestückung legen Sie die Platine so vor sich hin, daß diese beiden Lötpunkte rechts oben sind, und die Expansion-Port-Seite von Ihnen weg zeigt. Setzen Sie nun in die linken vorderen Lötpunkte einen 20poligen Sockel und in die rechten Lötpunkte einen 14poligen Sockel. Die Sockelkerben zeigen dabei immer nach links. Den 6821 (6321) sockeln Sie analog dazu. Löten Sie nun den Kondensator (10 µ F) so ein, daß + 5 V des Kondensators mit Pin 2 und 3 auf der C 64-Steckleiste verbunden sind. Der äußere Pin liegt an Masse. Nach dem Einlöten der Sockel brauchen Sie nur noch die Bausteine (Kerbe auf Kerbe) einsetzen. Das Interface ist nun fertig. In Bild 7 finden Sie nochmals eine komplette Stückliste. Falls es Ihnen nicht möglich sein sollte, die Platine selber zu ätzen, können Sie sich an die unten angegebene Adresse wenden, dort hilft man Ihnen weiter. Unter dieser Adresse ist die Leerplatine (35 Mark), der Bausatz inklusive EPROM (75 Mark) und das Fertiggerät inklusive EPROM (98 Mark) zu haben.

Noch ein paar Tips zum Abschluß: Überprüfen Sie alle Kontakte auf Durchgang. Stecken Sie das Modul nur in den ausgeschalteten Computer und vergessen Sie den Adapter für das Kernal-EPROM nicht.

(Ernst Schöberl/Arnd Wängler/ah)

# Neue Spieletests — so wird bewertet [48-50]

Die 64'er-Redaktion hat ein neues Konzept für Spieletests entwickelt. In jeder Ausgabe werden wir etwa fünf aktuelle Spiele testen. Dabei vergeben wir in fünf Kategorien jeweils bis zu 15 Punkte. Die Punktzahlen finden Sie in Balkendiagrammen am Schluß eines Tests. Da nur über dem Durchschnitt liegende Spiele vorgestellt werden sollen, fangen unsere Skalen erst bei fünf Punkten an. Zu den Kategorien selber: Mit Spielidee bezeichnen wir die Handlung des Spiels, seinen Spielwitz, seine Hintergrundstory und seine Originalität. Die Punkte Grafik und Sound brauchen wohl nicht weiter erläutert werden. Damit Sie eine direkte Vergleichsmöglichkeit haben, wurden zwei Spiele ausgesucht, deren Grafik oder Sound wir derzeit für das Beste halten: Bei der Grafik wäre das »Impossible Mission«, beim Sound »Ghostbusters«. Beiden geben wir auf dem entsprechenden Gebiet 11 Punkte. Warum so wenig, wenn wir sie doch für die besten halten? Nun, die Noten müssen steigerungsfähig bleiben. Gerade die für die nächsten Monate angekündigten Neuerscheinungen sollen nämlich mit bisher ungeahnter Grafik und Sound auftrumpfen. Weiter geht’s mit dem Punkt Schwierigkeitsgrad. Hier eine Note zu vergeben, fällt schwer, ändert sich der Schwierigkeitsgrad bei den meisten Spielen doch laufend. Wir wollen hier überschlagsmäßig angeben, für wie schwer man das Spiel halten darf. Unlösbare Spiele erhalten 15 Punkte. Auch hier vielleicht ein Beispiel: »Championship Loderunner« würde 14 Punkte erhalten. Als letztes noch die Motivation. Wie lange wird man wohl Spaß an dem Spiel haben. Einen Nachmittag oder mehrere Monate? Motivation bedeutet aber auch, wie schwer es einem fällt, sich nachts um 2 Uhr endlich vom Spiel loszureißen und ins Bett zu gehen.

Damit die Bewertungen einerseits möglichst objektiv, andererseits von Ausgabe zu Ausgabe immer vergleichbar sind, werden sie jeden Monat von einem festen Team, bestehend aus Redaktionsmitgliedern und freien Mitarbeitern, ausdiskutiert. Wir halten uns dabei nicht für unfehlbar, glauben aber, faire Entscheidungen treffen zu können.

(B. Schneider/M. Kohlen/rg)

## Trends und Flops

Auch diese Spalte wird vorläufig zu einer festen Einrichtung werden. Hier werden wir über Trends auf dem Spielesektor, aber auch über Flops berichten.

Nun gleich hinein ins Getümmel: Lange erwartet und zum Redaktionsschluß immer noch nicht lieferbar waren die US-April-Neuerscheinungen der Firmen Electronic Arts, Broderbund und Epyx. Schon seit Wochen kursieren Gerüchte um Programme wie »Summergames II«, »Karateka«, »Rescue on Fractalus«, »Skyfox« und einige andere mehr. Teilweise handelt es sich hier um Umsetzungen von Apple- oder Atari-Programmen, von deren hoher Qualität man sich schon überzeugen konnte. Auch von den anderen Neuerscheinungen dieser Firmen hört man bis jetzt nur Gutes. Wir bleiben am Ball und versuchen, so schnell wie möglich über diese Spiele zu berichten. »Mail Order Monsters« und »Racing Destruction Set« erreichten uns erst nach Redaktionsschluß und werden in der 64'er-Ausgabe 8 besprochen.

Um beim Thema Trends zu bleiben: Daß man heutzutage mit primitiven Schießspielen keinen Hund mehr hinterm Ofen hervorlocken kann, sollten die Softwarehersteller inzwischen begriffen haben. Und auch ein einfaches Jump-and-Run-Spiel, das keinerlei neue Ideen mit sich bringt, wird wohl nur wenige Käufer finden. Trotzdem tauchen da immer noch Spiele wie »Super Zaxxon« auf. »Super Zaxxon« ist grafisch schlechter als das echte »Zaxxon«, hat aber dafür mehr unterschiedliche Stufen. Langeweile ist allerdings vorprogrammiert, denn am Spielablauf (Ballern, Ballern, Ballern ...) hat sich überhaupt nichts geändert. Weiteres Beispiel ist »Conan«. Wer nun einen Adrenalinspiegelheber erwartet, der wird von einem einfallslosen Jump-and-Run-Spiel mit einfacher, ruckhafter Grafik enttäuscht. Was hätte sich nicht alles aus einem solch gewaltigen Stoff machen lassen. Wohlgemerkt: Diese beiden Spiele sind leider keine Einzelfälle. Besonders tragisch ist nur, daß gerade zwei relativ bekannte Firmen, Hesware und Datamost, für diese Flops verantwortlich sind. Eines sei also jedem gesagt, der sich ein Spiel kaufen möchte: Immer vorher Probespielen oder Testberichte lesen, am besten beides, denn keiner gibt gern 100 Mark für nichts und wieder nichts aus.

(B. Schneider/M. Kohlen/rg)

## Master Of The Lamps

In diesem Spiel von Activision geht es zu wie in einer Geschichte aus Tausendundeiner Nacht: Sie müssen als Prinz einen bösen Lampengeist in die Lampe zurückbefördern, damit Sie die Erbnachfolge antreten können. Doch leider ist die Lampe kaputt, und ihre Einzelteile sind über knapp 20 Screens verstreut. Sie müssen von Ihnen zusammengesucht werden. Von Screen zu Screen fliegt man durch einen »Zeittunnel« in schneller und gut gemachter 3D-Grafik. Am Ende des Fluges erwartet den Spieler dann der Lampengeist. Dieser wirft mit farbigen Noten, die man nur abwehren kann, wenn man schnell genug einen gleichfarbigen Gong anschlägt. Hat man diesen Angriff überstanden, gehört einem auch schon eines der Lampenteile, und weiter geht’s durch den Zeittunnel. Wie schon gesagt, ist die Grafik recht schön. Besonders gut ist aber die Musik geraten: In Ghostbusters-Qualität dröhnt einem da pro Screen eine andere Melodie entgegen, die stilistisch zwar nicht zum Stil paßt (Boogie Woogie im Orient?), dafür aber der reinste Ohrenschmaus ist. Da vergißt man sogar das Spielen. Damit ist es allerdings auch schon getan. Abwechslungsreich ist das Ganze nämlich wirklich nicht. Die zwei geschilderten Situationen wiederholen sich nur mit steigendem Schwierigkeitsgrad. Schade, denn sonst wäre dies derzeit eines der besten Spiele.

(B. Schneider/rg)

## World Series Baseball

Sportspiele scheinen sich zu den Rennern des Sommergeschäfts 1985 zu entwickeln. Paradoxerweise kommt eine der besten Simulationen einer typisch amerikanischen Sportart aus England: Baseball. Wer das Spielprinzip absolut nicht kennt, der wird seine Schwierigkeiten haben. Die Anleitung geht davon aus, daß man die Spielregeln kennt. Wer aber ungefähr weiß, wie es geht, dem stehen spannende Stunden am Computer bevor, ob allein gegen den sehr spielstarken Computer oder zu zweit. Der Joystick erfüllt dabei, je nach Spielsituation, verschiedene Funktionen, sei es nun die Schlägerhaltung oder die Spieleranwahl. Neben der Aufsicht auf das gesamte Spielfeld werden auf einer Anzeigetafel die Spieler in Großaufnahme gezeigt. Die Spieler laufen trickfilmähnlich ein und übers Feld, und für die Spielpausen gibt 's sogar eine Tanzgruppe. Weniger gelungen ist dagegen der Sound, der abgesehen von der amerikanischen Nationalhymne und der Begleitmusik der Tänzerinnen, auf einfache Ball- und Klatschgeräusche beschränkt ist. Wie schon erwähnt, ist der Computer recht spielstark, eher schon zu stark. Aber am meisten Spaß machen solche Spiele ja sowieso zu zweit. Für Anfänger kommt die komplizierte Bedienung erschwerend hinzu. Wer sich aber trotzdem nicht abschrecken läßt, der erhält eine der besten Mannschaftssport-Simulationen, die es derzeit gibt.

(B. Schneider/rg)

## Rally Speedway

Autorenn-Simulationen gibt es inzwischen viele. Überzeugt hat uns aber ein Programm von Adventure Int. und Commodore (!). »Rally Speedway« hat keine aufwendige Grafik und keinen besonderen Sound. Die Idee eines Autorennens ist relativ alt und die Ausführung nicht überragend. Wenn zwei Spieler über die Strecken jagen, dann ist ordentlich was los. Da sich alles auf einem Screen abspielt, und nicht auf zweien wie bei Pitstop II, mußte eine Sonderregelung eingeführt werden: Wer zu weit zurückblickt, erhält fünf Strafsekunden, dann werden beide Wagen wieder Kopf an Kopf gestartet. Verursacht man eine Kollision mit einem der zahlreichen Hindernisse, gibt’s gleich zehn Strafsekunden. Natürlich kann man sich gegenseitig rammen oder von der Fahrbahn drängen.

In einem Hauptmenü können sehr viele die Fahreigenschaften der Autos. betreffende Parameter eingestellt werden. Dazu gehören, neben den Witterungsbedingungen, auch die Höchstgeschwindigkeit und das Beschleunigungs- und Bremsvermögen. Wem die sechs mitgelieferten Rennstrecken nicht ausreichen, der kann sich mit einem Screen-Editor ganz einfach selber welche basteln. Rally Speedway ist neben Pitstop II das interessanteste derzeit erhältliche Autorennen, vorausgesetzt, man spielt zu zweit. Der Computer hält sich selbst nämlich wohlweislich vom Lenkrad fern.

(B. Schneider/rg)

## Super Huey

Vom Programmierer dieses Spiels war man bisher nur Action gewöhnt: Paul Norman ist der Autor der bekannten Spiele »Forbidden Forest«, »Aztec Challenge« und »Caverns of Khafka«. Mit »Super Huey« wagte er sich nun in das Genre der Simulatoren. Und das mit recht gutem Erfolg. Simuliert wird das Fliegen eines »UH-IX«-Helikopters, eines der neuesten aus der Realität gegriffenen Modelle. Hat man sich durch das Anleitungsmaterial durchgekämpft, weiß man nicht nur über die Bedienung des Simulators Bescheid, sondern hat gleich ein paar Lektionen über echte Hubschrauber im klugen Köpfchen. Der reale UH-IX hat übrigens ein besonderes Stabilisationssystem, das das Fliegen wesentlich vereinfacht. Natürlich wurde das in der Simulation berücksichtigt.

Hat man den Huey erst einmal in die Lüfte erhoben, bietet sich ein eindrucksvoller 3D-Effekt. Das majestätische Schwebegefühl kann man mit vier verschiedenen Modi erleben: Flight Instruction, Exploration, Rescue und Combat. Flight Instruction soll den Spieler mit bestimmten Flugtechniken und der Bedienung vertraut machen, Exploration ist die Simulation eines Erkundungsfluges. Bei Rescue müssen Soldaten gerettet und an sichere Orte gebracht werden. Und Combat schließlich ist der aggressive Teil. Hier heißt es: Kampf den Panzern, Flaks und Feindhubschraubern.

(M. Kohlen/rg)

## Slapshot

Sportspiel-Enthusiasten dürfen sich freuen: »Slapshot« bietet zwar nicht alles, was ein Real-Life-Eishockeyspiel an Spaß bringt, ist aber doch eines der schönsten Sportspiele, die es gibt.

Gegen den Computer kann man leider nicht spielen, aber zu zweit macht es sowieso mehr Spaß.

Slapshot erinnert sehr stark an Soccer, spielt sich aber etwas anders. In Slapshot ist Faulen erlaubt: Ein kurzer Druck auf den Feuerknopf, und der Gegner stolpert über den gemein zwischen die Beine gelegten Hockeyschläger. Und während er da verwirrt auf dem Boden sitzt, nimmt man ihm kurzerhand den Puck ab und marschiert in Richtung Tor.

Fault man zu oft, schreit der Schiedsrichter in gut verständlichem Englisch »Penalty!« und verordnet ein Bulli. Bei einem Schuß ins Tor hört man ein begeistertes »He scored!« und wird von rauschendem Applaus (vermischt mit Pfiffen) gefeiert. Die Sprachausgabe wurde von Electronic Speech Systems produziert, die auch schon den Spielen »Impossible Mission« und »Ghostbusters« zum Erfolg verhalfen.

Wenn Slapshot gegen den richtigen Gegner gespielt wird, macht es riesig Spaß. Es kann zwar nicht ganz an das gewisse Etwas von Soccer anknüpfen, ist aber ein durchaus empfehlenswertes Spiel. Noch ein Hinweis zum Schluß. Für Joysticks mit automatischen Dauerfeuer ist dieses Spiel nicht geeignet.

(M. Kohlen/rg)

## Crystal Castles

»Crystal Castles« ist den Spielhöllenfreaks ein Begriff. Nachdem man die Atarisoft-Versionen für Telespiel, Atari- und Apple-Computer nicht gerade als gut bezeichnen kann, hat sich die englische Firma Thundervision des Problems angenommen und eine C 64-Version produziert. Das Ergebnis ist beeindruckend: Die Grafik ist identisch zu der des Automaten, nur die Auflösung der Sprites kommt nicht ganz an die der Spielhallenversion heran.

Bei Crystal Castles handelt es sich um ein Pac-Man-ähnliches Spiel, das auf dreidimensionalen Ebenen spielt. Held des Spiels ist ein kleiner Bär, der herumläuft und Punkte aufsammeln muß. Dabei wird er gestört durch laufende Bäume, fressende Monster und die Hexe Berthilda. Zur Stärkung gibt’s dann einen Topf voll Honig und einen magischen Hut.

Die Güteklasse der Spielhallen-zu Computer-Adaption ist erstaunlich, denn nicht nur die Grafik, sondern auch die spielerischen Elemente gleichen sich. Die vielen kleinen Tricks, die sich auf dem Automaten anwenden lassen, sind auch an der C 64-Version benutzbar. Wer die Nummer 1 am Automaten werden will, kann also vorher auf dem Computer üben.

Crystal Castles zeichnet sich trotz der schwierigen Steuerung durch Spielwitz und gelungene Grafik aus. Der Sound ist einfach, aber durchaus passend und nicht störend. Dieses Spiel ist eine gelungene Anpassung an den Computer.

(M. Kohlen/rg)

## Hexenküche

Palace Software ist das Tochterunternehmen einer Filmfirma. Dies merkt man sofort an der hervorragenden Grafik dieses Spieles.

»Hexenküche« ist in mehreren Punkten etwas Besonderes. Als erstes ist zu erwähnen, daß dieses Spiel gleichzeitig in England und Deutschland erscheint. Ein gleichzeitiger Erscheinungstermin war bisher unüblich. Als zweites ist für Deutschland und England je ein gesonderter Wettbewerb ausgeschrieben. Zu gewinnen ist ein goldener Hexenbesen (näheres siehe Happy-Computer 7/85). Als dritter Punkt ist der Text anzuführen. Für den deutschen Markt ist die englische Version übersetzt worden.

Ziel von Hexenküche ist es, eine Hexe zu ihrem goldenen Besen zu führen. Zuerst muß die Hexe durch eine Landschaft fliegen und einen Schlüssel suchen, mit dem sie in den »Untergrund« dieser Landschaft gelangen kann. Hier ist dann der goldene Besen versteckt. Doch dies hört sich einfacher an, als es ist. Auf der Suche nach dem Schlüssel wird die Hexe von Fledermäusen, Geistern, Haien und Vögeln behindert, die ihr die Kraft rauben. Der Teil, der im Untergrund spielt, ist ein Hüpf- und Springspiel, das nicht einfach zu bewältigen ist.

Alles in allem ist Hexenküche ein Spiel, das Spaß macht und nicht so schnell langweilig wird. Auch bei diesem Spiel ist der neue Trend zu niedrigen Software-Preisen zu erkennen.

(rg)

# HYPRA-ASS - Ein Assembler der Spitzenklasse [51,66-72]

> Das war noch nie da. Ein Super-Assembler zum Abtippen. Mit Leistungsmerkmalen, die Sie sich schon immer gewünscht haben, übertrifft er jeden 100-Mark-Assembler.

HYPRA-ASS ist ein rein in Maschinensprache geschriebener 3-Pass-Makroassembler mit integriertem Editor für den C 64 mit Diskettenlaufwerk 1541. Er belegt etwa 6 KByte RAM-Speicher von $0801 bis $lFD7. HYPRA-ASS gehört, was Leistung und Schnelligkeit betrifft, zu einem der besten Assembler. Seine hervorstechendste Eigenschaft ist die Fähigkeit, um Befehlsfolgen, die in einem Programm immer wieder auftreten, einen Block beziehungsweise ein Makro zu legen. So definierte Befehlsfolgen können durch einen einfachen Befehl an jeder beliebigen Stelle des Programms aufgerufen werden. Diese Eigenschaft haben viele Assembler, aber nur wenige können lokale Labels beziehungsweise Sprungziele innerhalb eines Makros verarbeiten. Innerhalb eines Makros sind, wenn nicht besonders gekennzeichnet, alle Labels und Variablen lokal. Neben vielen Pseudo-Opcodes, mit denen sich zum Beispiel der Objektcode auf Diskette assemblieren läßt oder Quelltexte verketten lassen, kann auch bedingt assembliert werden. Formatierte Listings können an beliebige Geräte gesendet werden. Symboltabellen lassen sich sortiert und unsortiert ausgeben.

Quelltexte werden bei HYPRA-ASS wie normale Basic-Programme erstellt. Nach der Eingabe von RETURN erscheint die soeben eingegebene Zeile formatiert auf dem Bildschirm. Die dabei benutzten Tabulatoren können durch einfache Befehle geändert werden. Um das Editieren von Quelltexten möglichst bequem zu machen, ist in HYPRA-ASS ein spezieller Editor integriert, der den normalen Basic-Editor um viele Funktionen erweitert. Neben der automatischen Zeilennumerierung können Zeilen und Zeilenbereiche formatiert gelistet werden. Auch das oft vermißte Suchen und Ersetzen, Find und Renumber sind eine Selbstverständlichkeit für diesen Editor.

(Gert Möllmann/ah)

TODO ASIDE

## Lebenslauf:

Ich bin 28 Jahre alt. Nach dem Abitur im Jahre 1975 begann ich ein Mathematikstudium an der Ruhr Universität Bochum. Nun, nachdem ich den Grundwehrdienst abgeleistet habe, beabsichtige ich, in die Datenverarbeitung einzusteigen und eventuell ein Informatikstudium aufzunehmen. Weitere Pläne den C 64 betreffend liegen schon vor. So ist eine Textverarbeitung schon in Angriff genommen.

Am Anfang der Entwicklung von HYPRA-ASS stand ein Editor/Assemblerpaar, das von mir Ende 1984 in Basic geschrieben wurde, um dem mangelhaften Basic des C 64 auf die Sprünge zu helfen. Doch schon bald erwies sich die Langsamkeit dieser Programme als so nervenzermürbend, daß für mich nur die Wahl bestand, entweder einen in Maschinensprache geschriebenen Assembler zu kaufen oder selbst einen zu schreiben.

Da solche Assembler recht teuer sind, und weil es eine interessante Aufgabe ist, einen Assembler zu schreiben, habe ich mich für die zweite Alternative entschieden. So entstand mit Hilfe des Basic-Assemblers eine erste Version von HYPRA-ASS, die wiederum eine zweite Version assemblierte und so weiter.

Die Entwicklung von HYPRA-ASS verlief also in einem »bootstrapping«-Verfahren, was außerdem noch den Vorteil hatte, daß eine Prüfung der Funktionstüchtigkeit des Programms schon zum großen Teil im Verfahren selbst stattfand.

(Gerd Möllmann)

> Machen Sie es wie die Profis. Schreiben Sie Programme in Maschinensprache. Dieser leistungsstarke Makro-Assembler macht es möglich.

HYPRA-ASS ist ein rein in Maschinenesprache geschriebener Drei-Pass-Makroassembler mit integriertem Editor für den C 64 mit Floppy 1541. Er wird mit LOAD ”HYPRA-ASS”,8 geladen und durch RUN gestartet. Nach dem Start meldet sich HYPRA-ASS mit »break in 0« und »ready«. Alle Basic-Befehle sind nach dem Start noch zu verwenden, bis auf die Befehle LET und FOR, die Variable anlegen. Der Befehl RUN dient jetzt zum Starten der Assemblierung.

### Der Quelltext

Der Quelltext wird vom HYPRA-ASS-Editor in Basic-Programmzeilen abgelegt. Soweit wie möglich werden unnötige Blanks dabei eleminiert. Für die einzelnen Quelltextzeilen gelten die folgenden Vereinbarungen:

1.	Bei der Eingabe einer Zeile wird hinter der Zeilennummer ein Minuszeichen eingegeben.
2.	Jede Zeile enthält höchstens einen Assemblerbefehl.
3.	Vor einem Assemblerbefehl darf in derselben Zeile höchstens ein Label stehen.
4.	Label beginnen direkt hinter dem Minuszeichen.
5.	Vor jedem Assemblerbefehl steht mindestens ein Blank.
6.	Label und Assemblerbefehl werden durch mindestens ein Blank voneinander getrennt.
7.	Ein Label darf nicht allein in einer Zeile stehen.
8.	Kommentar wird durch ein Semikolon vom Rest der Zeile getrennt.
9.	Reine Kommentarzeilen müssen als erstes Zeichen hinter dem Minuszeichen ein Semikolon haben.
10.	Pseudo-Ops (.ba, .eq...) können direkt hinter dem Minuszeichen beginnen.

Beispiele:

TODO

100	-.ba$C000
110	-initialisierung
120	-; reine Kommentarzeile
130	-	Ida $14; Kommentar hinter einem Befehl
140	-marke	ldx$15; mit Label davor

Zur bequemeren Eingabe und Bearbeitung des Quelltextes stellt HYPRA-ASS im Editor insgesamt 25 Befehle zur Verfügung (Bild 1).

### Rechnungen im Quelltext

HYPRA-ASS erlaubt die vier Grundrechenarten plus Potenzierung, die logischen Operationen NOT, AND und OR, die Vergleiche »gleich«, »kleiner« und »größer«, sowie den Einsatz der Funktionen < (...) und > (...), die das Low- beziehungsweise Highbyte eines Argumentes liefern. Die logischen Operatoren und die Vergleiche werden wie folgt abgekürzt: !n! = not !a! = and !o! = or ! = ! = gleich ! <! = kleiner als ! >! = größer als

Das Ergebnis eines Vergleiches ist —1, falls wahr, 0, falls nicht wahr: (1! = !2)=0 (1! = !1)=-1

Auch die NOT-Verknüpfung arbeitet wie in Basic: !n!1 = —2. Das Argument in den Low-/Highbyte-Funktionen muß im Bereich 0 < Argument <65535 liegen.

Außer Dezimalzahlen sind Hex-Zahlen erlaubt, die durch ein vorangestelltes Dollarzeichen kenntlich gemacht werden: $C000 = 49152 $10 = 16 $a = 10...

Die Hexzahlen können auch in den Basic-Befehlen verwendet werden.

### HYPRA-ASS-Variable (Label)

Der Wert einer HYPRA-ASS-Variablen kann zwischen 0 und $FFFF liegen. Variablennamen können beliebig lang sein, wobei das erste Zeichen des Variablennamens ein Buchstabe sein muß. Weitere Zeichen können Buchstaben, Ziffern oder das Hochkomma sein. Alle Zeichen des Namens sind signifikant.

Im Zusammenhang mit der Verwendung von Makros muß zwischen globalen und lokalen Variablen unterschieden werden. Jede Variable erhält beim Anlegen eine sogenannte Ordnungszahl, die tatsächlich angibt, im wievielten Makroaufruf das Anlegen stattfand. Befinde ich mich in gar keinem Makro, ist die Ordnungszahl entsprechend Null.

Variable mit unterschiedlicher Ordnungszahl sind trotz gleichen Namens nicht gleich. Man kann also davon sprechen, daß Variable gleicher Ordnungszahl lokal sind.

Die Konstruktion mittels Ordnungszahlen dient dazu, Fehler durch doppelte Benutzung von Labeln bei mehrmaligem Aufruf von Makros zu verhindern, indem Makros bei jedem Aufruf sozusagen einen komplett neuen Satz von Labeln erhalten.

Andererseits sind aus einem Makro »herausgesehen« alle Variablen mit anderer Ordnungszahl als im Makro selbst »unsichtbar«. Um aber bequem Makros in Makros aufrufen und bequem Label verwenden zu können, die in mehreren Makros benutzt werden sollen (etwa Betriebssystemroutinen), gibt es die globalen Variablen.

Globale Variable sind, wie der Name schon verrät, im Gegensatz zu den lokalen Variablen unabhängig von der Ordnungszahl überall definiert.

Alle Makronamen sind per Definition global.

Alle Variablen sind bei HYPRA-ASS redefinierbar gehalten, das heißt alle Variablen können durch eine Wertzuweisung jederzeit verändert werden.

Eine dopelte Benutzung von Labeln vor Assemblerbefehlen wird jedoch durch einen »Label twice«-Error (Bild 2) geahndet, da dies zu einem falschen Ergebnis der Assemblierung führen würde.

### Die Makros von HYPRA-ASS

Makros sind meist kürzere Befehlsfolgen, die im Quelltext häufiger vorkommen, und deshalb unter einem Makro zusammengefaßt werden. Zu jedem Makro gehört ein Makroname, mit dem es aufgerufen werden kann. An jedes HYPRA-ASS-Makro können beliebig viele Parameter übergeben werden, deren aktueller Wert dann bei der Assemblierung im Makro eingesetzt wird. Makros können bei HYPRA-ASS an beliebiger Stelle im Quelltext definiert werden. Alle Makronamen sind global, alle Parameter und makrointernen Label sind lokal. Das heißt verschiedene Makros können durchaus Label beziehungsweise Parameter gleichen Namens verwenden.

Ein Beispiel für ein einfaches Makro:

Es wird immer wieder die Befehlsfolge benötigt, Akkumulator und X-Register mit dem Inhalt zweier aufeinanderfolgender Speicherzellen zu laden. Ein Makro dazu könnte folgendermaßen aussehen:

TODO

100 -.ma ldax (adresse)
110 - lda adresse
120 - ldx adresse+1
130 -.rt

Der .ma-Pseudobefehl wird gefolgt von einem Variablennamen, dem Makronamen, und einer Parameterliste in runden Klammern, falls Parameter vorhanden sind. Hier ist es ein Parameter, die Adresse der Speicherzelle, die in den Akku soll. Sind mehrere Parameter vorhanden, werden sie durch Kommata getrennt. In die Parameter setzt der Assembler bei jedem Aufruf den aktuellen Wert, der im Aufruf steht. Rufe ich also ldax (2) auf, so entsteht bei der Assemblierung des Makro die Folge Ida 2, ldx3, entsprechend führt der Aufruf mit ldax (label) zu lda label, ldx label+1.

Die Parameterliste darf in der Definitionszeile eines Makro nur aus einer Folge von Variablennamen bestehen, während im Aufruf als aktuelle Parameter beliebige Ausdrücke erlaubt sind. Hinter der Definitionszeile mit dem .ma-Pseudo folgt dann der eigentliche Makroinhalt, das heißt das, was bei einem Aufruf des Makro assembliert werden soll.

Natürlich sind hier nicht nur einfache Befehle wie im Beispiel gestattet. Genausogut können im Makro Verzweigungen und Sprünge ausgeführt werden, es kann bedingt assembliert werden, und weitere Makros können aufgerufen werden. Für die Schachtelung von Makros besteht keine Grenze außer der Fassungskapazität des Prozessorstacks.

Als Beispiel — wird ein Makro mit zehn internen Labeln 100 mal aufgerufen, ergibt sich schon für die dadurch erzeugten lokalen Label ein Platzbedarf von genau 7 000 Byte.

Sollte irgendwann der Fall eintreten, daß Label und Quelltext zusammen nicht mehr ins RAM passen, erhalten Sie den »too many labels«-Error (Bild 2). Dies ist allerdings mehr ein theoretischer Fall, denn auch bei der Assemblierung von HYPRA-ASS selbst wurden trotz extensiver Benutzung von Labels nicht einmal 500 gebraucht. Sie können aber davon ausgehen, daß Ihnen immer mindestens Platz für 1 170 Label zur Verfügung steht — in den allermeisten Fällen sogar erheblich mehr.

Selbstaufrufe von Makros sind auch nicht verboten. Inwieweit eine solche Konstruktion überhaupt sinnvoll sein kann, bleibt jedem selbst zu prüfen.

Zurück zur Makrodefiniton: Jede Makrodefinition muß unbedingt mit dem Pseudo .rt (return) abgeschlossen sein. Trifft der Assembler bei der Abarbeitung eines Makro auf .rt, so heißt das für ihn, die Assemblierung hinter dem Aufruf fortzusetzen. Vor der .ma und .rt-Anweisung dürfen in derselben Zeile keine Label stehen. Die Makrodefinition selbst wird in Pass 1 und Pass 2 überlesen. Es zählen also nur die Makroaufrufe bei der Assemblierung.

Der Aufruf eines Makro erfolgt durch den Pseudobefehl ..., gefolgt vom Makronamen und der aktuellen Parameterliste in runden Klammern.

### Wertzuweisung an Label

Zwei Pseudobefehle stehen zur Verfügung, um Label einen Wert zuzuweisen:

TODO

.eq — weist einem Label einen Wert zu, ohne die Ordnungszahl des Labels dabei zu verändern.
.gl — erklärt gleichzeitig das Label als global.

Beide Pseudos werden der eigentlichen Wertzuweisung vorangestellt, so wie LET in Basic:

TODO

100 -.eq marke = $FFC0
110 -.gl label = $200

Bei der Wertzuweisung an Label ist immer der Bereich einzuhalten in dem ein Labelwert liegen darf (0 bis $FFFF).

### Einfügen von Tabellen und Text

Drei Pseudo-Ops erleichtern das Einfügen von Tabellen und Text in den Quelltext. Dies sind:

TODO

.by — erlaubt das Einfügen von Bytewerten (Werten zwischen 0 und $FF). Einzelne Bytewerte werden durch Kommata voneinander getrennt. Auch Strings der Länge 1 sind als Bytewerte erlaubt. Beispiel:<br>100 -.by 0, ”a”, 123, ”x”, $fa
.wo — erlaubt das Einfügen von Adressen (Werten zwischen 0 und $FFFF). Mehrere Adressen werden durch Kommata voneinander getrennt. Die Adressen werden in der Folge Low/Highbyte in den Objektcode aufgenommen. Beispiel: 100 -.wo marke-1, label*2-1
.tx — erlaubt das Einfügen von Text in den Quelltext. Die einzelnen Zeichen des Textes werden als ASCII-Code im Objektcode aufgenommen. Beispiel:<br>100 -.tx ’’beispieltext”

Überall im Quelltext, wo Bytewerte erwartet werden, etwa bei der unmittelbaren Adressierung, können Strings der Länge 1 verwendet werden. Ein Befehl Ida #’ä” ist also erlaubt.

### Die bedingte Assemblierung

Zur Unterstützung der bedingten Assemblierung bietet HYPRA-ASS ein IF/ELSE/ENDIF-Konstrukt und ein IF/THEN-Konstrukt. Außerdem steht ein unbedingter Sprungbefehl zur Verfügung.

TODO

.on — entspricht dem IF/THEN von Basic. Hinter .on folgt ein Ausdruck, ein Komma und ein zweiter Ausdruck. Ist der erste Ausdruck wahr, wird zu der Zeilennummer gesprungen, die der zweite Ausdruck angibt. Beispiel:<br>100 -.on switch ! = ! 7, 400<br>Es wird die Assemblierung in Zeile 400 fortgesetzt, wenn switch gleich 7 ist.
.go — ergibt einen unbedingten Sprung zu der Zeile, die der Ausdruck hinter .go angibt. Beispiel:<br>100 -.go 1000
.if — wird gefolgt von einem Ausdruck. Ist der Ausdruck wahr, wird die Assemblierung hinter der .if-Zeile fortgesetzt, bis
.el — gefunden wird. Daraufhin wird
.ei — gesucht und dahinter die Assemblierung fortgesetzt.

Entsprechend erfolgt die Assemblierung von .el bis .ei, falls der Ausdruck hinter .if falsch ist. .el kann auch fehlen, es wird dann direkt hinter .ei fortgefahren.

Auf eine Schachtelung von IF-Konstrukten wurde wegen des Zwecks der bedingten Assemblierung verzichtet. Beispiel:

TODO

100 -.if switch! = !6
110	-	lda#0
120 -.el
130	-	lda#2
140 -.ei

Wenn switch gleich 6 ist, erhält man lda#0, sonst wird Ida # 2 erzeugt. Vor den Pseudos .if, .el und .ei dürfen keine Label in derselben Zeile stehen.

### Verkettung von Quelltexten

Mit dem Pseudo .ap (append) kann ein weiterer Quelltext am Ende des Pass 2 automatisch nachgeladen werden, wobei der Programmzähler aus der vorangegangenen Assemblierung erhalten bleibt.

Hinter .ap muß der Name des nachzuladenen Files in Anführungszeichen stehen.

Eine Besonderheit von HYPRA-ASS bildet im Zusammenhang mit verketteten Quelltexten der Pseudo-Opcode .co (common).

Dieser Befehl bewirkt zunächst, daß alle Variablen/Label, die hinter der .co-Anweisung in einer Liste stehen, an den nachgeladenen Teil übergeben werden.

Zweitens bleiben alle Quelltextzeilen bis zur common-Zeile beim Nachladen erhalten. Steht also etwa ein Makro vor der common-Zeile, wird auch das Makro übergeben. Zu beachten ist dabei:

a)	Es sollten keine Makroaufrufe im common-Bereich stehen, es sei denn innerhalb eines Makro.
b)	Die .ba-Anweisung, die die Startadresse des Objektcodes bestimmt, sollte außerhalb des common-Bereiches liegen, damit nach dem Nachladen nicht wieder mit der gleichen Startadresse assembliert wird.
c)	Wertzuweisungen an Label sollten ebenfalls außerhalb des common-Bereiches liegen, um Platz für den nachgeladenen Quelltext zu gewinnen.

### Direktes Senden des Objektcodes zur Floppy

Der Pseudobefehl .ob (object), gefolgt vom Filenamen ,p,w in Anführungszeichen, sendet den erzeugten Objektcode direkt zur Floppy.

Geschlossen wird das so erzeugte Objektfile durch den Pseudobefehl .en.

Sollte während der Assemblierung ein Fehler entdeckt werden und das Objektfile nicht schon durch die HYPRA-ASS-Fehlerroutine geschlossen worden sein, geben Sie bitte CLOSE 14 ein.

### Ausgabe von formatierten Listings

TODO

1)	.li 1,3,0 sendet ein formatiertes Listing des Quelltextes unter der logischen Filenummer 1 an das Gerät 3 mit der Sekundäradresse 0 (Bildschirm). Die Parameter hinter .li entsprechen denen des OPEN-Befehls. So ist es auch möglich, mit .li 2,8,2, ”test,u,w” das Listing auf eine Userdatei zu leiten und so weiter.

Der .li-Pseudobefehl muß der erste Befehl im Quelltext sein, wenn alle Zeilen gelistet werden sollen. Die Zeilen bis einschließlich .li werden nicht ausgegeben. Die gelisteten Zeilen haben folgendes Format:
c000 a0b0c0: 1000 -marke befehl ;kommentar

Die Steuerung der Formatierung erfolgt mit dem Editorbefehl /t. Bei Zeilen, die Pseudobefehle enthalten, wie .eq... werden keine Adressen und Opcodes ausgegeben.

TODO

2)	.sy 1,3,0 sendet am Ende von Pass 2 die sortierte Symboltabelle. Die Formatierung wird hier durch /t3,... gesteuert. Die Labelwerte werden hexadezimal ausgegeben.

Eine Zeile der Symboltabelle sieht dann folgendermaßen aus:
sprungziel = $ffd2

Das Listing des Quelltextes erhält die Kopfzeile »HYPRA-ASS Assemblerlisting:«. Die Symboltabelle erhält die Kopfzeile »Symbols in alphabetical order«.

TODO

3)	.dp
t0,t1,t2,t3 setzt aus dem Quelltext heraus die Tabulatoren t0 = Tabulator für Assemblerbefehle t1 = Tabulator für den Kommentar bei der formatierten Ausgabe
t2 = Tabulator für die Anzahl der Blanks, die am Anfang einer Ausgabezeile ausgegeben werden.
t3 = Tabulator für die Symboltabelle
4)	.st	beendet die Assemblierung

Am Ende des zweiten Passes wird immer die Meldung »end of assembly« gefolgt von der Assemblierungsdauer in Minuten, Sekunden und Zehntelsekunden ausgegeben. Dahinter folgt die Zeile »base = $XXXX last byte at $YYYY«.

Eine Zusammenfassung aller Pseudobefehle finden Sie in Bild 3.

## HYPRA-ASS-Editor

Eines der Ziele bei der Entwicklung von HYPRA-ASS war es auch, die Editierung von Quelltexten möglichst bequem zu machen. Dazu wurden etliche Funktionen, die im normalen Basic-Editor stets gebraucht, aber nie vorhanden sind, in den HYPRA-ASS-Editor eingebaut.

Als Grundlage des HYPRA-ASS-Editors blieb dabei der Basic-Editor erhalten.

Ein HYPRA-ASS-Quelltext wird also im Prinzip genauso eingegeben wie ein Basic-Programm. Allerdings muß hinter der Zeilennummer immer ein Minuszeichen eingegeben werden, das den Beginn der Quelltextzeile bildet. So eingegebene Quelltextzeilen werden als ASCII-Zeilen in den Speicher übernommen. Alle überflüssigen Blanks werden entfernt.

Jede eingegebene Zeile wird sofort nach der Übernahme formatiert ausgegeben, um die Übersichtlichkeit des Quelltextes zu gewährleisten. Eine Tabelle aller Editorbefehle finden Sie in Bild 1.

(Gerd Möllmann/ah)

# Damit Sie wissen, was Sie ausgeben [52,54-62]

> Egal, ob Sie viel oder wenig Geld verdienen, auf jeden Fall hat es Vorteile, einen Überblick über seine Ausgaben zu haben. Und warum soll dazu nicht der C 64 eingesetzt werden? Mit diesem elektronischen Haushaltsbuch können Sie jederzeit Bilanz ziehen.

Seit Anfang 1984 der C 64 ins Haus kam, ist die Arbeit daran zu einer Leidenschaft geworden. (Wie bei vielen anderen auch!) Soweit der Beruf es ermöglicht, verbringe ich meine Freizeit (das sind hauptsächlich die Wochenenden) mit der Entwicklung von Anwendungen am Computer. Ausgangspunkt war die Begeisterung für technische »Spielereien«. Doch bald reizte die Eigenentwicklung von Programmen. Es gibt eine tiefe Befriedigung, wenn nach stunden- oder tagelanger Arbeit ein Programmteil das erste Mal gestartet wird und nach vielleicht nur einer Korrektur zufriedenstellend läuft. Ein andermal wird stundenlang über die Lösung eines Problems getüftelt. »Gelernt« habe ich jedenfalls dadurch einiges über die Basic-Programmierung des C 64. Wenn auch häufig »Probieren über Studieren« ging.

Als Familienvater finde ich volles Verständnis bei Frau und Tochter. (Das muß mal gesagt werden!)

In der Familie liegt der Ausgangspunkt für das Programm. Die Aufzeichnung der monatlichen Einnahmen und Ausgaben erfolgte manuell. Das ließ natürlich die »Ehre« des EDV-Anwenders nicht zu. Ein entsprechendes Programm mußte her. Es sollten nicht nur die Beträge als Salden auf Konten geführt werden, sondern es sollte auch möglich sein, einzelne Buchungen wieder abzurufen. Wiederkehrende Posten sollten über die einzelnen Monate hinweg beobachtbar sein.

So entstand das »Haushaltsbuch« als eine Kombination aus sequentieller und relativer Datei: die relative zur Kontenführung (Salden); die sequentielle zur Speicherung der Kostenart, des Betrages und des Buchungsdatums als Einzelpositionen.

Von der Floppy lassen sich mit »INPUT« bekanntlich nur 88 Zeichen einlesen. Der relative Datensatz hat aber eine Länge von 141 Zeichen. Die Alternative »GET« in einer FOR-NEXT-Schleife ist sehr langsam. Dies fällt besonders bei der Bildung des Jahressaldos auf.

Es blieb nur, den INPUT-Befehl zu modifizieren. Die entsprechenden DATAs für das kleine Maschinenprogramm sind im »Haushaltsbuch« enthalten und werden in den Kassettenpuffer eingelesen.

Als Tauschroutine fand gleich die im 64’er, Ausgabe 1/85 beschriebene SWAP-Simulation Verwendung. Durch diese Funktion konnte die Produktion von »String-Müll« deutlich reduziert werden.

Ich habe mich bemüht, das Programm »wasserdicht« zu machen. Floppy und Drucker werden auf Bereitschaft geprüft. Unter normalen Bedingungen dürfte es keinen Absturz geben. Aber eine Eingabe von falschen Beträgen muß der Anwender verantworten.

(Martin Schumann/gk)

TODO ASIDE

## Lebenslauf

Dem Jahrgang 1949 zugehörig, und damit den »alten« Heimcomputeranwendern zuzurechnen, begegnete mir während des Studiums Anfang der siebziger Jahre die Informatik zum ersten Mal. Nur die wenigsten schenkten dem damals Beachtung. Und ich schließe mich da nicht aus.

Aber die »programmierbaren«, mathematischen Taschenrechner faszinierten mich trotzdem. 1975 konnte ich dann einen HP-25 mein Eigen nennen. Die nächsten Jahre hatte ich beruflich viel mit Zahlen und Statistiken zu tun. Dabei leistete mir der »Kleine« wertvolle Dienste.

1981 änderte sich die Situation. Inzwischen beruflich mit Informationssystemen beschäftigt, wollte ich als Nutzer der EDV mehr über die eigentliche Programmierung wissen.

Lange beschäftigte mich auch die Frage nach dem »richtigen« Computer. Aufgrund der Verbreitung und der gebotenen Leistung fiel die Entscheidung auf den C 64, der Anfang 1984 schließlich gekauft wurde.

Anhand der in Zeitschriften abgedruckten Programme und diverser Bücher arbeitete ich mich in die Basic-Programmierung ein. Try and Error hieß die Devise.

Nach mehr als einem Jahr habe ich noch nicht den Spaß an der »Computer-Knobelei« und der programmtechnischen Lösung von Problemen verloren.

(Martin Schumann)

TODO ASIDE

> Das Programm »Haushaltsbuch« dient der Aufzeichnung der Ein- und Ausgaben im privaten Bereich. Neben den monatlichen Bestandskonten (relative Dateien) werden zur Dokumentation der Buchungsposten die Einzelpositionen in sequentiellen Buchungsdateien gespeichert.

Die in den relativen Dateien geführten Konten ermöglichen innerhalb eines Jahres den Abruf des aktuellen Standes in der »Kasse«. Aus den sequentiellen Dateien lassen sich alle Buchungen mit Angabe der Kostenart, des Betrages und des Buchungsdatums auflisten oder einzelne selektieren; zum Beispiel bestimmte Kostenarten oder Buchungsmonate.

Geschrieben wurde das »Haushaltsbuch« für einen C 64. Das für die Modifikation des INPUT-Befehls notwendige kleine Maschinenprogramm wird in dem Kassettenpuffer abgelegt. Die DATAs für die Simulation der SWAP-Tauschroutine werden in der Zero-Page in den Freiraum ab Speicherstelle715 eingelesen.

Die sinnvolle Nutzung des Programms setzt ein Diskettenlaufwerkvoraus. Ein Drucker wäre recht nützlich, ist aber keine Notwendigkeit. Sollten trotz nicht vorhandenem Drucker die betreffenden Druckroutinen aufgerufen werden, führt dies zu keinem Programmabsturz.

Ausgelegt ist das Druckunterprogramm für Epson-kompatible Drucker. Eine Anpassung an Commodore-Drucker sollte – falls es notwendig ist – leicht zu bewerkstelligen sein.

Neben der Bereitschaft des Druckers wird selbstverständlich die des Diskettenlaufwerks geprüft.

## Funktionsbeschreibung

Wie aus den einleitenden Sätzen ersichtlich, gliedert sich das Programm in zwei übergreifende Programmteile: die Kontenführung und die Bearbeitung der Buchungspositionen.

Nach dem Start des Programms geben Sie bitte das zu bearbeitende Jahr (»aktuelles Jahr«) ein. Der Zeitraum wurde auf 1984 bis 2000 beschränkt. Dies kann selbstverständlich dem Bedarf des Lesers entsprechend angepaßt werden. Nur sollte dabei die Diskettenkapazität beachtet werden!

Nach Eingabe der Jahreszahl meldet sich »Haushaltsbuch« mit dem Hauptmenü. Es stehen folgende Funktionen zur Verfügung:

— 1 Konten anlegen
— 2 Buchen
— 3 Kontenübersicht (Kontennamen ausgeben)
— 5 Monatsübersicht
— 6 Jahresübersicht
— 7 Buchungsposten abfragen
— 0 Programm beenden

Die Funktion »Kontennamen ausgeben« wird automatisch von den übrigen Funktionen — soweit notwendig — aufgerufen. Denn warum sollte man sich die Nummern der einzelnen Konten merken, dies kann der C 64 viel besser.

Wenn Sie also »4« eingeben, erfolgt eine entsprechende Meldung. Versuchen Sie es!

### Konten anlegen

Beachten Sie bei dieser Funktion, daß eine existierende Datei des gewählten Jahres gelöscht wird. Es wird zur Vorsicht abgefragt, ob Sie dies auch wirklich beabsichtigen. Beantworten Sie die Frage mit »JA«, so werden die bisherigen Konten gelöscht und Sie aufgefordert, die Zahl der neu anzulegenden Konten einzugeben. Anschließend können Sie die Konten benennen. Drücken Sie bei einer Kontonummer RETURN, so wird das Anlegen der Konten abgebrochen. Es werden nur die bis zu diesem Moment eingegebenen Konten gespeichert. Die Kontenzahl (KZ) wird entsprechend korrigiert. Geben Sie bei der Frage nach der Zahl der Konten »0« ein, so wird die Programmfunktion verlassen. Dadurch können Sie also nicht mehr benötigte Jahre löschen. (Klar, daß das auch außerhalb des Programms mit »SCRATCH« erfolgen kann.)

Gleichzeitig mit dem Anlegen der relativen (Salden-)Konten werden auch die sequentiellen Buchungsdateien eingerichtet.

Die Zahl der Konten wurde auf 20 beschränkt, um noch mit einer Bildschirmseite auszukommen. Außerdem sollten 20 Konten für die private »Buchführung« ausreichend sein. Wem dies dennoch zu wenig ist, muß in Zeile 1440 die betreffende Prüfung und in Zeile 60 die Dimensionierung anpassen.

Außerdem wäre das Scrollen des Bildschirms über eine Routine (ähnlich der in Zeile 5800-5830) zu steuern.

### Buchen

Ein Aufruf dieser Funktion gibt zuerst die Nummern und Namen der Konten aus. Durch Eingabe der gewünschten Nummer wird das betreffende Konto eingelesen. Mit »E« kann man die Funktion ohne Aktivitäten verlassen. Anschließend wird nach Einnahme oder Ausgabe gefragt. An dieser Stelle kann die Routine ebenfalls durch die Taste »f7« abgebrochen werden. Diese Möglichkeiten wurden eingefügt, um ein Verlassen der Buchungsfunktion zu erlauben. Wurde jedoch dieser Punkt überschritten, bleibt nur, eine Buchung durchzuführen. Bei Abbruch werden die bis dahin getätigten Buchungen gesichert.

Nachdem Sie den Buchungsmonat angegeben haben, wird der alte Saldo angezeigt. Nun können »KOSTENART«, »BETRAG« und »TAG« (durch Kommata trennen) eingetippt werden. Wenn alles korrekt ist, können weitere Eingaben auf dem gewählten Konto gemacht werden. Wird die Frage nach weiteren Buchungen mit »N« beantwortet, werden die Eingaben auf das Konto »geschrieben«.

Nun können andere Konten aufgerufen oder die Funktion »Buchen« verlassen werden.

### Kontenübersicht

Wählen Sie diese Funktion, wenn Sie die Monatssalden eines Kontos wünschen. Auch hier werden die Konten wieder vorgegeben.

Nach Anzeige der Übersicht ruft »f3« weitere ab oder »f1« druckt die aktuelle aus. Zum Menü kommt man mit »f5« zurück.

### Monatsübersicht und Jahresübersicht

Tippen Sie die »5« im Menü und geben den gewünschten Monat ein, erhalten Sie einen Überblick über die Salden aller Konten für den betreffenden Monat.

Die »6« ruft den Jahressaldo aller Konten ab. Dabei kann allerdings der zu kumulierende Zeitraum (Monate) frei gewählt werden. Ober- und Untergrenze können in beliebiger Reihenfolge eingegeben werden.

Auch hier kann durch Drücken von »f1« ein Protokoll über Drucker erstellt werden.

### Programm beenden

Mit dieser Funktion kann das Programm »ordnungsgemäß« beendet werden. Sollte dies mal aus Versehen geschehen sein, kann man mit »GOTO 960« sofort wieder zurückkehren. Es reicht, RETURN zu drücken, da der Cursor entsprechend positioniert wird.

### Buchungsposten abfragen

Dieser Programmteil springt in das Untermenü »Sonderfunktion Buchungsposten bearbeiten«. Hier stehen als weitere Funktionen zur Verfügung:
< Datei laden >
2 Datei sichern
3 Buchungen ausgeben
4 Buchungen ändern
5 Buchungen sortieren
0 Sonderfunktionen verlassen

»Datei laden« braucht nicht gesondert aufgerufen zu werden, da dies wieder bei den übrigen Programmteilen des Untermenüs geschieht.

Vor dem Start der Laderoutine prüft der Computer, ob das Diskettenlaufwerk vorbereitet wurde. Auch eine »falsche« Datendisk wird mit »Datei nicht gefunden« quittiert. Es erfolgt Rücksprung zum Menü.

### Datei sichern

Diese Funktion ist nur dann notwendig, wenn Änderungen (Kostenartoder Datum) durchgeführt wurden (vergleiche »Buchungen ändern«).

Allerdings kann ein unbeabsichtigtes Starten dieser Routine auch keinen »Schaden« anrichten. Es werden dann die Daten im Rechner gesichert und die identische Datei auf der Diskette gelöscht.

Darüber hinaus wird nach Aufruf dieses Programmteils zur Vorsicht gefragt, ob eine Diskette eingelegt wurde. Zusätzlich prüft der Computer, ob das Laufwerk »bereit« ist.

### Buchungen ausgeben

Als erstes geben Sie ein, ob die Ausgabe auf Drucker oder Bildschirm erfolgen soll. Dann wählen Sie die Datei (mit dem betreffenden Kontennamen), aus der Buchungen selektiert werden sollen. Gesucht werden kann nach »Kostenart« und/oder »Buchungsmonat«. Ist ein Suchbegriff nicht relevant, drücken Sie RETURN. Wurde beide Male RETURN gedrückt, wird die Datei komplettaufgelistet. Nachjeweils 15 Buchungsposten wird die Bildschirmausgabe angehalten und mit Betätigen einer beliebigen Taste fortgesetzt.

Hier bieten sich also vielfältige Möglichkeiten, Kostenarten über Monate hinweg zu verfolgen oder Monate in die einzelnen Buchungspositionen zu »zerlegen«.

### Buchungen ändern

Diese Funktion ist dazu bestimmt, Änderungen an den Buchungsposten vorzunehmen. Das gilt aber nur für Kostenart und Buchungsdatum, wenn man sich bei der Eingabe versehen und dies beim Buchen nicht bemerkt hat. Eine Änderung des Betrages ist dagegen nur durch eine Korrekturbuchung möglich, weil in diesem Fall auch die relativen Konten korrigiert werden müssen.

Gewählt werden kann zwischen zwei Änderungsmodi:

1.	Selektion und Korrektur von Einzelbuchungen oder
2.	Auflisten aller Buchungen

Bei Änderungen werden Spalten und Zeilen beziffert, so daß die Datensätze und die Felder eindeutig identifiziert werden können.

Nach Eingabe der betreffenden Zeilen- und Spaltennummer wird das zu ändernde Feld in die spezielle »Änderungszeile« ausgegeben. Der Cursor wird so positioniert, daß das (geänderte) Feld sofort wieder übernommen wird. Dies hat den Vorteil, daß bei nur einer Buchstabenänderung nicht das ganze Feld neu geschrieben werden muß.

Sind mehrere Änderungen vorzunehmen, können diese nacheinander durchgeführt werden.

Ist der letzte Datensatz erreicht, wird gefragt, ob die geänderte Datei gesichert werden soll. Dies wird in der Regel der Fall sein.

### Buchungen sortieren

Die Buchungen werden in der Reihenfolge der Eingabe gespeichert. Wird für bestimmte Anwendungen eine andere Folge benötigt, kann nach Kostenart oder Betrag oder Datum aufsteigend sortiert werden.

Auch hier entscheidet der Anwender, ob die neu sortierte Datei gespeichert werden soll. In diesem Fall wird es nicht immer gewünscht sein, weil die Datei in einer bestimmten Reihenfolge auf der Diskette erhalten bleiben soll.

Ein Hinweis sei an dieser Stelle gegeben. Bei umfangreicheren Dateien (zum Beispiel 200 Datensätzen) können schon ein bis zwei Minuten vergehen, bis der Computer die Vollzugsmeldung gibt. Also nur keine Aufregung, wenn er sich nicht sofort wieder meldet. Es muß nicht unbedingt ein Programmfehler vorliegen!

Die 200 Datensätze (genauer 201 pro Konto) stellen die Obergrenze dar. »Vielbucher« müssen die Dimensionierung (D$(200,2)) in Zeile 60 ändern.

### Sonderfunktion verlassen

Bevor das Programm zum Hauptmenü zurückspringt, prüft es, ob Änderungen oder Sortierungen an der sich im Computer befindenden Datei vorgenommen wurden. Sollten die noch nicht gesichert sein, kann dies jetzt — solange keine andere Datei von Diskette geladen wurde — nachgeholt werden. Andernfalls RETURN drücken, um zum Menü zu gelangen.

## Aufschlüsselung nach Zeilennummern

Die folgende Grobeinteilung kann vorgenommen werden:

TODO TABLE

1 - 830 Vorbereitung und Unterprogramme, die der Schnelligkeit wegen, oder weil sie häufiger aufgerufen werden, an den Anfang gesetzt wurden (zum Beispiel Sortieren, Cursor positionieren).
850 - 4310 Hauptmenü und Bearbeitung der relativen Datei (Kontenführung).
4500 - 7780 Untermenü und Bearbeitung der sequentiellen Buchungsdateien.
7830 - 7940 DATAs für »INPUT«-Modifikation zum Einlesen von Files; werden in den Kassettenpuffer ab 828 geschrieben:<br>Syntax: input# Filenummer, Satzlänge, Variable. Erlaubt mehr als 88 Zeichen (253) direkt einzulesen, findet Anwendung bei der relativen Datei, Satzlänge 141 Zeichen.
7990 - 8050 DATAs für die Simulation der »SWAP«-Funktion (vergleiche 64’er, Ausgabe 1/85) von Boris Schneider): Ermöglicht das Vertauschen zweier Strings ohne zusätzliche Variable (»String-Müll«), eingesetzt in der Sortierroutine.<br>Syntax: SYS Startadresse(string1,string2)<br>Startadresse im Programm: Speicherstelle 715 in der Zero-Page.

Wichtiger Hinweis:

Sollte jemand mit Simons Basic editieren, ist zu beachten, daß nach dem ersten Start des Programms nicht mehr alle Befehle dieser Basic-Erweiterung wegen der DATAs im Kassettenpuffer einwandfrei funktionieren (Syntax-Error!?)

Eine Beeinträchtigung von Exbasic Level II konnte bisher nicht beobachtet werden.

Gestartet wird das Programm mit RUN.

Auf eines sei noch aufmerksam gemacht. Durch die Kommentarzeilen sind eine Vielzahl von Blöcken entstanden, die der Gliederung des Programms dienen, aber ohne Bedeutung für den Programmablauf sind. Es lassen sich einige Byte einsparen, wenn die Kommentare entfallen. Da sie keine Sprungadressen sind, kann dies auch bedenkenlos geschehen.

Das Programm selbst gewinnt jedenfalls dadurch an Schnelligkeit.

Nun wünsche ich allen Interessierten viel Erfolg beim Eingeben und Anwenden des »Haushaltsbuchs«. Möge die Kasse nun immer stimmen.

(Martin Schumann/gk)

# Basic-Start-Generator [74]

> Maschinenroutinen laden wie Basic-Programme und mit RUN starten, bleibt nicht länger ein Wunschtraum. Dieses Programm macht es möglich.

Wie war noch die Startadresse für den Monitor? Sie haben bestimmt auch schon öfter die Einsprungadresse eines Maschinenprogramms vergessen, wenn Sie viel mit Assembler-Programmen arbeiten. Abhilfe schafft diese kleine Routine, die Sie mit dem MSE eingeben müssen.

Das Programm macht aus einem im Speicher befindlichen Maschinenprogramm ein Programm, das einen normalen Basic-Start besitzt. Es braucht lediglich noch auf den Datenträger gespeichert zu werden — fertig! Das speichern geschieht mit SAVE”name”,8(1). Damit entfällt die leidige Frage nach dem SYS-Befehl, was bei einer großen Programmsammlung schon lästig sein kann. Das so präparierte Programm kann normal (mit »,8« oder »,1«) geladen und mit RUN gestartet werden.

Ausgenommen sind Programme, die im Bereich von $0800 bis $09af und unter dem Basic- und Kernal-ROM liegen, da hier entweder der Basic-Start-Generator oder von ihm verwendete Routinen liegen.

### Tips zur Bedienung

1.	Laden des zu bearbeitenden Maschinenprogramms
2.	NEW eingeben
3.	Laden des Basic-Start-Generators mit LOAD”name”,8
4.	Starten mit RUN
5.	Eingabe von SYS 2089,[anfang],[ende+1],[einsprung] [anfang]: Beginn des Maschinenprogramms im Speicher [ende]: Ende des Maschinenprogramms im Speicher [einsprung]: Einsprungadresse, also der SYS-Wert, mit dem normalerweise das Programm gestartet wurde.<br>Alle Parameter müssen in dezimaler Schreibweise eingegeben werden, wobei der korrekte Bereich (0 bis 65535) selbst überprüft werden muß. Es wird ein »ILLEGAL QUANTITY ERROR« ausgegeben, falls [anfang] > = [ende] ist.
6.	Speichern des erzeugten Programms mit SAVE ”name”,8

### Funktion

Nach der Eingabe und Umrechnung der Parameter in das 16-Bit-Format wird das Quellprogramm direkt hinter den Start-Generator kopiert (ab $08af). Dem Quellprogramm ist nun sein späterer Programmkopf vorgelagert. Des weiteren wird nun ein Teil des Start-Generators nach $C000 kopiert, der die weitere Arbeit übernimmt.

Jetzt werden der Programmkopf und das dahinter liegende Quellprogramm nach $0800, also dem Basic-Start, kopiert. Anschließend werden die Basic-Pointer (Anfang/Ende des Basic-Programms) und im Programmkopf die Adressen gesetzt. Nach der Meldung »READY TO SAVE« kann das bearbeitete Programm abgespeichert werden.

Nun eine nähere Erläuterung zum Programmkopf: lm Basic-ROM gibt es eine Unterroutine, die Speicherinhalte verschieben kann und deren Einsprungpunkt bei $A3BF liegt.

Diese Verschieberoutine macht sich der Basic-Start-Generator im Programmkopf zunutze, so daß das Quellprogramm wieder in seinen Ursprungsbereich kopiert werden kann. Die Übergabe der Kopierparameter erfolgt in den Adressen:
$5F/$60 — alter Blockanfang
$5A/$5B — altes Blockende + 1
$58/$59 — neues Blockende + 1

Nach dem Start des mit einem Basic-Start versehenen Programms wird die Blockverschieberoutine aktiviert und das Programm in seinen Bereich kopiert und gestartet.

Soll das Programm nach RUN nur an seinen ursprünglichen Start verschoben werden, müssen Sie als Einsprungadresse eine Adresse wählen, bei der ein RTS (return to subroutine) steht. Beispielsweise 64922, eine Adresse im Betriebssystem des C 64. RTS entspricht einem RETURN in Basic. Es bewirkt, daß das Programm zwar verschoben, aber nicht gestartet wird. Haben Sie zum Beispiel den SMON mit dem Start-Generator behandelt, meldet sich der SMON nach RUN mit der Registeranzeige, wenn Sie als Einsprungadresse 49152 angegeben haben. Haben Sie 64922 angegeben, kommt die READY-Meldung. Mit SYS49152 können Sie dann den SMON starten.

(Hermann-Josef Rottkemper/hm)

# REM-Killer [75-76]

> Überflüssige REM-Anweisungen in Basic-Programmen lassen sich leicht entfernen. Dieses Programm rechnet aber zusätzlich alle Sprünge auf gelöschte REM-Zeilen um. Und das in wenigen Sekunden.

REM-Statements sind, vor allem für längere Basic-Programme, unumgänglich, um im relativ unübersichtlichen »Basic-Dschungel« den Überblick zu behalten. Spätestens dann, wenn an einem umfangreichen Programm nach einiger Zeit Änderungen erforderlich sind, wird auch der erfahrene Programmierer dankbar sein, wenn er seine Unterprogramme und undurchsichtigen PEEKs, POKEs und SYS-Befehle mit Hilfe von REMs noch durchschauen kann. Kurz gesagt, auch in sauber strukturierten Programmen gehört eine klare Dokumentation einfach dazu.

## Das Problem mit den REMs

Leider haben REM-Statements die unangenehme Eigenschaft, Programme wesentlich zu verlängern und auch zu verlangsamen. Im Gegensatz zu einem Befehl (zum Beispiel POKE), werden REMarks nicht in einem Byte abgespeichert, sondern nehmen durch buchstabenweise Abspeicherung in ASCII-Codes eine Menge Platz weg. Am besten wäre daher, Basic-Programme mit ausführlicher REM-Dokumentation zu entwickeln und auch so zu speichern. Aus diesen »Quellprogrammen« können dann die REMs entfernt werden, um kürzere und schnellere »Lauf«-Versionen zu erhalten. Sollten später einmal Änderungen erforderlich werden, nimmt man diese am »Quellprogramm« vor und generiert daraus wiederum das »Laufprogramm«.

Da es sehr umständlich ist, die REMs in Handarbeit zu entfernen, braucht man ein Programm, das einem diese Arbeit abnimmt. Wozu hat man schließlich einen Computer. Das Programm sollte sehr schnell und unkompliziert zu bedienen sein; es sollte ferner Sprünge auf Zeilen, die mit einem REM beginnen (und daher vollständig gelöscht werden) korrigieren. Genau das macht diese Maschinenroutine.

## Der REM-Korrektor

Wenn der REM-Korrektor mittels MSE als Maschinenprogramm auf Kassette oder Diskette gespeichert ist, kann dieses jederzeit mit LOAD”REM-KORREKTOR”,8,1 (,1,1) geladen werden. Auch dann, wenn sich bereits ein Basic-Programm im Speicher befindet. Der gefürchtete OUT OF MEMORY ERROR, der durch das Nachladen von Maschinenprogrammen und dem damit verbundenen »Verbiegen« der Basic-Zeiger auftritt, wird beim Starten des REM-Korrektors mit SYS 52000 aufgehoben. Der REM-Korrektor liegt ab Adresse 52000 im Speicher, damit die Datasetten-Anwender nicht auf TURBO TAPE verzichten müssen.

Befindet sich der REM-Korrektor einmal im Computer, kann er selbstverständlich immer wieder mit SYS 52000 aufgerufen werden. Danach werden alle REMs aus dem Basic-Programm entfernt. Steht die REM-Anweisung am Zeilenanfang, wird die ganze Zeile gelöscht. Steht sie am Zeilenende, wird nur alles nach dem REM gelöscht. Sprünge auf gelöschte REM-Zeilen werden korrigiert, auch wenn die neuen Sprungadressen aus mehr ASCII-Codes bestehen wie die ursprünglichen. GOTO 99 erfordert 3 Bytes in Basic. Wird die Zeile gelöscht, und die nächste gültige Zeile ist 12300, werden für den geänderten Befehl GOTO 12300 6 Bytes erforderlich. Ferner setzt das Programm alle Basic-Zeiger in der Zeropage auf den aktuellen Wert.

Bearbeitet werden alle Sprünge wie
GOTO
GOSUB
IF...THEN (Zeilennummer)
IF...THEN GOTO (Zeilennummmer)
IF...THEN GOSUB (Zeilennummer)
IF...GOTO (Zeilennummer)
IF...GOSUB (Zeilennummer)
ON X GOTO (Zeilennummer), (Zeilennummer),...
ON X GOSUB (Zeilennummer), (Zeilennummer),...

Einer Zeilennummer vorangehende Leerzeichen sind ebenfalls erlaubt. Bei ON X GOTO oder ON X GOSUB muß jede Zeilennummer, bis auf die letzte durch ein Komma abgetrennt sein.
ON X GOTO 200, 300, 400, 500, 600 ist erlaubt. Nicht jedoch
ON X GOTO 200, 300, 400	, 500, 600.

Während des Programmablaufs erscheinen zur Kontrolle der Korrekturen die Nummern der in die Sprungbefehle neu eingesetzten Zeilen auf dem Bildschirm.

Anschließend kann mit dem Basic-Programm ganz normal weitergearbeitet werden.

## Tips zur Benutzung

1.	Der REM-Korrektor ist in der Lage, durch NEW versehentlich gelöschte Basic-Programme zu regenerieren (RENEW-Funktion), wenn man vor dem Starten durch SYS 52000 den Befehl POKE 2050,1 eingibt (allerdings sind dann sämtliche REMs »raus«).
2.	Zeile 0 darf keine REM-Zeile sein (0REM...). Enthält Zeile 0 einen REM-Befehl, werden keine Sprungkorrekturen ausgeführt.<br>Der REM-Korrektor benötigt für ein 20 KByte langes Basic-Programm etwa 1,5 Sekunden, wenn keine Sprungkorrekturen notwendig sind. Aber auch wenn zahlreiche Korrekturen durchgeführt werden müssen, bleibt die Ablaufzeit im Bereich von einigen Sekunden.

Ist kein Basic-Programm im Speicher, stoppt der REM-Korrektorsofortwieder. Sind nur REM-Zeilen vorhanden, führt er einen RESET durch. Der REM-Korrektor bleibtjedoch funktionsfähig.

Das Programm arbeitet aus Geschwindigkeitsgründen mit Hilfsspeicherbereichen in denen Hilfszeiger abgelegt sind. Da diese den RAM-Speicher unter dem ROM benutzen, wird kein Basic-Speicherplatz verbraucht.

3.	Die Arbeitsweise des REM-Korrektors

Das Maschinenprogramm ist in drei Hauptteile gegliedert. Im ersten Teil wird das Basic-Programm durchsucht und für jede gültige Zeile, oder den gültigen Teil einer Zeile, die Anfangsadresse (2 Bytes) und die Zahl der Bytes (1 Byte) unter dem ROM ab Adresse $A000 abgelegt.

Die Nummern der gelöschten Zeilen (2 Bytes) sowie die Nummer der jeweils nächsten gültigen Zeile (die nicht mit einem REM beginnt), werden ab Adresse $FFFF, ebenfalls unter dem ROM, in absteigender Folge abgelegt.

Anhand der Zeiger ab $A000 werden die Zeilenteile der Basic-Bereiche neu zusammengesetzt und nach untern komprimiert. Das heißt, daß mit den gültigen Zeilen oder Zeilenteilen das ursprüngliche Basic-Programm überschrieben wird. Da das neue Basic-Programm kürzer oder höchstens gleich lang ist wie das alte, kann diese Operation Zeile für Zeile im selben Speicherbereich (Basic-Bereich ab 2048) stattfinden. Damit sind die REMs entfernt!

Die Teile 1 und 2 sind sehr schnell, da der Basic-Speicherbereich jeweils nur einmal durchlaufen werden muß.

Im dritten Teil wird das Basic-Programm nach Sprungcodes durchsucht. Dabei werden Bytes, die zufällig eine Sprungadresse darstellen, sich aber innerhalb von Anführungszeichen befinden (Strings), natürlich ignoriert.

Die gefundene Adresse, also die Folge von ASCII-Codes, wird in eine 2-Byte-Hexadezimalzahl umgewandelt und der Bereich von $FFFF abwärts durchsucht, ob diese Zeilennummer mit der Nummer einer gelöschten Zeile übereinstimmt. Trifft dies zu, wird die ebenfalls abgespeicherte Hexadezimalzahl (Zeilennummer) der nächsten gültigen Zeile geholt und in ASCII-Codes umgerechnet. Ist die neue Zeilennummer, in einer Folge von ASCII-Codes ausgedrückt, länger als die alte, wird das Basic-Programm um diesen Unterschied nach hinten verschoben und die Basic-Zeiger restauriert. Dann wird die Zeilennummer eingefügt und festgestellt, ob noch eine Zeilennummer folgt (ON...GOTO). Wenn nicht, wird nach weiteren Sprungcodes gesucht.

(Dipl. Ing. Wilhelm Meierhofer/hm)

# Hier gibt's Clubs [76]

### Computer-User-Vereinigung Bruchsal

e. V. (C. U. V. B.) Torsten Zimmermann, Steinacker 12, 7520 Bruchsal, überregionaler Club, Clubzeitung, Software- und Hardware-Vertrieb, Computertage, Basic-Kurse

### Computergemeinschaft 64

Michael Fuhrmann, Eilveser Hauptstr. 34, 3057 Neustadt 1, Programmaustausch, POKE’s, Tricks, Verbindungen zwischen C 64-Freunden

### Outlaws 64

Sudetenstr. 8, 6090 Rüsselheim 7, Spielturniere, Clubtreffen, Clubzeitung, Tauschbörse

### Software-Club-64

Hannelore Bauerhenne, Danziger Str. 5, 6272 Niedernhausen, Club-Mitteilungsdiskette zum Selbstkostenpreis

### LCC — Lübecker Commodore Club,

Moltkestr, 14, 2400 Lübeck, Clubtreffen, Softwarebibliothek, Basic, Logo, evtl. DFÜ, Aufnahmeprüfung: eigenes Programm

### POKIS-User & Computerclub

Gerhard Hammer, Postfach 2886, 2000 Hamburg 20, Clubzeitung, Grundlagen-Kurse, Freizeitclub für Angehörige von Mitgliedern

### Sigi-Soft-Computerclub

Siegmar Bröhl, Rosenharth 4, 5207 Ruppichteroth 1, Clubtreffen, Club-Zeitschrift, Softwarebibliothek

### Software-Changer-Club 64 (SCC 64)

Thomas Ross, Neukirchenerstr. 55, 4150 Krefeld 11, Adventure programmieren, Ideenaustausch, Clubzeitung, Programmaustausch

### Falken-User-Gruppe München
St. Bonifatiusstr. 3/III, 8000 München 90, wöchentlicher Treff, Programmierung von Strategiespielen, Kurse, Softwarebibliothek, Öffentlichkeitsarbeit zu neuen Medien, Diskussionen

### C 64-Club

Günther Schroth, Lindenstr. 9, 7273 Ebhausen 3, Hardware-, Software- und Erfahrungsaustausch
NO NAME-Commodore-64-Club
Ralf Hottmeyer, Mudersbacherstr. 81, 5000 Köln 91, Clubtreffen: monatlich, kein Clubbeitrag, Programmund Informationsaustausch

### C 64-Club »New Line«

Postfach 8007, 7910 Neu-Ulm 8, Softwaretausch, Public Domain Software, Programmieranleitungen, Programmieraufträge annehmen und an Mitglieder vergeben
In der nächsten Ausgabe geht’s weiter mit den Clubs.


# Komfortable Ein-/Ausgaberoutine [77]

> Dieses frei verschiebbare Programm für den C 64 erlaubt die Eingabe von bis zu 255 Zeichen. Es sind nur Zeichen erlaubt, die vorher definiert wurden.

Das Programm ist 261 Bytes lang und wird direkt in den Speicher geschrieben. Da es frei verschiebbar ist, verlangt der Lader zuerst die Eingabe der Startadresse und gibt dann die Einsprungadressen der beiden Routinen aus.

### Eingabe-Routine:

Syntax: SYS⟨eingabe⟩, ⟨länge⟩, ⟨zeichen⟩, ⟨variable⟩
⟨eingabe⟩ entspricht der Startadresse der Routine; ⟨länge⟩ bestimmt die maximale Anzahl der Zeichen und ⟨zeichen⟩ die Zeichen selbst, die eingegeben werden dürfen. Mit ⟨variable⟩ kann die Variable selbst bestimmt werden, unter der die Eingabe abgespeichert wird. Ein alter Eintrag wird dabei überschrieben. Bevor die Eingabe beendet werden kann, muß mindestens ein Zeichen eingegeben werden. Für ⟨länge⟩ und ⟨zeichen⟩ können auch Variablen gesetzt werden.

### Ausgabe-Routine:

Syntax: SYS⟨ausgabe⟩, ⟨zeile⟩, ⟨spalte⟩, ⟨druckliste⟩
Diese Routine gleicht dem PRINT-Befehl, wobei jedoch auch der Startpunkt der Ausgabe mit ⟨zeile⟩ und ⟨spalte⟩ festgesetzt werden kann.
Beispiele:

TODO

SYS eingabe,12, "abcdefghijklmnopqrstuvwxyz", e1$
SYS eingabe,5,”1234567890.”,z$
SYS eingabe,C%,a$,b$
SYS ausgabe,0,5,”Hamader Juergen”
SYS ausgabe,ze,sp,tab (5);a;s$,”.- ”;

(Jürgen Hamader/ah)

# Hinweise zum Abtippen unserer Listings [77]

Wenn Sie die 64’er schon öfter gelesen haben, sind Ihnen die Programme Checksummer und MSE sicher ein Begriff. Diese Programme erleichtern Ihnen die Arbeit beim Abtippen der Listings ganz erheblich.

### Checksummer und Basic-Listings

Der Checksummer ist »zuständig« für alle Basic-Programme. Er zeigt nach Eingabe einer Basic-Zeile eine Prüfsumme am Bildschirm an. Wenn diese Zahl mit der in Klammern »< >« stehenden Zahl rechts von jeder Basic-Zeile in unseren Listings nicht übereinstimmt, dürfte ein Tippfehler vorliegen. Die Zahl mit den Klammern darf nicht mit eingegeben werden.

In allen Basic-Listings finden Sie Zeichen und Wörter in geschweiften Klammern. Diese stehen als Ersatz für Grafik- und Steuerzeichen und dienen der besseren Lesbarkeit. So bedeutet zum Beispiel {CLR}, daß die SHIFT und die CLEAR/ HOME-Taste, oder {13SPACE}, daß 13mal die Leertaste betätigt werden muß.

In vielen Basic-Listings finden Sie unterstrichene und überstrichene Buchstaben. Unterstrichene Buchstaben bedeuten, daß Sie die SHIFT-Taste und den entsprechen-

den Buchstaben, überstrichene Zeichen die Commodore-Taste und den Buchstaben drücken müssen. Auf dem Bildschirm erhalten Sie dann die entsprechenden Grafikzeichen. Sie können die Basic-Listing auch ohne den Checksummer eingeben.

### MSE für Assemblerprogramme

Der MSE (Maschinensprache Editor) ist eine große Hilfe bei der Eingabe von Maschinenprogrammen. Der MSE erspart ungefähr ein Drittel Tipparbeit und gestattet keine Fehleingaben. MSE-Listings sind erkennbar an den hexadezimalen Zahlenkolonnen. Als Notbehelf können Sie diese Listings aber auch mit einem Maschinensprachemonitor eingeben.

Diese Programme (Checksummer und MSE) wurden in den 64’er Ausgaben 1/85 bis 6/85 mit einer ausführlichen Erklärung abgedruckt. Sie befinden sich aber ebenfalls auf jeder Leserservice-Diskette. Gegen Einsendung eines frankierten und an Sie selbst adressierten Briefumschlags (Größe DIN C5 = 0,80 Mark, DIN C4 = 1,10 Mark Porto) schicken wir Ihnen gerne beide Listings mit einer ausführlichen Erklärung zu.

# Centronics-Interface für jeden Bedarf [78-81]

> Will man einen Drucker mit Centronics-Eingang an den C 64 anschließen, kommt man um ein Interface nicht herum. Wir zeigen Ihnen mit dieser Software-Schnittstelle die billigste Lösung für ein Interface.

Zweifelsohne sind Software-Lösungen von Centronics-Schnittstellen für den C 64 (mit einfachem Kabel am User-Port) nichts unbekanntes. Bedauerlicherweise ist jedoch die Verträglichkeit mit käuflichen Programmen nicht immer gewährleistet. Viele Textverarbeitungsprogramme funktionieren damit nicht. Die Software für die Schnittstelle wird durch diese Programme leider meistens überschrieben. Dieses Problem läßt sich eigentlich nur durch das feste Einbinden der »Centronics-Software« in das Betriebssystem des C 64 lösen. Der User-Port des C 64 stellt dann eine vollwertige Centronics-Schnittstelle dar. Auf alle Besonderheiten des C 64-Zeichensatzes konnte aber aus Platzgründen keine Rücksicht genommen werden. Reverse Zeichen, Cursor-Steuerzeichen und Sekundäradressen werden, bis auf die Sekundäradresse zur Umschaltung zwischen Groß- und Kleinschrift, nicht erkannt. Dafür wird aber bei Verwendung der Sekundäradresse 7 nicht nur eine Groß-/Kleinschrift, sondern auch eine C 64/ASCII-Codewandlung durchgeführt.

## Centronics hoch drei

In dieser Bauanleitung werden drei Schnittstellen vorgestellt. Zum einen ist das »C 64 Centron« eine Schnittstelle, bei der außer einer Verkürzung der Systemmeldungen nichts im Betriebssystem verloren geht (auch nicht die Kassettenroutinen). Die zweite Schnittstelle ist dem in Ausgabe 4/85 veröffentlichten Hypra-Perfektangepaßt. Bei derdritten Schnittstelle wurde auf größte Flexibilität geachtet. Es handelt sich dabei um ein frei verschiebbares Programm, das komfortabel zu bedienen ist. Außer der dritten Version sind alle Schnittstellen nur als ROM-Version benutzbar. Das Kernal-ROM wird dazu durch ein neues ersetzt. Die dritte Version ist eine reine Software-Lösung. Das Anschlußkabel, welches das in Tabelle 1 dargestellte Verdrahtungsschema haben muß, ist aber in allen drei Fällen gleich.

## Software-Schnittstelle im Betriebssystem integriert

Das größte Hindernis für die Verträglichkeit mit fertigen Programmen ergibt sich aus der Tatsache, daß der C 64 bereits eine Druckerschnittstelle eingebaut hat: den seriellen lEC-Bus. Da käufliche Programme in der Regel diesen Weg benutzen, um einen Drucker anzusprechen, muß eine nachträgliche Lösung Abhilfe schaffen.

C 64 Centron (Listing 1) arbeitet mit allen Centronics-Druckern zusammen, ohne irgendeine Funktion des C 64 zu beeinflussen. Da die Schnittstellen-Software aus den oben erwähnten Gründen im Kernal-ROM selbst liegen muß, war zunächst das Platzproblem zu überwinden. Einerseits hat Commodore fast den gesamten Raum für das Kernal benutzt, andererseits ist der C 64 aber mit ausgesprochen platzaufwendigen Einschalt- und Systemmeldungen ausgestattet. Doch welcher C 64-Besitzer weiß nicht schon nach recht kurzer Zeit, welchen Namen sein Computer hat. Dementsprechend wurde die Einschaltmeldung drastisch verkürzt. Der C 64 meldet von nun an mit
\* C64 CENTRON \* 38911 BYTES RAM

Weiterhin wurden die Meldungen bei Betrieb von Datasette und Floppy vereinfacht. Die neuen Meldungen sind in Tabelle 2 zusammengefaßt. Als nächste Möglichkeit bieten sich die Initialisierungsroutinen des Betriebssystems an. Hier wird vom C 64 nach dem Einschalten untersucht, ob der C 64 in Europa oder in Amerika zum Einsatz kommt. Da die amerikanische Initialisierung in Europa nicht gebraucht wird, konnten die entsprechenden Routinen einschließlich der NTSC-Zeitkonstanten für die RS232-Schnittstelle aus dem Betriebssystem entfernt werden. Damit war genug freier Platz im ROM für die Schnittstellen-Software geschaffen.

Hohe Verträglichkeit einer Schnittstelle wird durch die richtige Einbindung der Änderungen in das Original-Betriebssystem erreicht. Ziel muß es dabei sein, die neuen Routinen so spät wie möglich in den normalen Ablauf der seriellen IEC-Busverbindungen einzubinden. Hier wurde folgender Weg eingeschlagen:

Nach einem Sprung aus der LISTEN-Routine ($EDOC) wird in der neuen Routine beim Ansprechen der Geräteadresse 4 (OPEN 4,4 oder OPEN 4,4,X) ein Flag für Centronics-Ausgabe (Centflag) gesetzt. Der Drucker wird durch Senden einer »0« initialisiert. Bei anderen Geräteadressen wird ein Rücksprung in die normale LISTEN-Routine durchgeführt.

In der SECLISTEN-Routine ($EDB9) wird bei gesetztem Centflag überprüft, ob bei der File-Eröffnung die Sekundäradresse 7 eingegeben wurde. Dementsprechend wird ein weiteres Flag (Secflag) gesetzt. Diese beiden Flags werden in der eigentlichen Ausgaberoutine, die in die lECOUT-Routine ($ED40) eingebunden ist, nacheinander abgefragt. Bei nichtgesetztem Centflag erfolgt ein Rücksprung in die normale lECOUT-Routine. Ist Centflag gesetzt, wird das Secflag abgefragt und bei gesetztem Flag eine Codewandlung von C 64-Code in Standard-ASCII vorgenommen. Nach Ausgabe des ASCII-Zeichens wird wie in der seriellen Ausgabe abgefragt, ob das ausgegebene Zeichen das letzte einer Zeichenkette war. Wenn ja, erfolgt ein Rücksprung in das Normalbetriebssystem. Nach Ausgabe des letzten Zeichens werden Centflag und Secflag gelöscht. Beim Schließen des Druckffiles (CLOSE4) wird »CARRIAGE RETURN« ausgegeben, um eventuell noch im Druckpuffer befindliche Zeichen auszudrucken. Dies geschieht in der SECLISTEN-Routine.

Eine besondere Einrichtung dieser Lösung ist eine Benutzerschnittstelle. Es ist nämlich möglich, vor der eigentlichen Ausgabe eines Zeichens in eigene Routinen zu verzweigen. Und das sogar bei käuflicher Software. Wichtige Voraussetzung dafür ist lediglich, daß ein RAM-Bereich frei bleibt und nie vom Programm beschrieben wird. Dies kann häufig der Kassettenpuffer ($033C-$03FB), weniger häufig der Bereich von $C000 bis$CFFF sein. Im freien RAM-Bereich muß eine Routine stehen, die indirekt angesprochen wird und nach Ausführung in die Centronics-Software zurückspringt. So können zum Beispiel Steuerzeichen auch von Druckern exotischer Herkunft aus Steuersignalen für Standarddrucker (etwa von Commodore oder Epson) erzeugt werden. In Listing 2 ist eine Beispielroutine abgedruckt, die bei Übergabe eines Wertes von 255 an den Drucker einen Text aus der Benutzerschnittstelle ausdruckt.

Die Bedienung der Benutzerschnittstelle läuft nach folgendem Schema ab: Bei gesetztem Secflag (also bei Sekundäradresse 7) wird ein Schlüsselbyte in Speicherstelle $DCOC mit dem Wert $DB verglichen. Ist dieser Wert dort nicht vorhanden, wird die Centronics-Ausgaberoutine mit Codewandlung fortgesetzt. Wird der Wert $DB jedoch gefunden (weil er vorher hineingeschrieben worden ist), springt der C 64 über einen Zeiger in $0336/$0337 (LByte/HByte der Startadresse der eigenen Routine) ins selbstdefinierte Programm, führt die programmierten Funktionen aus und kehrt in die Ausgaberoutine zurück.

Weitere Möglichkeiten, etwa umfangreiche Codewandlung über Tabellen etc., können dadurch selbst entwickelt werden.

Die hier vorgestellte Schnittstelle arbeitet mit allen bisher getesteten Programmen zusammen, einschließlich Textomat, Textomat plus und MAE-Assembler. Leider ist es nicht mehr möglich, gleichzeitig bei Anschluß eines Druckers an den User-Port die RS232-Schnittstelle zu betreiben. Sämtliche RS232-Routinen sind jedoch unverändert vorhanden und funktionstüchtig.

Der Basic-Lader kopiert das Kernal in den RAM-Bereich von $6000 bis $7FFF und verändert dort das Betriebssystem. Das C 64 CENTRON-Betriebssystem kann nun durch Menüwahl entweder auf Diskette abgespeichert oder mit einem EPROM-Kopiergerät in ein 8-KByte-EPROM gebrannt werden. Das EPROM wird auf einer entsprechenden Adapterplatine oder auch auf einer Betriebssystem-Umschaltplatine in den Sockel U4, anstelle des normalen Kernal-ROM, eingesetzt.

## Hypra-Centronics

Da bei der Programmierung des Hypra-Perfekt bereits auf die Kassettenroutinen verzichtet wurde, war die Platzsuche im Betriebssystem weniger aufwendig. Trotzdem mußte auch hier etwas getrickst werden. Die Schnittstelle fand keinen Platz mehr. Wer bereits im Besitz eines Hypra-Perfekt-Kernals ist, sollte Listing 3 eingeben und starten. Das neue Betriebssystem mit Centronics-Schnittstelle befindet sich dann wie gewohnt ab $6000 bis $8000 im Speicher. In den REM-Zeilen am Anfang des Listings ist angegeben, welche Änderungen vorgenommen werden müssen, um an Stelle des $6000-Bereichs den $8000-Bereich als Startadresse zu erhalten. Diese Änderungen können notwendig werden, wenn das EPROM-Programmiergerät nicht mit Programmen im $6000-Bereich arbeiten kann.

## Softwarelösung für jedermann

lm Gegensatz zu den beiden bisher beschriebenen Versionen arbeitet die Schnittstelle aus Listing 4 im RAM-8peicher des C 64. Dafür bietet sie aber den Vorteil, völlig frei verschiebbar zu sein. Einige Bereiche, in denen die Schnittstelle keinen Platz findet, wurden von vorneherein ausgeschlossen. Eine Fehlbedienung ist somit fast unmöglich. Nach dem Starten des Programms meldet sich ein Menü, mittels dessen Sie den Speicherbereich, in dem die Schnittstelle arbeiten soll, eingeben können. Es ist dabei belanglos, ob Sie den Speicherbereich in dezimaler oder hexadezimaler Form (zum Beispiel $C000) bestimmen. Das Programm rechnet die Adressen um und informiert Sie anschließend darüber, mit welchem SYS-Befehl (der ja vom Speicherbereich abhängt) die Schnittstelle immer wieder neu initialisiert werden kann.

Wir hoffen, Ihnen mit diesen drei Lösungen das Mittel an die Hand zu geben, mit dem Sie jeden Drucker mit Centronics-Schnittstelle an den C 64 anschließen können. Es sei nochmals darauf hingewiesen, daß Listing 1 und Listing 3, ausschließlich für die Verwendung im Kernal-ROM vorgesehen sind. Dazu ist es notwendig, den Computer zu öffnen (Achtung! Garantieverlust) und das Kernal-ROM durch ein 2764-EPROM zu ersetzen. Bitte beachten Sie, daß dieser EPROM-Typ nur mit einer Adapterplatine (Bild 1 zeigt, welche Pins von Sockel und EPROM miteinander zu verbinden sind) in den U4-Steckplatz eingesetzt werden darf. Ohne diesen Adapter wird der C 64 wahrscheinlich beschädigt.

Wer möchte, kann sein neues Betriebssystem natürlich auch im RAM unter dem ROM ($E0000 bis $FFFF) ausprobieren. In Listing 1 ist dafür eine eigene Funktion im Menü vorgesehen. Bei Listing 4 brauchen Sie sich keine Gedanken um EPROMs und Steckplätze zu machen. Sie funktioniert ohne jede Änderung mit jedem C 64. Leider muß sie jedesmal vor dem Arbeiten neu geladen werden.

(W. Forstenrath, M. Braun, A. Wängler/hm)

# File-Compactor [82]

> Wozu unnötigen Ballast auf Diskette speichern und laden? Der File-Compactor kürzt fast jedes Programm — bis zu 50 Prozent. Einzige Voraussetzung: mindestens eine Basic-Zeile.

Fast alle Programme, egal ob Basic oder Assembler, weisen Folgen von gleichen Zeichen auf. Denken Sie nur an Grafikbilder, die in einem Programm enthalten sein könnten. Diese Zeichenfolgen lassen sich kürzen.

Man geht dazu folgendermaßen vor: Man durchsucht das ganze Programm nach Folgen von gleichen Bytes. Wurde eine Folge gefunden, wird ein Merkzeichen (in diesem Fall $bf oder $cf) an die momentane Stelle geschrieben. Danach der Zeichencode und die Anzahl der Zeichen. Verwechslungen mit eventuell vorkommenden $bf- oder $cf-Codes können dadurch ausgeschlossen werden, indem man vor diese Codes noch mal den Code und für die Anzahl eine »1« schreibt.

Damit die gekürzte Version lauffähig ist, wird vor das eigentliche Programm noch ein »Entpacker« gesetzt, der auch mit abgespeichert werden muß. Von jedem Programm bleibt nach dem Komprimieren nur noch eine Zeile mit einem SYS-Befehl (zum Start des Entpackers) übrig.

Tippen Sie RUN ein, wird vor dem eigentlichen Programmstart das ursprüngliche Programm aus den komprimierten Daten wieder zusammengesetzt; erkenntlich an der dunkelblauen Rahmenfarbe. Das komprimierte Programm wird dazu an das Speicherende verschoben und dann Byte für Byte wieder an die Stelle gesetzt, wo es vor der Behandlung mit dem File-Compactor stand. Stoppen Sie das Basic-Programm nach dem Entpacken mit STOP oder STOP/RESTORE, sehen Sie wieder das normale Basic-Programm in seiner vollen Länge.

## Spart Platz auf Disketten

Ein Beispiel: Bestimmte Versionen des Spiels »Apocalypse« sind 153 Blocks lang. Nach der Behandlung mit dem File-Compactor aber nur noch 83 Blocks, also um 46 Prozent kürzer.

### Tips zur Benutzung

1.	File-Compactor mit dem MSE eingeben und abspeichern.
2.	Das so gespeicherte Programm mit LOAD”FILE-COMPACTOR”,8 laden und mit RUN starten.
3.	Diskette mit dem zu kürzenden Programm einlegen.
4.	Namen des Programms eingeben und RETURN drücken. Das Programm wird geladen.
5.	Diskette mit genügend freiem Platz einlegen.
6.	Namen des gekürzten Programmes eingeben und RETURN drücken. Die gekürzte Version wird gespeichert.

Wollen Sie ein Maschinenprogramm kürzen, das mit LOAD ”name”,8,1 geladen und mit SYS gestartet wird, müssen Sie das Programm erst mit dem Basic-Start-Generator auf Seite 74 »vorbehandeln«.

(Marcus Breiing/hm)

# Elektronischer Merkzettel [83]

> Wenn Sie mit zwei unabhängigen Bildschirmen arbeiten wollen, dann werden Sie von diesem Programm begeistert sein.

Das Programm »Merkzettel« ist ganz in Maschinensprache geschrieben. Es entstand aus folgendem Problem: Während man ein Programm schreibt, will man Notizen machen, die man häufig auf einem Zettel notiert. Hat man dann erst einmal einige Zettel vollgeschrieben, findet man meistens die erste Notiz nicht gleich wieder. Das kostet Zeit und beansprucht die Nerven. Dieses Programm ermöglicht nun das Führen eines Notizblattes direkt mit dem Computer. Durch Drücken der Funktionstaste F1 wird der Inhalt des Bildschirms mit dem Inhalt des Speichers vertauscht. Sie schreiben also Ihre Notizen auf den Bildschirm, drücken die Taste F1 und schon haben Sie die Information gespeichert. Wenn Sie sie wieder brauchen, drücken Sie einfach erneut die Taste F1, und auf dem Bildschirm erscheinen die vorher abgelegten Informationen, in einer bestimmten Farbe. Diese Farbe können Sie in der Zeile 88 ändern, indem Sie einen anderen Wert als Null in das Register 49366 POKEn.

Das Programm belegt den Bereich von $C000 bis $CODB. Außerdem werden die nachfolgenden 2 KByte noch zur Zwischenspeicherung benötigt.

(Georg Kramer/ah)

# »Fenster«-Befehle für den C16 [84]

> Dieses Programm stellt den im C 16-Basic leider nicht vorhandenen »Window«-Befehl zur Verfügung und macht Schluß mit dem umständlichen Hantieren mit den ESC-Funktionen.

Wer im Befehlssatz des Basic 3.5 nach dem Befehl »Window« sucht, wird nicht fündig. Die groß angekündigte moderne Window-Technik läßt doch zu wünschen übrig. Ein Window, also ein Bildschirmfenster, kann nur mit Hilfe der ESC-Taste definiert werden.

So muß man, um ein Window zu setzen, mit dem Cursor an die linke obere Ecke des gewünschten Bildschirmfensters fahren und die Tasten ESC und T drücken. Die rechte untere Ecke des Fensters wird ebenfalls mit dem Cursor gewählt und mit ESC und B gesetzt. Erst jetzt ist das Fenster definiert.

Im Direktmodus ist dieser Aufwand nicht hinderlich, sondern bringt eher Vorteile, da kein Befehl »WINDOW« am Bildschirm erscheint. Im laufenden Programm ist es jedoch sehr umständlich, ein Fenster zu generieren. Es sind sehr viele PRINT-Anweisungen nötig.

Da die Window-Funktion jedoch in vielen Programmen nützlich ist, lohnt es sich schon, diese Funktion komfortabel als Basic-Befehl zur Verfügung zu haben. Ein kleines Maschinenprogramm macht’s möglich.

Nach Eintippen des DATA-Laders (Listing 1) sollten Sie das Programm als erstes unbedingt abspeichern, da es sich nach Kontrolle der Prüfsumme selbst initialisiert und anschließend der DATA-Lader gelöscht wird.

Haben Sie das Programm abgespeichert, dann können Sie es mit »RUN« starten und haben kurz danach den neuen Basic-Befehl »FENSTER« zur Verfügung.

Der FENSTER-Befehl hat folgendes Format und kann in jedem Basic-Programm verwendet werden:
FENSTER AZ,AS,EZ,ES

Die Parameter haben folgende Bedeutung:

TODO TABLE

AZ = **A**nfangs**Z**eile
AS = **A**nfangs**S**palte
EZ = **E**nd**Z**eile
ES = **E**nd**S**palte

Gibt man im Programm beispielsweise die folgende Zeile 10 ein, so wird ein Fenster von Spalte 5 der fünften Zeile bis einschließlich Spalte 35 der 15. Zeile definiert.
10 FENSTER 5,5,35,15

Das Fenster kann durch zweimaliges Drücken der HOME-Taste oder durch Generieren eines neuen Fensters gelöscht werden.

Dem Fenster-Befehl müssen auf jeden Fall vier Parameter folgen. Für die Parameter AZ und EZ sind nur Zahlen zwischen 1 und 25 zulässig. AS und ES dürfen nur zwischen 1 und 40 liegen. Außerdem ist zu beachten, daß AZ auf keinen Fall größer als EZ, und AS nicht größer als ES gewählt wird.

Der Fenster-Befehl darf auch nicht im Direktmodus verwendet werden, aber da ist die normale Vorgehensweise über »ESC« sowieso sinnvoller. Sollten diese Bedingungen nicht beachtet werden, erscheint die Fehlermeldung »SYNTAX ERROR«.

Das Beispielprogramm Fenster-Demo (Listing 2) generiert zufällige Textfenster und füllt diese farbig aus.

Der FENSTER-Befehl verkürzt ein Basic-Programm bei häufiger Anwendung gegenüber der konventionellen Methode über PRINT-Anweisungen ganz erheblich, so daß die vom Maschinenprogramm beanspruchten 255 Byte trotz des mageren C 16-Speichers kaum ins Gewicht fallen dürften.

(Christian Quirin Spitzner/ev)

# Tips und Tricks [85-86]

## VC 20-Steckmodule auf Diskette

Wer ein Programmierhilfe-Modul wie zum Beispiel den »Super-Expander« und gleichzeitig eine 64-KByte-8peichererweiterung besitzt, der steht vor dem Problem, daß immer nur eines von beiden Modulen eingesetzt werden kann. Man hat also die Wahl zwischen erweitertem Speicher und komfortabler Programmierung.

Doch das muß nicht so sein. Wenn Sie ein Diskettenlaufwerk zur Verfügung haben, dann können Sie das Modul einfach auf Diskette abspeichern und bei Bedarf in den Steckmodulbereich ($A000 bis $BFFF) der 64-KByte-Erweiterung laden. Gehen Sie dabei wie folgt vor:

Bei eingesteckter Supererweiterung wird zunächst der Basic-Anfang durch
POKE 43,0:POKE 44,160
auf $A000, also auf den Steckmodulanfang, gesetzt. Nun wird noch der Zeiger auf das Basic-Ende verbogen:
POKE 45,0:POKE 46,192

Das Modul kann jetzt mit »SAVE ”»Name”,8« auf Diskette gespeichert werden. Bei Bedarf kann es jederzeit wieder mit »LOAD ”Name”,8,1« geladen werden, vorausgesetzt natürlich, man hat RAM im Bereich $A000 bis $BFFF zur Verfügung. Die Supererweiterung wird mit »SYS 64802« eingeschaltet und meldet sich dann mit 28023 freien Speicherbytes. Ausgeschaltet werden kann sie mit »SYS 64818«.

Natürlich ist das Laden von Diskette umständlicher, als gleich mit dem Steckmodul zu arbeiten. Der große Vorteil liegt aber darin, daß man jetzt über die Befehle der Supererweiterung und gleichzeitig den vollen Speicherausbau verfügt.

Es muß noch darauf hingewiesen werden, daß sich Spielemodule mit dieser Methode in der Regel nicht kopieren lassen, da sie erstens mit einem Autostart versehen sind und zweitens zusätzliche Schutzmaßnahmen eingebaut haben. Die hier beschriebene Methode funktioniert nur zusammen mit einer Diskettenstation, da das Betriebssystem des VC 20 sich weigert, den Steckmodulbereich auf Kassette abzuspeichern.

(Günter Büntemeyer)

## Es muß nicht immer »READY.« sein ...

Wenn Sie sich darüber ärgern, daß der C 64 nach jedem ausgeführten Befehl sein stupides »READY.« auf den Bildschirm schreibt, dann geben Sie doch die beiden folgenden Zeilen im Direktmodus ein:
FOR I = 40960 TO 49151 : POKE I,PEEK(I) : NEXT : POKE 1,54 : REM Basic-Interpreter ins RAM laden
FOR I=41848 TO 41853 : POKE I,32 : NEXT : REM READY-Meldung überschreiben

Wenn Sie jetzt irgendeinen Befehl eingeben, erscheint kein »READY.« mehr. Natürlich können Sie aber auch einfach den Text ändern:
A$="HALLO." : FOR I = 1 TO 6 : POKE 41847 + I,ASC(MID$ (A$,I,1)) : NEXT

Nach Eingabe dieser Zeile meldet sich der Interpreter nach jeder Eingabe mit »HALLO.«. Sie können jeden beliebigen Text wählen, vorausgesetzt, er ist maximal sechs Zeichen lang.

(Andreas Scharrer)

## Simons Basic und TurboTape

Das langsame Laden von der Datasette ist ein gravierender Nachteil von Simons Basic, der sich aber mit »Turbo Tape« beheben läßt. Nun überschneiden sich zwar Simons Basic und Turbo-Tape in bestimmten Speicherbereichen und bei der Zeropage-Belegung, aber das läßt sich mit wenig Aufwand beheben. Wer sich an die folgenden Anweisungen hält, wird künftig auch bei Simons Basic im Turbo-Tape-Modus laden und abspeichern können. Die Anweisungen gelten für alle Turbo-Tape-Versionen, die einen Basic-Kopf haben und über »SYS 50000« reaktiviert werden können. Die Anfangsadresse des ungekürzten Turbo-Tape ist A=3032. Bei anderen Anfangsadressen sollte der entsprechende Wert im Umschreibeprogramm verwendet werden.
(1)	Umschreiben von Turbo-Tape
Durch folgende Manipulationen wird Turbo-Tape in einen anderen Speicherbereich verlegt:
— Simons Basic laden und starten.
— Turbo-Tape laden ohne zu starten.
— Eingabe der folgenden Zeilen im Direktmodus:
A=3032 : B=PEEK(45) + 256 * PEEK(46) : D=0 : DIM A(100)
FORX=ATOB:C = PEEK(X): IFC>19ANDC<198THEN D=D+1 : A(D)=X : NEXT : ELSE : NEXT
H = 141 : G = 169
FOR X=1 TO D : C=A(X): F=PEEK(C-2): IF F=32 OR F=H OR PEEK(C-1)=GTHEN POKE C,PEEK(C)-96: NEXT:ELSE : NEXT
— Turbo-Tape ist jetzt fertig umgeschrieben und sollte zunächst abgespeichert werden.
(2)	Der Umgang mit Simons Turbo-Tape
— Erst Simons Basic, dann das umgeschriebene Turbo-Tape laden und starten.
— Um mit Simons Basic normal arbeiten zu können, muß es mit »SYS 32778« reaktiviert werden. Ein eventuell vorhandenes Programm erhält man mit dem Befehl »OLD« zurück.
— Zum Laden oder Abspeichern von Programmen wird TurboTape mit »SYS 25424« aktiviert.
— Simons Basic und Turbo-Tape werden also je nach Bedarf wechselseitig eingeschaltet.
— Der Basic-Speicher sollte auf $6000 eingegrenzt werden, damit Turbo-Tape nicht überschrieben wird.

Wenn man sich genau an diese Hinweise hält, dann steht einem Arbeiten mit Turbo-Tape auch bei Simons Basic nichts mehr im Wege. Es gibt mittlerweile auch neue Versionen von Turbo-Tape und Simons Basic, die problemlos von Anfang an zusammenarbeiten.

(Klaus Holthausen)

## Tips für VC 20 und Datasette

POKE 37148,252 Datasetten-Motor einschalten
POKE 37148,254 Datasetten-Motor ausschalten
WAIT 37148,2,2 Wartet auf Drücken einer Datasetten-Taste
WAIT 37151,64 Wartet, bis »Play«-Taste ausrastet

(Thomas Hahn)

## Textomat mit Centronics-Drucker

Mit wenig Aufwand und zudem sehr preiswert ist es möglich, das Textverarbeitungsprogramm »Textomat« von Data-Becker ohne teures Hardware-Interface an einen Centronics-Drucker (zum Beispiel Epson RX) anzuschließen.

Als Software-Schnittstelle wird dabei das Treiberprogramm von Arnd Wängler und Thomas Krätzig aus der Ausgabe 6/84 des 64’er-Magazins verwendet und das dazugehörige, im gleichen Artikel beschriebene User-Port-Kabel, das ein paar Mark in Anspruch nimmt.

Die Aufgabe besteht nun darin, Textomat irgendwie an diese Schnittstelle anzupassen. Zur Datenübertragung mit dem Wängler/Krätzig-Interface muß ein Druckerfile zur Geräteadresse 4 geöffnet werden, das keine Sekundäradresse oder allenfalls die Sekundäradresse 128 enthalten darf. Da Textomat aber nur Sekundäradressen zwischen 1 und 14 zuläßt, muß die Anpassung extern erfolgen. Dabei behilft man sich mit einem kleinen Trick:

Mit dem Druckermenü des Textomat wird ein Druckerprogramm zu einer anderen Sekundäradresse erstellt und auf Diskette abgelegt.

Dieses »Programm« wird nach Aus- und Wiedereinschalten des C 64 wie ein normales Basic-Programm mit »LOAD ”Drucker”,8« geladen. Der LIST-Befehl darf aber auf keinen Fall verwendet werden, da es sich um kein eigentliches Programm handelt. Statt dessen gibt man nach dem Laden »POKE 2048+255,128« ein, wodurch die Sekundäradresse auf 128 geändert wird. Anschließend wird das so geänderte Drucker-File mit »SAVE ”:Drucker”,8« wieder auf die Diskette zurückgeschrieben. Die für den Epson-Drucker erforderliche Anpassung der Commodore-Zeichen an den Standard-ASCII-Zeichensatz kann über die Druckeranpassung des Textomat erfolgen.

Um nun mit Textomat und dem Centronics-Treiber zu arbeiten, muß stets als erstes das Treiberprogramm aus der Ausgabe 6/84 geladen und mit »SYS 724« initialisiert werden. Dann lädt man das Textomat-Hauptprogramm mit »LOAD ’T.OBJ”,8,1« und startet es mit »SYS 4108«. An diesen SYS-Befehl sollte man sich beizeiten gewöhnen, da der normale Start mit SYS 4096 den Kopierschutz aktiviert, der das Directory jeder »unbefugten« Diskette löscht.

Der Centronics-Drucker kann jetzt wie ein Commodore-Drucker angesprochen werden, nachdem die ASCII-Anpassung und die Anpassung der Steuerzeichen vorgenommen wurde.

Zu bemerken wäre noch, daß diese Vorgehensweise mit der 83’er Textomat-Version erprobt wurde und das Funktionieren mit neueren Versionen nicht garantiert ist.

(Werner Weigelt)

## POKEs für den VC 20

POKE 199,1 Wirkung wie RVS ON
POKE 199,0 Wirkung wie RVS OFF
POKE 214,X Setzt Cursor um X Stellen nach unten
POKE 774,0 Listschutz (Listet nur Zeilennummern)
POKE 774,27 Listschutz (Listet nur Unsinn)
POKE 774,26 Listschutz aus
POKE 775,1 Listschutz (VC 20 stürzt ab)
POKE 775,200 Listschutz (»Error« nach erster Zeile)
POKE 775,199 LIST wieder normal
POKE 776,221 Verweigert Befehlsausführung
POKE 777,1 Cursor »HOME« nach jedem Befehl
POKE 777,199 Hebt vorherigen POKE wieder auf
POKE 788,194 RUN/STOP-Taste abschalten
POKE 788,191 RUN/STOP-Taste wieder in Betrieb
POKE 792,2 RESTORE-Taste abschalten
POKE 792,173 RESTORE-Taste wieder in Betrieb
POKE 808,128 RUN/STOP und RESTORE abschalten
POKE 808,112 RUN/STOP und RESTORE wieder in Betrieb
POKE 36864,X Horizontale Bildschirmzentrierung (X=0-59)
POKE 36865,X Vertikale Bildschirmzentrierung (X=0-156)
POKE 36866,X Anzahl Bildschirmspalten (X=128 + Spalten)
POKE 36867,X Anzahl Bildschirmzeilen (X=2-46)
POKE 36869,242 Umschalten auf Kleinschriftmodus
POKE 36869,240 Umschalten auf Großschrift/Grafik
POKE 37148,251 Datasettenmotoraus
POKE 37148,252 Datasettenmotor ein
POKE 37150,2 Setzt RESTORE-Taste außer Betrieb
POKE 37150,130 Setzt RESTORE-Taste wieder in Betrieb (Herbert Lickes)

## Reset-Helfer für C 64

Das Betriebssystem des C 64 enthält ab der Adresse $FD02 ein Unterprogramm, das im Steckmodulbereich ab $8000 nach der Zeichenfolge »CBM80« sucht. Nach dem Einschalten des Computers oder nach einem Reset wird dieses Unterprogramm jedesmal aufgerufen. Werden ab der Adresse $8003 die Zeichen »CBM80« gefunden, dann wird nicht zum Basic-Start gesprungen, sondern das Betriebssystem nimmt an, daß ein Modul eingesteckt ist, holt sich aus der Speicherzelle $8000/$8001 die Startadresse des Modulprogramms und verzweigt dorthin.

Das kleine »Reset-Helfer«-Programm (Listing) nutzt dies aus, indem es die genannten Speicherstellen in geeigneter Weise abändert. Es schreibt die »CBM80«-Zeichenfolge ab $8003 ins RAM und läßt die Speicherstellen $8000/$8001 auf den Basic-Warmstart zeigen.

Wenn man jetzt einen Reset auslöst, kommt man wie gewohnt aus allen »abgestürzten« Programmen heraus, ein vorhandenes Basic-Programm bleibt aber erhalten.

(Henning Zipf)

## Einfacher Reset-Schalter selbstgebaut

Sehr preiswert und einfach kommt man im Selbstbau zu einem Reset-Schalter, wenn man sich im Elektronikfachgeschäft einen sechspoligen Diodenstecker und einen Miniatur-Tastschalter besorgt. Der Tastschalter wird zwischen die Pins 2 und 6 des Diodensteckers gelötet (siehe Bild). Zur Pinbelegung vergleiche auch Seite 142 im C 64-Handbuch. Der so präparierte Diodenstecker wird nun in den seriellen Port des C 64 beziehungsweise VC 20 gesteckt. Falls der Port bereits von Floppy oder Drucker belegt ist, kann der Stecker natürlich auch in die freie Buchse des entsprechenden Zusatzgerätes eingesteckt werden. Auf Knopfdruck wird nun in jedem Fall wieder der Einschaltzustand des Computers hergestellt.

Die Kosten für Stecker und Taste betragen zusammen etwa 4 Mark.

(Henning Zipf)

# Bücher [88]

## Die Floppy 1541

Schon seit längerem angekündigt, ist es dieser Tage endlich auf den Markt gekommen: Das Buch über die 1541-Floppy von Karsten Schramm, der den Lesern des 64’er-Magazins als Autor des Floppy-Kurses kein Unbekannter ist. Hier plaudert ein Profi aus seiner Trickkiste. Denn bei diesem Floppy-Buch wurde der Schwerpunkt auf die Themen gelegt, bei denen andere aufhören.

Und so erfährt man dann in lockerem Stil, was in dem Diskettenlaufwerk wirklich abläuft, und wie man es geschickt manipulieren kann. Kein Blatt vor den Mund genommen wird, wenn es um Software-Schutzmethoden geht: Vielleicht ein Ärgernis für den einen oder anderen Softwarehersteller, aber nützlich für den ambitionierten Anwender, der seine selbstgeschriebene Software kopiersicher machen will.

Dennoch ist das vorliegende Buch nicht nur für Profis geeignet: Wer bisher nur die Befehle LOAD und SAVE mit seiner 1541 in Verbindung bringen konnte, der erfährt hier, wie man sequentielle, relative und Direktzugriffs-Dateien realisieren und ausnutzen kann.

Einige der weiteren Themen: Fehler im Commodore-DOS werden schonungslos offengelegt. Der serielle Bus wird unter die Lupe genommen und nach Hypra-Load-Manier beschleunigt. Methoden zur Rettung von verlorengegangenen Daten und fehlerhaften Blöcken werden vorgestellt. Und dies sind noch längst nicht alle der angesprochenen Bereiche.

Das Allerbeste an diesem, Buch ist allerdings das dokumentierte Listing des 1541-ROMs. Es ist fast zu schön um wahr zu sein, wie gründlich die Dokumentation vorgenommen wurde, denn sie läßt sich fast schon wie ein zusammenhängender Text lesen. Praktisch jeder einzelne Maschinenbefehl wurde mit einem erläuternden Text versehen, weiter gibt es zu jeder der rund 400 Einzelroutinen des DOS einen kleinen einleitenden Text, dem dann die ausführliche Dokumentation neben dem Assembler-Listing folgt.

Die Dokumentation, die fast die Hälfte des Buches in Anspruch nimmt, wird von einer ebenso ausführlichen RAM-Belegung ergänzt. Mehrere nützliche Programme und ein ausführliches Stichwortverzeichnis runden das äußerst positive Gesamtbild ab. In Vorbereitung ist eine Diskette mit allen abgedruckten und einigen zusätzlichen Programmen. Das eindeutige Urteil: Ein Floppy-Buch, wie man es sich besser kaum vorstellen kann. Von seiner Qualität her gesehen hat es gute Chancen, **das** Standardwerk über die 1541 zu werden.

(Boris Schneider/ev)

Info: Karsten Schramm, Die Floppy 1541, Markt & Technik 1985, 430 Seiten, ISBN 3-89090-098-4, 49 Mark

## Grafik & Musik auf dem Commodore 64

Das Thema Nummer Eins auf dem Commodore 64, zumindest was die Bücherproduktion angeht, ist immer noch die Grafik. Im vorliegenden Buch »Grafik & Musik auf dem Commodore 64« wird dieses Thema zusammen mit den akustischen Fähigkeiten sehr ausführlich und mit vielen Beispielen versehen erklärt. Dabei werden nur Basic-Grundkenntnisse vorausgesetzt. Gerade den Anfängern, die vom original Commodore-Handbuch stark enttäuscht worden sind, wird hier auf fast 340 Seiten einiges geboten. Von der einfachen PRINT-Grafik über Sprites und hochauflösunde Grafik im Multicolormodus, von einfachen Piepston über Klangeffekte bis zum Musikstück und der Kombination dieser Dinge, wird die Thematik hier voll ausgeschöpft.

Sehr gefallen hat dabei auch der lockere Stil, in dem das Buch gehalten ist. Außerdem wird bewiesen, daß man nicht immer erst graue Theorie von der Praxis lernen muß. Ein Beispiel: Um die Programmierung von Sprites zu verstehen, muß man sich nicht erst durch langwierige Erklärungen des Binärsystems kämpfen, sondern arbeitet vorerst mit einem Spriteentwurfsblatt, das alle wichtigen Daten enthält. Natürlich wird später genau auf die Arbeitsweise des VICs eingegangen, das Binärsystem bleibt ebenfalls nicht unbeachtet. Es kann dann jedoch anhand des schon ausgeführten Beispiels gelernt werden.

Einen einzigen kleinen Haken hat das Ganze aber doch: Da hier fast ausschließlich auf Basic-Ebene gearbeitet wird, arten manche Programme geradezu in POKE- und DATA-Orgien aus, die man aber dank der guten Dokumentation in den Griff kriegen kann. Viele Tabellen, Entwurfsblätter und Registerübersichten bilden einen sehr umfangreichen Anhang, den selbst der inzwischen weit fortgeschrittene Programmierer gerne als Nachschlagewerk benutzen wird. Alles in allem ein empfehlenswertes Buch, für das die 38 Mark sicherlich nicht zu viel sind.

(Boris Schneider)

Info: Stan Krute, Grafik & Musik auf dem Commodore 64, Markt & Technik 1984, zirka 340 Seiten, 38 Mark.

## Spaß an Mathe mit dem Commodore 64

Endlich einmal ein Buch, das die Mathematik für Computer nicht von der bierernsten Seite her angeht. Das Konzept von »Spaß an Mathe mit dem Commodore 64« hat denn auch die Mathematik nur als Aufhänger: Tatsächlich wird gezeigt, wozu man den Computer außer »Space Invaders« und »Impossible Mission« noch benutzen kann.

Daß dabei dann auch noch eine Vielzahl gut dokumentierter und wirklich nützlicher Programmlistings herausspringt, ist ein weiterer Pluspunkt. Die wichtigsten Listings sind eine Grafik- und eine Mathematikspracherweiterung, die sich durchaus mit kommerziell vertriebener Software messen können.

Einziger Nachteil: Die beiden arbeiten nicht zusammen. Dafür ist das Eintippen der doch recht umfangreichen Listings recht komfortabel gehalten worden: Im Anhang des Buches befindet sich ein Programm, das die Eingabe enorm erleichtert und gegen Fehler absichert.

Auf den beiden Spracherweiterungen aufbauend werden dann einige mathematische Probleme behandelt, die nicht gerade zum Schulalltag gehören, so zum Beispiel magische Zahlenquadrate, Warteschlangen oder Populationsprobleme. Auch ein Funktionsplotter darf natürlich nicht fehlen. Und damit man auch wirklich was lernt, sind alle Listings vollständig dokumentiert (auch die Assemblerlistings).

Zusätzlich werden stapelweise Grundlagen über den C 64 und zahlreiche Tips und Tricks vermittelt. Beim Funktionenplotter erfährt man zum Beispiel, wie man Fehlermeldungen abfangen kann, oder wie sich selbstverändernde Programme per Tastaturpuffer programmieren lassen.

Man tut sich also nicht schwer, später eigene, leistungsfähige mathematische Programme zu schreiben. Natürlich darf man nicht als totaler Anfänger an das Buch herangehen, man sollte sich schon etwas mit den Basic-Befehlen auskennen, und auch den Mut haben, erste Kontakte mit Maschinensprache aufzunehmen.

Dann bringt einem dieses Buch aber eine ganze Menge, lernt man doch seinen Commodore 64 am praktischen Beispiel kennen. Man merkt deutlich, daß hier als Autor ein Lehrer am Werke war.

(Boris Schneider)

Info: Holger Danielsson, Spaß an Mathe mit dem Commodore 64, Sybex 1985, 280 Seiten, Preis: 32 Mark

## Mathe für die Oberstufe. ...aufgezeigt am Beispiel Commodore 64

So lautet der recht vielversprechende Titel eines neuen Buches aus dem IWT-Verlag, das auch durch einen dem Schülergeldbeutel angepaßten Preis (28 Mark) besticht.

Aber damit sind leider auch fast alle positiven Seiten dieses Buches aufgezählt. Man erhält nämlich nichts weiter als 14 undokumentierte und teilweise recht lange Programmlistings minderer Qualität.

Ein Beispiel: »Kurvendiskussion für Polynome zweiten Grades«. Wer die 13 Druckseiten abgetippt hat, kann sich nun zu jedem solchen Polynom die Symmetrieeigenschaften, Nullstellen, Extremwerte und Wendepunkte sowie das Monotonie- und Krümmungsverhalten ausgeben lassen.

Dummerweise hat ein Polynom zweiten Grades jedoch weder Wendepunkte noch ist es punktsymmetrisch, so daß die entsprechenden Erklärungen und Berechnungen im Programm völlig nutzlos sind.

Ein Nutzen daraus könnte allenfalls vielleicht gezogen werden, wenn man das Programm selber auf andere Funktionen erweitert oder umschreibt, was allerdings durch das Fehlen jeglicher Dokumentation stark erschwert wird.

Es geht aber noch weiter: Man scheute sich nicht, als weiteres Listing eine »Kurvendiskussion mit Integration für Polynome zweiten Grades« abzudrucken. Man ahnt was kommt: Dasselbe Programm noch einmal, dann allerdings um einen Unterprogrammpunkt und auf 20 Druckseiten erweitert.

Vorhanden ist übrigens noch eine Kurvendiskussion von Polynomen dritten Grades (ohne Integration). Eine anspruchsvolle Kurvendiskussion kann mit den abgedruckten Programmen nicht durchgeführt werden. Ähnlich verhält es sich auch mit den diversen Ableitungs- und Integrationsprogrammen, die jeweils nur recht uninteressante und zudem leichte Einzelfälle behandeln. Und auch die Programme, die sich mit der Matrizenrechnung beschäftigen, decken nur einen kleinen Bereich ab. Und schließlich sei zu den begleitenden Texten gesagt, daß sie viel zu kurz und, oberflächlich sind.

Langer Rede kurzer Sinn: Die 28 Mark wären bei einer Mathematiknachhilfe besser angelegt.

(Boris Schneider)

Info: J. Merget, Mathe für die Oberstufe, IWT-Verlaq 1984, 150 Seiten, 28 Mark.

# Vergleichstest: 7 Dateiverwaltungen auf einen Blick [118-120,122-123]

> Daten zu verwalten gehört neben der Textverarbeitung zum Hauptanwendungsgebiet eines Computers. Um Ihnen eine Übersicht zu vermitteln, stellen wir die sieben bekanntesten Programme vor.

In diesem Kurzvergleich können unmöglich alle Einzelfunktionen sämtlicher Produkte aufgeführt werden. Einige Grundfunktionen (wie zum Beispiel das Eingeben, Ändern, Löschen und Ausgeben von Datensätzen) werden deshalb als selbstverständlich vorausgesetzt. Im wesentlichen wird jedoch gezielt auf solche Besonderheiten einzelner Produkte hingewiesen, die nicht gleichermaßen zum Standard gehören.

## Datamat

Bereits im August '83 ist die erste Version von Datamat (aus dem Haus Data Becker) auf den Markt gekommen. Laut Data Becker soll dieses Programm bereits 15 000 mal im Einsatz sein, was sicher auch auf den recht günstigen Preis zurückzuführen ist.

Die hier getestete neue Version (sie wird seit zirka August 1984 ausgeliefert) ist gegenüber der alten sowohl um einiges schneller geworden (durch Programmierung in Maschinensprache) als auch besser gegen Abstürze gesichert. Mit der alten Version erstellte Masken und Dateien können übernommen werden. Die Pointer-, Auswertungs- und Indexdatei müssen jedoch erneuert werden.

Durch ein gut gegliedertes deutsches Handbuch und eine komfortable Menüsteuerung wird auch der Einsteiger zum Erfolgserlebnis kommen (Bild 1).

Generell in allen Programmteilen gilt:
F1-Taste = Auslösetaste (wie RETURN)
F2-Taste = Abbruch (letztes Menü)
Leertaste = Springen im Menü

Die Erstellung von Masken ist einfach und problemlos. Die minimale Feldlänge von zwei Zeichen gestattet leider keine Definition von einstelligen Feldern. Dagegen ist es

sehr angenehm, daß pro Satz bis zu 50 Felder definiert werden können. Die Anzahl der möglichen Datensätze hängt von der Länge des Indexfeldes und der Länge des einzelnen Satzes (maximal 2000) ab. Das Progamm bietet umfangreiche Suchfunktionen:

* Schnelles Suchen über das Indexfeld
* Suchen über Index mit Joker (Name = M*)
* Suchen nach beliebigen Kriterien

Bei der letzten Funktion sind mehrere Kriterien kombinierbar. Es kann auch jedem Suchfeld ein Vergleichsoperator wie gleich, kleiner, größer, kleiner gleich, größer gleich, ungleich zugeordnet werden. Interessant gelöst ist auch der Intervall-Vergleich von — bis, bei dem mit zwei Bildschirmebenen gearbeitet wird. Die ausgewählten Datensätze können mehrstufig umsortiert werden (Pointer-Datei als Hilfsdatei). Die Ergebnisse sind am Bildschirm leider nur einzeln abzurufen, können jedoch als frei definierbare Liste verdichtet auf Drucker ausgegeben werden. Diese Listengestaltung ist sehr komfortabel. Durch horizontales Verschieben wird das Listenformat auch am Bildschirm als ganzes erkennbar. Für jede beliebige Spalte kann außerdem eine Summenbildung durchgeführt werden.

Über die Menüpunkte »Datei auswerten« und »Floppy« kann eine Datei mit neuer Feldanordnung erzeugt werden, die dann mit einem Textverarbeitungsprogramm weiterverarbeitet werden kann. Wie bei der Textverarbeitung ist auch bereits im Datamat ein deutscher Zeichensatz wählbar.

## Datenmanager 64

Die deutsche Beschreibung ist leider genauso dürftig wie man es von Commodore-Handbüchern eben gewohnt ist. Sie umfaßt ganze 19 Seiten. Zum Glück ist das Produkt selbst besser. Nach dem Start erscheint ein umfangreiches Menü (Bild 2). Die Auswahl erfolgt durch Eingabe des jeweiligen Anfangsbuchstabens. Auch ohne Menü kann im weiteren jederzeit ein Kommando direkt gegeben werden oder mit »H« (Help) zum Menü gesprungen werden.

Zum Aufbau einer Datei werden zunächst alle Felder (maximal 10!) des Datensatzes definiert: Feldname, Länge (maximal 79), Typ (a/n = alphanumerisch/numerisch), Index Ö/n). Es sind maximal drei Indexfeldermöglich. Auf die Feldanordnung in der Eingabemaske hat man keinen weiteren Einfluß, sie erfolgt automatisch zeilenweise. Die Datei mit maximal 1000 Sätzen kann auch über mehrere Disketten verteilt werden.

Das Programm bietet neben dem Suchen über eines der Indexfelder auch die Möglichkeit, nach mehreren Kriterien auszuwählen (UND-Verknüpfung). Hinter dem Suchbegriff kann auch ein logischer Operator wie kleiner, größer, gleich angegeben werden. Eine Sortierung ist nur über eines der Indexfelder möglich. Durch entsprechende Voreinstellung im Menüpunkt »Parameter« ist auch die Ausgabe von geordneten Listen oder die Erstellung von Adreßaufklebern möglich. Interessant ist der Änderungsmodus für numerische Felder: Neben Überschreiben ist hier auch die Änderung um einen absoluten Wert oder eine prozentuale Änderung möglich, zum Beispiel Stück: + 20 (Zubuchen zum Lagerbestand ohne Kopfrechnen) oder Preis: +3% (Erhöhung des gespeicherten Preises).

Der Datenmanager besitzt außerdem eine einfache, integrierte Textverarbeitung mit einer maximalen Zeilenlänge von 60 Zeichen und einer maximalen Textlänge von zirka vier Schreibmaschinenseiten. Mit »’« können auch Felder zur Erstellung von Serienbriefen definiert werden.

## Datei 64

Die Programmdiskette wird ohne Handbuch nur mit zwei Seiten Kurzinformation ausgeliefert. Nach dem Laden des Programms erscheint der sogenannte »Hauptverteiler«, ein auf die Funktionstasten abgestimmtes Menü (Bild 3). Mit der Fl-Taste bekommt man eine äußerst knappe Erklärung der Programmbedienung. Zwei Maskendefinitionen werden bereits mitgeliefert, eine Anschriftenverwaltung und ein Bücherarchiv. Möchte man eine eigene Anwendung erstellen, so ist zunächst ein Datensatz zu definieren:

Feldnamen, Eingabeart (alpha, Betrag, Datum etc.) und Feldlänge. Bei Datums- und Uhrzeitfeldern wird sogar eine Plausibilitätskontrolle durchgeführt.

Danach muß für jedes Feld die genaue Position festgelegt werden. Außerdem können noch Überschrifts- und Titelzeilen definiert werden. Bevor die Dateneingabe beginnt, wird eine Arbeitsdiskette erstellt.

Am Beispiel des Bücherarchivs sollen nun die Möglichkeiten dieses Programms kurz erläutert werden. Im Datensatz sind die Felder Buchtitel, Autor, Sachgebiet, Stichworte und Archivnummer gespeichert. Um einen Satz wiederzufinden, muß erst angegeben werden, nach welchem Feld gesucht werden soll, zum Beispiel (B) = Autor. In die dann erscheinende Zeile wird der Name eingegeben. Für die Suche kann auch ein Intervall von — bis vorgegeben werden. Die Ergebnisse lassen sich einzeln oder als Liste ausdrucken. Eine Gesamtliste kann auch nach einem bestimmten Feld sortiert werden. Für die Liste lassen sich bestimmte Felder unterdrücken, für jede Spalte ist auch eine Summenbildung möglich.

## SM-Adreva/64

Das Programm wird mit einer kurzgefaßten deutschen Beschreibung, leider ohne Stichwortverzeichnis, ausgeliefert. Dafür wird jedoch neben der rein verbalen Beschreibung sehr schön in kleinen Ablaufplänen die logische Reihenfolge von Funktionstasten und Dateneingaben erläutert, so daß sich auch der Anfänger gut zurechtfindet. Aus dem Start-Menü lassen sich zunächst Commodore- oder deutsche Tastatur, die Druckparameter und die Farbeinstellungen wählen. Danach kann die Adreßeingabe beginnen.

Die fest definierte Maske (Bild 4) enthält neben den üblichen Adreßzeilen noch die Felder Kunden-Nummer (3-stellig), Suchbegriff (10-stellig), Telefon- und Telex-Nummer, sowie fünf weitere Zusatz-Textzeilen.

Am unteren Bildschirmrand ist während der gesamten Verarbeitung die jeweilige Funktionstastenbelegung eingeblendet, zum Beispiel speichern, löschen, drucken, Programmende.

Erfaßte Adressen können über die Kunden-Nummer oder über den Eintrag im Feld »Suchbegriff« wiedergefunden werden. Von einem gefundenen Satz kann man jeweils vor- und zurückblättern.

Der Ausdruck einer Adresse ist fest definiert und gibt jedes Feld in einer neuen Zeile aus. Standardmäßig können auch Adreßlisten oder Adreßaufkleber erstellt werden. Dabei ist die Auswahl über Kunden-Nummer (von-bis) oder Suchbegriff (von-bis) möglich.

Die Ausgabe erfolgt in der entsprechenden Sortierung.

SM-Adreva/64 kann kombiniert werden mit der Textverarbeitung SM-Text/64. Der mit der Textverarbeitung erstellte Brief kann dann Kürzel enthalten, für die die entsprechenden Daten aus der Adreßverwaltung übernommen werden. Damit lassen sich auf einfache Weise auch Form- und Serienbriefe erstellen.

SM-Adreva/64 ist ein Programm, das zwar speziell auf die Adreßverwaltung zugeschnitten ist, das aber dafür durch gute Benutzerführung besonders einfach zu bedienen ist.

## SM-ISM/64

Bereits beim Lesen des umfangreichen Handbuchs wird klar, daß das Produkt ISM/64 (Index Sequential File Manager) sich nicht ohne weiteres für den Anfänger eignet. Um all die vielfältigen Möglichkeiten zu nutzen, muß man schon tiefer einsteigen. Dem Profi dagegen wird bereits jetzt das Herz höher schlagen. ISM/64 ist vollständig in 6502-Maschinensprache geschrieben und läuft außer auf dem C 64 auch auf dem 8032 und 8096 von Commodore. Hier zunächst einige wesentliche Eigenschaften:
* variable oder feste Satzlänge von 2 bis 31875 Byte
* bis zu 125 Felder pro Satz
* Felder fester oder variabler Länge
* Feldlänge maximal 255 Byte
* maximal 40 Schlüsselfelder
* Schlüssel können auch nachträglich definiert oder gelöscht werden. — Schlüssel können eindeutig oder mehrdeutig sein.
* maximal 10 ISM-Dateien können dem Programm gleichzeitig zur Verfügung gestellt werden.
* ISM kann auch in ein Basic-Programm eingebunden werden.

Insgesamt wird nach diesem Leistungsumfang deutlich, daß es sich bei ISM/64 bereits mehr um eine datenbankorientierte Programmiersprache handelt.

Wer sich zunächst überfordert fühlt, dem sei empfohlen, das mitgelieferte Beispiel-Programm »Literaturverwaltung« durchzuspielen, um mit ISM/64 vertraut zu werden. Der verwendete Datensatz besteht aus zehn Feldern: ISBN-Nummer, Autor, Titel, Buchart, Inhalt, Verlag, Jahr, Ort, Preis, Signatur. Die ISBN-Nummer ist dabei als eindeutiger Schlüssel, Autor und Titel sind als mehrdeutige Schlüssel definiert. Aus den Menüs wird Bearbeiten (bb), Anlegen (a) und Neuschreiben (n) ausgewählt, danach können Daten eingegeben werden.

Mit »1« wird die Funktion Lesen aufgerufen. Über den vollen oder verkürzten Schlüssel wird auf die eingegebenen Sätze zugegriffen.

Mit »z« kommt man jederzeit zum Hauptmenü zurück. Ein gefundener Satz kann direkt geändert oder gelöscht werden.

Alles in allem ist ISM/64 ein mächtiges Progammpaket, das in diesem Rahmen gar nicht m allen Einzelheiten aufgezeigt werden kann, das aber auch sehr hohe Anforderungen an den Anwender stellt, sofern er damit komplexere Lösungen realisieren möchte.

Superbase 64 wurde bereits in einem früheren Test als »Super-Datenbank« eingestuft (64'er 5/84). Der einzige Wunsch, der damals unbefriedigt blieb, war der nach einem deutschen Handbuch. Hier wurde Abhilfe geschaffen und zwar in bester Weise. Das Superbase-Handbuch verdient ein besonderes Lob. Die Unterteilung in Übungsteil, Nachschlageteil und Programmierteil schafft für den Anfänger wie für den Programmier-Profi die richtige Einstiegsmöglichkeit.

## Superbase 64

Das Programm selbst bietet eine sehr angenehme menügesteuerte Benutzerführung. Neben den Standard- HELP-Funktionen sind sogar eigene HELP-Masken zusätzlich definierbar. Eine weitere Besonderheit: ein Datensatz (maximal 1108 Zeichen) kann auf vier Bildschirmseiten verteilt werden. Pro Satz sind maximal 127 Felder inklusive Schlüsselfeld (maximal 30 Zeichen) zulässig. Normale Textfelder können 255 Zeichen enthalten. Insgesamt können bis zu 15 Einzeldateien zu einer Superbase-Datenbank zusammengeschlossen werden.

Die Erstellung von Bildschirmmasken ist einfach und übersichtlich. Durch Invertieren und Kolorieren läßt sich ein ausgezeichnetes Bildschirm-Layout erzeugen. Beim Erfassen größerer Datenmengen ist die implementierte Duplizierfunktion sehr hilfreich. Die größten Stärken von Superbase 64 kommen jedoch erst bei den Datenbankabfragen und -auswertungen. Neben dem Zugriff über das Schlüsselfeld kann auch mit Joker oder über Matchcode gesucht werden. Auch ein feldunabhängiger Vergleich ist möglich.

Darüber hinaus können über die SELECT-Funktion Abfragen mit kompliziertesten UND- beziehungsweise auch ODER-Verknüpfungen gestellt werden, verbunden mit Vergleichsoperatoren (größer, kleiner, ungleich und andere). Die Ergebnisse solcher Abfragen können m komprimierter Form (zum Beispiel

eine Zeile pro Datensatz nur mit bestimmten Feldern) sowohl auf Bildschirm wie auf Drucker ausgegeben werden. Natürlich lassen sich ausgefilterte Ergebnisse auch beliebig umsortieren. Solche Daten kann man mit der Funktion »EXPORT« als sequentielle Datei an andere Programme übergeben. Umgekeht lassen sich mit der Funktion »IMPORT« Daten aus anderen Programmen übernehmen.

Superbase 64 selbst besitzt neben den Datenbank-Funktionen noch umfangreiche Kalkulationsmöglichkeiten. Damit können einzelnen Feldern Rechenformeln zugewiesen werden, wie dies bei reinen Kalkulationsprogrammen (Spreadsheet-Anwendungen) möglich ist. Damit läßt sich ohne weiteres bereits innerhalb von Superbase 64 eine komplette Fakturierung programmieren. Diese zusätzlichen Möglichkeiten eröffnen ein breites Anwendungsgebiet, das weit über reine Datenbank-Funktionen hinausgeht.

**Vizastar 64** wird mit einem umfangreichen, gut gegliederten Handbuch, Diskette und Steckmodul ausgeliefert. Es ist ein integriertes Paket, das folgende drei Komponenten beinhaltet: Tabellenbearbeitung, Dateiverwaltungssystem und Grafikauswertung.

Im Rahmen dieses Vergleichs wird vor allem die Datenbankverwaltung genauer untersucht. Eine Vizastar-Datenbank ist eine Sammlung von bis zu 15 Dateien. Ein Datensatz kann bis zu 8000 Zeichen beinhalten und sich über neun »Bildschirmkarten« erstrecken. Die maximale Feldlänge beträgt 120 Zeichen.

Alle Vorgänge sind menügesteuert (SPACE-Taste zum Weiterspringen, mit RETURN ausführen). Mit der EXEC-Funktion können aber auch ganze Befehlssequenzen vorprogrammiert werden.

## Vizastar 64

Die Datensatzfelder werden im elektronischen Arbeitsblatt festgelegt, jedem Feld wird ein Buchstabencode zugeordnet (A-BL). Es kann ein Schlüsselfeld mit 30 Zeichen Länge definiert werden, außerdem Formelfelder und beliebige Datenfelder (maximal 120 Zeichen). Mit ADD, REPLACE und DELETE werden Datensätze eingegeben, geändert oder gelöscht. Der Zugriff erfolgt über den Schlüssel (KEY) oder über andere Kriterien (DATA USE CRITERIA), die einfach in die Felder eingegeben werden (inklusive Vergleichsoperatoren oder Joker). Mit dem Befehl DATA TRANSFER lassen sich Daten zwischen elektronischem Arbeitsblatt und Datensatz austauschen. Mit EXPORT können Daten an andere Programme wie zum Beispiel die Textverarbeitung Vizawrite 64 übergeben werden, umgekehrt mit IMPORT. Mit REPORT und RANGE lassen sich beliebige Felder für den Listenausdruck zusammenstellen.

Neben der Datenbank-Komponente verfügt Vizastar 64 über eine sehr leistungsfähige Tabellenbearbeitung inklusive Invertierung und Window-Technik. Der Grafikteil umfaßt standardmäßig Balken- und Liniendiagramme. Mit einem Grafik-Zusatzprogramm sind farbige Kuchengrafik und 3D-Balkengrafik möglich.

Insgesamt bietet Vizastar 64 eine Vielzahl von Möglichkeiten mit angenehmer Benutzerführung in allen Programmteilen.

Ein derartiger Vergleich unterschiedlichster Datenbanksysteme kann als Ergebnis sicher keinen eindeutigen Favoriten oder Verlierer präsentieren. Er kann nur gleichzeitig über mehrere Produkte Informationen liefern, die dem einzelnen Interessenten die Möglichkeit geben, systematisch zu untersuchen, was für seinen speziellen Anwendungsfall überhaupt in Frage kommt. Gewisse Mindestvoraussetzungen müssen sicher erfüllt sein, damit sich ein Problem mit einem dieser Produkte überhaupt lösen läßt, daneben sollte natürlich ein vernünftiges Preis-Leistungsverhältnis Berücksichtigung finden. Weitere Angaben entnehmen Sie bitte der Tabelle.

(Peter Häuslein/gk)

Bezugsquellennachweis:
Commodore, Lyonerstr.38, 6000 Frankfurt 71 (Datenmanager)
Data Becker, Merowingerstr.30,4000 Düsseldorf 1 (Datamat, Superbase)
Dynamics, Große Bäckerstr. 11, 2000 Hamburg 1 (Datei 64) Interface Age, Josefsburgstr.6, 8000 München 80 (Vizastar) für Schweiz: Microtron, Brunnenweg 5, CH-2542 Pieterlen (Vizastar)
SM Software AG, Scherbaumstr.33, 8000 München 8 (SM-Adreva, SM-ISM)

# Promal — Die neue Sprache für Profis? [124-125]

> Wir testeten eine brandneue Programmiersprache für den Commodore 64. Promal kommt direkt aus Amerika und ist schnell wie Forth, aber übersichtlich wie Pascal.

Die Programmiersprachen für den Commodore 64 häufen sich, und so vergeht kaum ein Monat, an dem nicht irgendein Hersteller ein neues Produkt als »Die Sprache für den Commodore 64« anpreist. Meistens handelt es sich dann doch aber nur um mehr schlechte als rechte Implementationen altbekannter Sprachen, die vielleicht noch auf die Grafik- und Soundfähigkeiten des C 64 Rücksicht nehmen.

Ein ganz neues Produkt ist dagegen die Sprache Promal, die erst letztes Jahr entwickelt wurde und nun als erstes in einer Version für den C 64 lauffähig vorliegt. Weitere Versionen für Apple- und IBM-Computer sind in Arbeit. Da Promal-Programme auch zwischen verschiedenen Computern austauschbar sind, solange nicht auf die Maschinenebene zugegriffen wird, dürfte daher bald ein breites Software-Angebot zur Verfügung stehen.

## Was ist Promal?

Promal ist die Abkürzung für **Pro**grammers **M**icro **A**pplications **L**anguage und hat überhaupt nichts mit Comal zu tun. Promal bietet die Möglichkeit, strukturiert zu programmieren, ja erzwingt dieses ähnlich wie Pascal sogar, ist dabei aber gleichzeitig so schnell und maschinennah wie Forth.

Promal besteht aus drei Teilen: Dem Executive, dem Editor und dem Compiler. Der Executive ist ähnlich einem Interpreter organisiert und enthält den Kern von Promal sowie die Input/Output-Routinen und die Befehle, die direkt ausgeführt werden können. Über den Executive tritt der Benutzer mit dem Promal-System in Verbindung. Editor und Compiler werden vom Executive aus aufgerufen. Eine Programmierung in Promal ist über den Executive nicht möglich, wohl aber lassen sich bereits compilierte Programme starten. Es können mehrere Programme gleichzeitig im Speicher stehen: Promal-Programme sind vollkommen relokatibel (im Speicher verschiebbar) und können so jederzeit zu den schon im Speicher stehenden Programmen hinzugeladen werden. Der Aufruf eines Programmes erfolgt einfach durch die Nennung seines Namens. Befindet sich das entsprechende Programm nicht im Speicher, wird es automatisch nachgeladen.

Die Bedienung des Executive ist äußerst komfortabel: So sind zum Beispiel die Funktionstasten belegt, und es lassen sich schon einmal gemachte Befehls-Eingaben mittels Tastendruck zum Korrigieren wiederholen.

## Komfortabler Editor

Soll nun ein neues Promal-Programm geschrieben werden, dann wird zunächst der Editor aufgerufen. Es handelt sich dabei schon fast um ein kleines Textsystem mit horizontalem Scrolling (80 Zeichen pro Zeile), schnellem vertikalem Scrolling in beide Richtungen, Funktionstastenbelegung, ausführlichem Befehlssatz und vielen anderen Details. Hat man eine Weile mit diesem schnellen und komfortabeln Editor gearbeitet, so ist man recht erstaunt, wenn man im Handbuch liest, daß er vollständig in Promal geschrieben wurde. Der Editor ist somit eines der besten Beispiele für die Leistungsfähigkeit von Promal.

Ebenso in Promal geschrieben ist der Compiler. Es kann wahlweise auf Diskette oder im Speicher compiliert werden. Auch hier erstaunte die enorme Geschwindigkeit, zumindest solange keine Diskettenzugriffe notwendig sind.

Wie sieht nun so ein Promal-Programm aus? Auf den ersten Blick glaubt man, es mit einer Mischung aus Pascal und Basic zu tun zu haben. Es gibt keinerlei Zeilennummern, aber Einrückungen. In jeder Zeile steht nur ein einziger Befehl. Zu Anfang eines jeden Promal-Programmes steht ein Deklarationsteil, in dem alle Variablen, Funktionen und Prozeduren (Unterprogramme) ähnlich wie in Pascal definiert werden müssen.

Es gibt sehr viele veschiedene Kontrollstrukturen: Neben dem obligatorischen IF... ELSE (ohne THEN!) oder FOR (ohne NEXT) gibt es auch WHILE, REPEAT...UNTIL, und sogar ein CHOOSE, das in etwa dem ON...GOTO (Basic) oder dem CASE (Pascal) entspricht, aber noch flexibler ist.

## Bitte einrücken!

Wer sich fragt, wo das NEXT oder das THEN hin verschwunden sind: Promal zwingt zu strukturiertem Programmieren, weil Einrückungen syntaktische Bedeutung haben! Eine IF..THEN..ELSE-Abfrage muß in Promal folgendermaßen programmiert werden:

TODO

IF <Bedingung>
befehll befehl2
befehlN
ELSE
befehll befehl2
befehlN befehll befehl2
...

Wichtig ist, daß die Befehlsgruppen, die bedingt ausgeführt werden sollen, um zwei Stellen eingerückt werden. Der Promal-Compiler nimmt an, daß die IF...ELSE-Anweisung zu Ende ist, wenn Befehle nicht mehr eingerückt sind.

Dieses Prinzip gilt auch für alle anderen Kontrollstrukturen. Die aus Basic bekannten FOR-NEXT-Schleifen benötigen in Promal kein NEXT mehr, das Schleifenende wird am Fehlen der Einrückung erkannt. Promal kennt allerdings einen Befehl NEXT, der aber eine andere Bedeutung hat. Mit ihm kann an den Anfang der gerade bearbeiteten Schleife zurückgesprungen werden. Dies funktioniert nur bei REPE-AT...UNTIL und WHILE, nicht bei FOR. Das genaue Gegenteil von NEXT ist BREAK. Mit diesem Befehl wird die gerade bearbeitete Kontrollstruktur ordnungsgemäß abgeschlossen und verlassen, es erfolgt sozusagen ein GOTO zur nächsten nicht eingerückten Zeile.

Natürlich können Kontrollstrukturen auch beliebig ineinander geschachtelt werden, dann sind halt mehr Einrückungen notwendig.

Promal kennt vier verschiedene Variablentypen: BYTE, INTeger, WORD und REAL. String-Variablen sind nicht vorgesehen, man muß sich, ähnlich wie in Forth, mit Adreßvariablen behelfen. Das bedeutet, man legt einen String als Bytefolge irgendwo im Speicher ab und weist die Anfangsadresse des Strings einer Variablen zu. Über diese Variable kann man dann im weiteren jederzeit auf den String zugreifen.

Das mag auf den ersten Blick etwas umständlich erscheinen, ist aber in der Praxis sehr flexibel und schnell, insbesondere, da es von einigen Promal-Standardprozeduren unterstüzt wird.

An Feldvariablen sind nur eindimensionale Arrays erlaubt. Doch damit läßt sich bereits eine ganze Menge anfangen. Arrays können nämlich an jedem vom Programmierer vorgesehenen Speicherplatz abgelegt werden. Beispielsweise kann man ein solches Array auf den Bildschirm-Speicherbereich legen. Durch einfache Zuweisung von Werten an Array-Elemente wird dann jedesmal die entsprechende Speicherstelle im Bildschirm angesprochen. Dabei ergibt sich neben einer besseren Übersichtlichkeit des Programmes auch noch ein Zeitgewinn.

## Verbesserte Fließkomma-Arithmetik

Im Gegensatz zu vielen anderen Programmiersprachen für den C 64 wurde bei der Fließkomma-Arithmetik in Promal nicht auf die bereits im Basic-ROM vorhandenen Routinen zurückgegriffen. Promal verfügt über eine völlig neue Fließkomma-Arithmetik, die die des Commodore 64-Basic bei weitem übertrifft. REAL-Variablenhaben 11 signifikante Stellen (9 bei Basic), dennoch erfolgen alle Berechnungen damit fast doppelt so schnell. Damit ist die reine Ausführungszeit der Rechenoperation gemeint. Da Promal-Programme immer compiliert werden, ist die tatsächliche Geschwindigkeit von Programmen noch um ein Vielfaches höher.

Allerdings kennt Promal nur die vier Grundrechenarten und logische Operationen. Funktionen wie Sinus oder Logarithmus werden als Promal-Source-Code mitgeliefert. Nach der Compilation sind diese in Promal geschriebenen Routinen immer noch genauer und sogar ein wenig schneller als die Original-Commodore-ROM-Routinen, was wohl ein beeindruckender Beweis der Leistungsfähigkeit von Promal ist.

Wer in einem Programm ohne REAL-Zahlen auskommt, kann die REAL-Arithmetik vollständig aus Promal entfernen und gewinnt so zusätzlich wertvollen Speicherplatz. Compilate (übersetzte Programme) können so einen Umfang von bis zu 35 KByte haben. Der Source-Code muß dann allerdings mit einigen Tricks geschrieben werden, da der garantiert nicht in den Speicher paßt. Der Compiler selbst umfaßt beispielsweise als Sorce-Code 2400 Zeilen, benötigt aber compiliert nur noch 13 KByte.

Überzeugend ist auch das Konzept der Prozeduren und Funktionen. Pascal-Kennerwissen, daß Prozeduren das Gegenstück zu Unterprogrammen sind, und daß Funktionen ein spezieller Typ von Prozeduren sind, die Parameter an das Hauptprogramm zurückgeben. Wie in Pascal können Prozeduren und Funktionen lokale Variable haben, das sind Variable, die nur der Prozedur bekannt sind, und deswegen gleiche Namen wie völlig andere Variablen im Hauptprogramm haben dürfen, ohne daß Konflikte oder Fehler auftreten.

In Promal gibt es noch eine Unterscheidung bei lokalen Variablen: Diese können bei Bedarf ihren Inhalt bis zum nächsten Aufruf der Prozedur behalten. Eine Prozedur kann also beispielsweise zählen, wie oft sie hintereinander aufgerufen wurde. Dies ist sehr wichtig, will man rekursive Funktionen programmieren. Rekursion bedeutet, daß eine Prozedur oder Funktion sich selbst aufruft und ist in Promal beliebig erlaubt. Allerdings ist die Rekursionstiefe auf zirka 40 Aufrufe beschränkt, sonst läuft der Prozessorstack über, und das System befindet sich in einem »undefinierten Zustand«, etwas weniger fein auch als »Absturz« bezeichnet.

## Schnittstelle zur Maschinensprache

Obwohl Promal bereits unglaublich schnell ist, hat man trotzdem mehrere Schnittstellen zur Maschinensprache eingebaut, um eigene Maschinenroutinen oder solche aus dem Basic-ROM in Promal-Programme zu integrieren. Dabei ist sogar die Kontrolle über die Prozessorregister (A, X, Y und P) von Promal aus vorgesehen. Parameterübergabe kann über gemeinsam benutzte Speicherstellen, die Prozessorregister oder am aller einfachsten über den Prozessorstack erfolgen. Damit ist Promal fast genauso maschinennah wie Forth, aber dafür um einiges komfortabler.

Die drei mitgelieferten Handbücher, wie üblich in Englisch, umfassen 250 DIN A4-Seiten und bieten eine umfassende Einführung in die Sprache. Da hier sehr viel mit Beispielen gearbeitet wird, fällt es leicht, sich in das Promal-Konzept einzuarbeiten.

## Vorbildliche Dokumentation

Eines sei noch zur Erhältlichkeit von Promal gesagt: Es gibt drei verschiedene Promal-Versionen, die aber aufwärtskompatibel sind. Die Demo-Version umfaßt den kompletten Sprachschatz und unterscheidet sich von der End-User-Version nur dadurch, daß sie keine Druckerausgabe und kein Abspeichern von Programmen auf Diskette erlaubt. Sie ist also sozusagen nur zum »Reinschnuppern« gedacht. Dafür darf, ja soll sie sogar kopiert und an Freunde weitergegeben werden. Wer interessiert ist, kann sich dann die End-User-Version beim Hersteller kaufen und mit dem Programmieren voll loslegen. Dieses Konzept kann man anderen Anbietern von Software sicher nur zur Nachahmung empfehlen, da der Anwender die oftmals recht teuren Programme dann nicht mehr »auf Verdacht« kaufen muß, um erst hinterher enttäuscht festzustellen, daß das Programm nicht seinen Erwartungen entspricht. Für die Produzenten wirklich guter Software hätte dieses Verfahren ebenfalls nur Vorteile — der Bekanntheitsgrad erhöht sich, der Anwender kann sich ein Bild von der Qualität der Software machen.

Doch wieder zurück zu Promal. Die geschriebenen und compilierten Programme benötigen immer noch den Promal-Executive-Teil, um lauffähig zu sein. Deswegen gibt es noch eine »Developer’s-Version«, die zusätzlich den Promal-Kern in die übersetzten Programme einbindet, so daß sie auch ohne Promal laufen können.

Zum erstenmal gibt es mit Promal eine maschinennahe und dennoch einfache und komfortable Sprache für Mikrocomputer. Jedem, dem Forth zu unverständlich und Pascal zu langsam ist, kann Promal nur empfohlen werden, denn diese Sprache verbindet sozusagen diese zwei Programmierwelten miteinander.

(Boris Schneider/ev)

Info: Promal ist in den verschiedenen Versionen erhältlich bei Systems Management Associates, 3700 Computer Drive, PO.Box 20023, Raleigh, North Carolina N.C 27619, USA.

# Forth-wärts mit M&T-Forth 64 [126]

> Inzwischen gibt es fast schon so viele Forth-Versionen für den Commodore 64 wie Basic-Erweiterungen. Gerade neu auf dem Markt ist eine Version, die sich strikt an den FIG-Standard hält und damit völlige Software-Kompatibilität verspricht.

Forth hat in der letzten Zeit einen enormen Bekanntheitsgrad erreicht. Was vor einem Jahr noch ein Geheimtip unter Insidern war, liegt jetzt von den vielen Herstellern in den verschiedensten Ausführungen vor. Das grundlegende Konzept der Programmiersprache Forth ist von uns schon in früheren Ausgaben erläutert worden, daher seien an dieser Stelle nur noch einmal die wichtigsten Unterschiede zu Basic stichwortartig angesprochen:

Forth ist eine sehr maschinennahe Sprache, deren grundlegendes Prinzip der Stack ist. Alle Berechnungen werden grundsätzlich in der Weise ausgeführt, daß zunächst die Operanden auf den Rechenstack gebracht werden und anschließend erst die gewünschte Operation ausgeführt wird (ähnlich wie bei Taschenrechnern mit der »umgekehrten polnischen Notation« UPN). Eine Addition schreibt sich damit so:
5 7 +

Programmierung in Forth besteht darin, neue Worte zu definieren, die bestimmte Funktionen ausführen.
Beispiel:

ADD1 1 +

Eine Wortdefinition beginnt mit einem Doppelpunkt und endet mit einem Semikolon. Hinter dem Doppelpunkt folgt der Name des neuen Wortes, im Beispiel also »ADDl«. Anschließend folgen die Befehle (Worte) die beim Aufruf von ADDl ausgeführt werden sollen. ADDl schiebt also die Zahl Eins auf den Stack und führt anschließend eine Addition durch. Im Endeffekt wird also der vor dem Aufruf von ADDl auf dem Stack befindliche Zahlenwert um eins erhöht. In analoger Weise kann man ganze Programmsysteme aus immer leistungsfähigeren Forth-Worten aufbauen. Forth arbeitet ausschließlich mit Integer-Zahlen. Das führt im Zusammenhang mit der Compilation aller Eingaben zu sehr effizienten Programmen.

Das neueste Kind auf dem Forth-Markt ist eine Version der Markt & Technik Verlags AG. M&T-Forth 64 hält sich, soviel sei hier schon gesagt, strikt an den Semi-Standard der Forth-Interest-Group (FIG). Natürlich finden sich hier sehr viele Befehle, die auf den C 64 zugeschnitten worden sind. Insgesamt umfaßt das Grundvokabular von M&T-Forth 64 rund 280 Worte. Dazu kommen dann einzelne auf der Programmdiskette mitgelieferte Programme, die ja bei Forth nichts anderes als Befehlserweiterungen sind.

M&T-Forth 64 arbeitet wahlweise mit Kassette und Diskette zusammen. Das Prinzip des virtuellen Speichers, das heißt, daß sich alle »Screens« (Textabschnitte) auf der Diskette befinden, wurde hier aus Geschwindigkeitsgründen nicht angewandt.

## 24-KByte-RAM-Floppy

M&T-Forth 64 simuliert vielmehr eine RAM-Disk, die 40 Screens von jeweils 16 Zeilen ä 38 Zeichen enthält. Diese RAM-Disk kann jederzeit auch teilweise auf Kassette oder der echten Diskette gesichert werden. Ebenso sind schon compilierte Spracherweiterungen lad- und speicherbar. Bei Diskettenbetrieb lassen sich auch Directories listen oder der Fehlerkanal lesen und schreiben. Da außerdem Befehle wie OPEN und CLOSE im Sprachkern eingebaut wurden, kann auch eine Druckerausgabe recht einfach erfolgen.

Alles was nicht in den Sprachkern von Forth gehört, wurde konsequent auf die Programmdiskette ausgelagert. Dazu gehören der Forth-Assembler, der Zeileneditor sowie Grafik- und Sound-Befehlserweiterungen. Diese werden ja nicht ständig benötigt, und würden sonst immer nur Platz im Computer wegnehmen. Das Nachladen des Editors mag am Anfang etwas umständlich wirken, hat dann aber den Vorteil, daß er vom Benutzer jederzeit erweitert oder völlig umgebaut werden kann, ohne den Sprachkern verunstalten zu müssen.

Daß Forth recht maschinennah und somit schnell ist, ist allgemein bekannt. Trotzdem enthalten viele gute Forth-Systeme Schnittstellen zur Maschinensprache und sogar einen Assembler. Ebenso verhält es sich bei M&T-Forth 64. Der mitgelieferte Assembler hat den Vorteil, daß in Assembler strukturiert programmiert werden kann. Zeitkritische Aufgaben können somit elegant und übersichtlich realisiert werden. Zusätzlich zum Assembler wird auch ein Forth-Monitor mitgeliefert. Dieser Mini-Monitor kann es zwar nicht mit dem SMON aufnehmen, leistet aber sehr gute Dienste, wenn man unter Forth schnell mal eine Möglichkeit braucht, »direkt an die Maschine« zu gehen.

## Integrierter Assembler

Der mitgelieferte Editor ist dagegen recht spartanisch. Es ist ein einfacher Standard-Zeileneditor, wie ihn fast jede Forth-Version enthält. Ein komfortabler Full-Screen-Editor wäre zwar wünschenswert, doch läßt sich mit dem Zeileneditor auch recht gut arbeiten, insbesondere, da Forth ja keine Sprache ist, bei der man drauflosprogrammieren kann.

Sehr interessant sind die mitgelieferten Grafik- und Sound-Befehle für Forth. Da ist zum Beispiel ein einfacher Spriteeditor, (in Forth gerade 11 Zeilen lang) vorhanden.

Der Grundbefehlssatz wurde absichtlich klein gehalten, damit der Endbenutzer sich die zusätzlichen Befehle an seine individuelle Anwendung anpassen kann, ein in Forth ja ganz natürlicher Vorgang.

Eine Reihe von mitgelieferten zusätzlichen Beispielprogrammen, darunter das Nicht-Standard-Wort CASES, das trotzdem gerne verwendet wird, runden das Gesamtbild des M&T-Forth 64 ab.

## Fazit

Insgesamt gesehen liegt mit M&T-Forth 64 eine Forth-Version vor, die zwar nicht durch enorme Befehlsvielfalt glänzt, wie andere Versionen dieser Sprache, dafür aber eine umso solidere Basis für Eigenentwicklungen ist. Da der FIG-Standard strikt eingehalten wird, dürfte die Anpassung von schon geschriebenen Forth-Programmen überhaupt keine Probleme aufwerfen. Alles in allem also eine Forth-Version, mit der Anfänger wie Fortgeschrittene gleichermaßen gut bedient sind.

(B. Schneider/ev)

Info: Happy Software, Markt & Technik Verlag AG, Hans-Pinsel-Str. 2, 8013 Haar bei München. Preis 98,- Mark.

# Assembler ist keine Alchimie – Teil 10 [127-131]

> Auf zum Endspurt: Die letzten 4 Assembler-Befehle werden in Angriff genommen (jedoch nicht die letzte Folge des Kurses). Wir steigen ein in ein unerhört interessantes, wenn auch nicht einfaches Thema: Die Interrupt-Technik.

Die Assembler-Befehle haben wir bis auf vier noch offenstehende alle behandelt. Diese vier, die alle mit dem Interrupt-Handling zusammenhängen, sollen diesmal unser Thema sein. Um nach längerer Zeit mal wieder auf den Titel dieser Serie zurückzukommen (nämlich die Alchimie!): Wenn wir diese 4 Befehle beherrschen, haben wir den ersten Schritt zum Meister der Assembler-Alchimie getan. Diese vier kleinen 1-Byte-Befehle öffnen uns eine geheime Pforte zu einem Universum an Programmier-Möglichkeiten, von dem wir bisher kaum zu träumen vermochten. Genug der Schwärmerei, erst kommt noch eine Menge Arbeit, die uns wohl mehrere Folgen dieser Serie in Atem halten wird.

Zuvor noch eine Bemerkung: es gibt kaum ein Thema im Rahmen der Programmierung in Assembler, welches so penetrant häufig Abstürze provoziert, wie das nunmehr angesteuerte! Falls Sie noch keine RESET-Taste an ihrem Computer haben, wird es nun höchste Zeit. Diese nützlichen Dinger werden inzwischen schon so preiswert angeboten (sehen Sie mal in den Kleinanzeigenteil!), daß Sie zur Grundausstattung eines Assembler Alchimisten zählen.

## Was sind Interrupts?

Unser Computer ist — solange er eingeschaltet ist — ständig mit irgendwelchen Tätigkeiten beschäftigt. Im Direktmodus hängt er beispielsweise meistens in einer Warteschleife und harrt der Eingaben, im Programm-Modus arbeitet er sich mit Hilfe der Interpreterschleife durch einen Basic-Befehlstext hindurch und so weiter. Nun werden Sie ja sicher schon festgestellt haben, daß er im Direktmodus auch den Cursor blinken läßt, in beiden Modi die TI$-Uhr weiterzählt und weitere Dinge macht, die anscheinend so nebenher passieren. Schon in der ersten Folge dieser Serie aber haben wir einen Unterschied zwischen Mensch und Computer festgehalten: Der Mensch kann mehrere Dinge gleichzeitig tun, der Mikroprozessor ist nur fähig zu einer Arbeit pro Zeiteinheit. Weil aber diese Zeiteinheiten so unfaßbar kurz sind (etwa eine Millionstel Sekunde), haben wir Benutzer den Eindruck der Gleichzeitigkeit.

Wenn dem aber so ist, wie macht es der Computer, daß er beispielsweise ein Programm abarbeitet und trotzdem die TI$-Uhr weiterzählt? Durch Unterbrechungen (interrupt = unterbrechen) der gerade ausgeübten Tätigkeit. Ein Beispiel aus dem täglichen Leben soll uns das illustrieren: Sie lesen gerade diesen Artikel, als das Telefon klingelt und ein Freund von Ihnen wissen möchte, was eigentlich Unterbrechungen sind. Während Sie es ihm erklären, fängt in der Küche der Teekessel schrill zu pfeifen an. Sie sagen Ihrem Freund, er möge sich einen Moment gedulden, gehen in die Küche und nehmen den Kessel vom Feuer. Dann kehren Sie ans Telefon zurück und beenden nach einer Weile das Gespräch. Nach dem Auflegen des Telefonhörers setzen Sie die Lektüre des Artikels fort, fest entschlossen, sich nun nicht mehr unterbrechen zu lassen. Kurze Zeit später klingelt jemand an der Tür. Sie lassen sich dadurch nicht stören.

Dieses Gleichnis gibt ziemlich genau wieder, was sich im Computer — nur bei millionenfacher Geschwindigkeit — bei Unterbrechungen abspielt. In Bild 1 ist das Schema des Ablaufes grafisch dargestellt. In gewisser Weise ähnelt das ganze dem Abarbeiten von Unterprogrammsequenzen. Weshalb programmiert man dann nicht einfach mittels einiger JSR-Aufrufe? Dafür hat L.A.Leventhal einen einleuchtenden Vergleich: »Ein Unterbrechungs-System entspricht etwa einer Telefonklingel. Sie läutet, wenn ein Anruf empfangen wird, so daß man den Hörer nicht laufend abnehmen muß, um festzustellen, ob sich jemand in der Leitung befindet.« (L.A.Leventhal, »6502 Programmieren in Assembler«, München tewi Verlag, S.121). Unterbrechungen können dann angefordert und abgearbeitet werden, wenn sie nötig sind, im Gegensatz zu Unterprogrammen, die erst dann berücksichtigt werden, wenn der Programmzähler einen JSR-Befehl erfaßt. Um also schnell reagieren zu können, müßte man sehr oft in einem Programm eine Unterroutine anspringen, die auf gewisse Registerinhalte prüft und dann zur Bearbeitung verzweigt oder — bei Nichtvorliegen einer Bedingung — im normalen Programm weiterfährt. Das kostet unnötig Zeit und Speicherraum. Mancher Verkehr des Computers mit Peripherie erfordert so schnelle Reaktionen, daß diese nur geleistet werden können durch Unterbrechen des laufenden Programmes.

Ich denke, daß Sie nun die Notwendigkeit von Unterbrechungen erkennen. Fast jede CPU kennt solche Unterbrechungssysteme. Man kann sie charakterisieren durch die Beantwortung folgender Fragen:
**1)**	Welche Unterbrechungs-Eingänge weist die CPU auf?
**2)**	Wie reagiert die CPU auf eine Unterbrechung?
**3)**	Wie bestimmt die CPU die Unterbrechungsquelle, wenn die Anzahl der Quellen größer ist als die Anzahl der Eingänge?
**4)**	Kann die CPU zwischen wichtigen und weniger wichtigen Unterbrechungen unterscheiden?
**5)**	Wie und wann wird das Unterbrechungssystem freigegeben oder gesperrt?
All diese Fragen werden wir im Laufe dieser Serie für unseren Computer ergründen.

## Das Unterbrechungssystem der CPU 6510/6502

Einige dieser Charakteristika sind schnell zu zeigen:
**Zu 1**: Unsere CPU hat ganau 2 Eingänge für Unterbrechungen (wenn man RESET außer acht läßt, was wir im folgenden meist tun werden).
**Zu 3**: Natürlich gibt es weitaus mehr denkbare Unterbrechungsquellen als diese 2 Eingänge, weshalb softwaremäßig eine Registerabfrage (das sogenannte Polling) durchgeführt wird, um die Quelle festzustellen.
**Zu 4**: Zwischen wichtiger und nicht so wichtiger Unterbrechung kann unsere CPU unterscheiden durch die Priorität der beiden Eingänge. Wir haben eine sogenannte maskierbare Unterbrechung, genannt IRQ, welche per Befehl ignoriert (maskiert) werden kann und eine andere, nicht maskierbare, die daher auch NMI (not maskable interrupt = nicht maskierbare Unterbrechung) genannt wird. NMI hat eine höhere Priorität als IRQ und kann deshalb für die wichtigeren Aufgabenstellungen eingesetzt werden.
**Zu 5**: Freigegeben oder gesperrt werden kann die IRQ-Unterbrechung durch ein Sperrbit (auch Maskenbit genannt), welches sich als Bit 2 im Flaggen-Register des Prozessors befindet. Das ist die I-Flagge. Für den Empfang der NMI-Unterbrechung kann die CPU nicht gesperrt werden.

Um mal die Parallele zu unserem Beispiel zu zeigen: Das Lesen des Artikels ist die gerade stattfindende Tätigkeit des Computers. Die Telefonklingel signalisiert einen IRQ, der im folgenden bearbeitet wird. Das Pfeifen des Teekessels soll einem NMI entsprechen. Wenn dieser dann bearbeitet ist, geht es mit der Abarbeitung des IRQ weiter. Nach Beendigung des Telefonates wird das Unterbrechungs-Sperrbit gesetzt (sie nehmen sich vor, sich nicht mehr stören zu lassen) und mit der normalen Tätigkeit fortgefahren. Weil der nun folgende IRQ damit maskiert ist, wird das Türklingeln ignoriert.

Die **Frage 2**, nämlich wie unsere CPU auf eine Unterbrechung reagiert, blieb noch unbeantwortet. Nun soll sie behandelt werden:
**a)**	Am Ende jedes Befehls überprüft die CPU automatisch den Zustand des Unterbrechungs-Systems. Wenn an einer der beiden Unterbrechungsleitungen eine Anforderung vorliegt und diese auch freigegeben ist, beginnt die Unterbrechung zu wirken.
**b)**	Zunächst wird der Programmzählerinhalt in der Reihenfolge MSB, LSB auf den Stapel geschrieben. Danach wandert noch der Prozessorstatus auf den Stapel (siehe Bild 2).
**c)**	Durch Setzen des Unterbrechungs-Sperrbits I werden weitere maskierbare Unterbrechungen (IRQ) unterbunden.
**d)**	Nun holt sich die CPU aus einem Vektor ganz am Ende des Speichers eine Adresse, lädt diese in den Programmzähler und startet auf diese Weise ein Serviceprogramm, das dem auslösenden Anlaß Rechnung trägt. In der Tabelle 1 sind die zu den Unterbrechungsformen und zum RESET gehörigen Vektoren aufgeführt.

Bevor wir uns weiter mit den so angesteuerten Routinen befassen, wollen wir die 4 Befehle kennenlernen, die uns noch fehlen.

### Schlüssel zur Unterbrechungsprogrammierung: CLI, SEI, RTI, BRK

Das Sperren der maskierbaren Unterbrechung IRQ und das Löschen der Maske erfolgt durch Setzen oder Löschen des Sperrbits im Prozessorstatus-Register. Dieses Bit, die I-Flagge, kann durch den Befehl CLI gelöscht werden. **CLI** kommt von »**CL**ear **I**nterrupt mask«, was bedeutet »lösche die Unterbrechungs-Maske«. Immer dann, wenn IRQs zugelassen sein sollen zur Bearbeitung durch den Mikroprozessor, muß damit die I-Flagge gelöscht werden. Wie Sie sehen, ist CLI ein 1-Byte-Befehl mit impliziter Adressierung. Er braucht genau 2 Taktzyklen zur Erledigung seiner Aufgabe.

Wenn wir später eigene Unterbrechungsroutinen schreiben, stehen wir oft vor der Frage, ob wir innerhalb unseres Unterbrechungsprogramms weitere Unterbrechungen zulassen wollen. Manchmal ist das wichtig, beispielsweise bei der Tastaturabfrage. Wie wir vorhin erwähnt haben, sperrt die CPU automatisch bei der Annahme von Unterbrechungen weitere IRQs durch Setzen der I-Flagge. Einer der ersten Befehle der eigenen Unterbrechungsroutine wird dann die Freigabe von Unterbrechungen sein durch Löschen der I-Flagge.

**SEI** bewirkt das Gegenteil von CLI. Der Befehl setzt die I-Flagge auf 1 (»**SE**t **I**nterrupt mask«) und verhindert, daß der Mikroprozessor weiteren IRQs seine Aufmerksamkeit schenkt. Das ist in den Fällen wichtig, in denen beispielsweise störungsfrei der Inhalt des Charakter-ROM gelesen werden soll oder während der Änderung von Speicherstellen, die die IRQ-Routine benutzt. Wie wichtig das Sperren von IRQs sein kann, haben Sie eventuell bemerkt, wenn Ihnen das Hilfsbildschirmprogramm aus der 6. Folge mal abgestürzt war. Seit der letzten Folge — wo wir die IRQs gesperrt haben — ist Ihnen das sicherlich nicht mehr passiert. Ebenso wie CLI ist SEI ein 1-Byte-Befehl mit impliziter Adressierung, und auch er braucht 2 Taktzyklen zur Bearbeitung.

Noch eine Bemerkung zum Verhindern der IRQs. Wir werden später sehen, was alles während der 60mal pro Sekunde aufgerufenen Unterbrechung erledigt wird. Jede Routine, die SEI verwendet, verbraucht Rechenzeit. Wenn sie so lange dauert, daß eine oder mehrere dieser regelmäßigen IRQs unterbunden werden, kann das unter Umständen zu Störungen von Programmabläufen führen. In solchen Fällen ist es sinnvoll, in die eigene Routine den Teil der regulären IRQ-Routine einzubauen, der im Programmablauf durch sein Fehlen Störungen verursacht. Meistens kann man aber durch gute Planung eines Programmes dieses Problem umgehen.

RTI heißt »ReTurn from Interrupt«, zu deutsch also: »kehre aus dem Unterbrechungsprogramm zurück.« Es entspricht in seinem Einsatz etwa dem RTS bei Unterprogrammrücksprüngen. Während RTS aber lediglich den alten Programmzählerinhalt vom Stapel holt (und noch eine 1 dazuaddiert), schafft RTI auch noch den alten Inhalt des Status-Registers vom Stapel zurück. Der genaue Ablauf ist wie folgt: **1)**	Alten Prozessorstatus vom Stapel wieder ins Status-Register schieben.
**2)**	Stapelzeiger um 1 erhöhen
**3)**	LSB des alten Programmzählers vom Stapel nehmen und zurückschreiben.
**4)**	Stapelzeiger um 1 erhöhen
**5)**	MSB des alten Programmzählers vom Stapel nehmen und zurückschreiben.
**6)**	Stapelzeiger um 1 erhöhen.

Damit ist der Zustand vor der Unterbrechung wieder hergestellt. Auch die I-Flagge ist so automatisch wieder gelöscht, denn vor der Unterbrechung war sie sicher nicht gesetzt gewesen und der alte Status-Zustand ist ja jetzt wieder vorhanden.

RTI ist ebenfalls ein 1-Byte-Befehl mit impliziter Adressierung. Seine vollständige Bearbeitung dauert 6 Taktzyklen.

Bei eigenen Unterbrechungs-Routinen verwendet man häufig nicht RTI, sondern springt durch JMP an eine sinnvolle Stelle des normalen Unterbrechungsprogrammes. Auf diese Weise kann man dann die normalen Arbeitsgänge der vorprogrammierten Unterbrechung oder Teile davon noch ausführen lassen.

Den Befehl BRK (break = Software-Unterbrechung) haben wir schon verwendet. Er entspricht in seinem Einsatz etwa dem STOP-Befehl in Basic und dient wie jeder Befehl dort hauptsächlich dem Testen von Programmen. Tatsächlich unterscheidet sich die Reaktion unserer CPU bei Auftreten eines BRK kaum von der bei einem IRQ. Folgendes passiert:
**a)**	Der Programmzähler wird um 2 erhöht.
**b)**	Bit 4 des Prozessorstatusregisters, die Break-Flagge B, wird auf 1 gesetzt.
**c)**	Das MSB des Programmzählers wird auf den Stapel gebracht und der Stapelzähler um 1 heruntergezählt.
**d)**	Dasselbe geschieht nun mit dem LSB des Programmzählers e) und mit dem Statusregister.
**f)**	Das Unterbrechungsmaskenbit, die I-Flagge, wird auf 1 gesetzt um IRQs zu sperren.
**g)**	In den Programmzähler wird nun aus dem Vektor FFFE/FFFF dieselbe Adresse geladen, die auch bei IRQs benutzt wird. Damit startet nun das Programm, das diese Unterbrechung bearbeitet.

Sie sehen, daß der BRK-Befehl ein ziemlich komplizierter Geselle ist. Zwar handelt es sich wieder um einen 1-Byte-Befehl mit impliziter Adressierung, aber er benötigt immerhin 7 Taktzyklen, um all diese Arbeit zu bewältigen.

Wir haben BRK bisher immer zur Programmunterbrechung mit nachfolgender Registeranzeige durch den SMON eingesetzt. Der SMON ist — wie fast jeder Monitor — so programmiert, daß ein BRK zur Registeranzeige führt. Das ist natürlich sinnvoll beim Einsatz von BRK zur Fehlersuche. In dem Moment, wo ein BRK vom Prozessor bearbeitet wurde, kann nur durch die gesetzte B-Flagge von einem IRQ unterschieden werden. Es ist manchmal nötig, schon zu diesem Zeitpunkt diesen Unterschied festzustellen. Deshalb verwendet man den nachfolgend beschriebenen Test zu diesem Zweck:
**PLA**
in den Akku wird das zuletzt auf den Stapel geschobene Prozessorstatus-Register geholt.
**PHA**
und sogleich wieder zurückgeschoben
**AND #$10**
durch die AND-Verknüpfung mit der Binärzahl 0001 0000 kann eine eventuell vorhandene B-Flagge isoliert werden.
**BNE BREAK**
Falls eine B-Flagge gesetzt war, ist der Akku ungleich 0 und die Bearbeitung verzweigt zum von uns konstruierten BREAK-Programm. War der Akku nach dieser AND-Verknüpfung gleich 0, dann erfolgt keine Verzweigung und es handelt sich um einen IRQ, zu dessen Bearbeitung nun zu springen ist.

Es gibt noch eine andere — gebräuchlichere — Möglichkeit, zwischen einem BRK und einem IRQ zu unterscheiden, die allerdings erst zu einem späteren Zeitpunkt des computerinternen Unterprogrammes erfolgt. Von dieser zweiten Möglichkeit wird im SMON Gebrauch gemacht und wir werden sie nachher auch kennenlernen.

Natürlich kann der BRK-Befehl auch zu anderen Zwecken als zur Registeranzeige durch einen Monitor verwendet werden. Es kommt immer darauf an, welches Service-Programm wir dem Computer anbieten. Springt man aus so einem Service-Programm mittels RTI zurück ins Hauptprogramm, dann muß man berücksichtigen, daß der Programmzähler vor der Sicherung auf dem Stapel um 2 erhöht worden ist. Manchmal sind deshalb noch Korrekturen des Programms nötig.

Ich hoffe, daß Sie bisher diesen Artikel nicht zu frustrierend fanden, denn ständig ist die Rede vom eigenen Unterbrechungs-Programm und dabei wissen Sie — außer durch BRK — noch gar keine Möglichkeit, einen IRQ oder NMI auszulösen, und Sie sind sicher noch sehr vorsichtig mit dem Gedanken an eigene Unterbrechungs-Routinen, weil Ihnen ja noch unbekannt ist, wie die normale Firmware Unterbrechungen behandelt. Keine Angst: All das werden wir noch klären. Betrachten Sie diese Folge zum Thema Unterbrechungen vielleicht mehr wie ein Handbuch, in dem Sie dann, wenn Ihr Verständnis gestiegen ist, nochmal zurückblättern können:

Wir haben bisher nur betrachtet, wie unsere CPU reagiert, wenn an einem der beiden Unterbrechungs-Eingänge (IRQ und NMI) eine Unterbrechungs-Anforderung vorliegt. Um nun aber selbst ins Geschehen eingreifen zu können, ist es nötig zu wissen, wie diese Anforderung dorthin gelangt. Das erfordert von uns die Beschäftigung mit anderen Computerbausteinen als der CPU, die bisher im Mittelpunkt unseres Interesses stand.

## Woher kommen die Unterbrechungs-Anforderungen?

Quellen für Unterbrechungen können viele genannt werden: Diskettenstation, Datasette, Drucker, Modem, Schaltelemente und so weiter. Um aber eine gewisse Übersicht zu bekommen, sollte man unterscheiden zwischen primären und sekundären Unterbrechungsquellen. Das soll kurz erläutert werden: Die Diskettenstation beispielsweise ist über den seriellen Port mit dem Computer verbunden. Dieser wiederum steht in direktem Kontakt zu 2 Bausteinen, den CIAs. Erst diese CIAs stehen in direktem Kontakt zur CPU. Alle Unterbrechungs-Quellen, die direkt Signale an die beiden Unterbrechungseingänge unserer CPU senden, sollen künftig »primäre« Quellen genannt werden, die anderen, die nur über solch eine primäre Quelle Unterbrechungs-Anforderungen stellen, werden von uns als »sekundäre« Quellen bezeichnet. Weil wir irgendwo einen Schnitt machen müssen — einmal, um nicht völlig auszuufern in der Erklärung von peripheren Geräten (das soll anderen, kompetenteren überlassen bleiben) und zum anderen, weil ich mich da auch nicht so gut auskenne — werden wir uns im folgenden auf die primären Unterbrechungsquellen beschränken. Da bleibt aber noch mehr als genug zu tun übrig und deshalb soll auch nur eine Auswahl dieser Primärquellen detailliert behandelt werden.

Welches sind nun die primären Unterbrechungsquellen? Hier sind sie aufgeführt:
**1)** Der VIC-II-Chip (MOS 6566/6S67 Video Interface Controller)
**2)** Die beiden CIAs (MOS 6526 Complex Interface Adapter)
**3)** Die RESTORE-Taste
**4)** Der Expansion-Port
**5)** RESET (paßt hier nicht ganz her, woanders aber auch nicht besser)

Den Expansion-Port werden wir nicht behandeln und einen RESET nur ziemlich kurz betrachten, weil es sich dabei eigentlich nicht um eine Unterbrechung im bisher definierten Sinn handelt.

## Der VIC-II-Chip als Unterbrechungsquelle

Soweit ich feststellen konnte, kommt der VIC-II-Chip in Bezug auf unsere CPU nur als Anforderer von maskierten Unterbrechungen (IRQ) in Frage. Die Handhabung seiner Unterbrechungs-Anforderungen geschieht im VIC-II-Chip durch zwei Register. Vier Ereignisse sind eingeplant, deren Eintreten zur Unterbrechung führen kann:
**1)** Rasterzeilen-Unterbrechung
**2)** Kollision eines Sprite mit Hintergrund
**3)**	Kollision von Sprites untereinander
**4)**	Lichtgriffel-Unterbrechung.

Die ersten 3 Auslöser werden wir uns in kommenden Folgen genau ansehen und dabei vielerlei interessante Möglichkeiten feststellen. Die Option, die der Lichtgriffel bietet, wird nicht behandelt werden: Meine Kenntnisse auf diesem Sektor sind nur gering (nobody is perfect).

Das sogenannte Interrupt Enable Register (Unterbrechungs-Zulassungs-Register) des VIC-II-Chips ist Register 26. Es befindet sich in der Speicherstelle 53274 ($D01A) (siehe Bild 3).

In diesem Register wird festgelegt, ob eines — oder mehrere — der 4 möglichen auslösenden Ereignisse eine Unterbrechungsanforderung an den Mikroprozessor senden soll. Jedem Ereignis ist ein Bit zugeordnet. Ist dieses Bit gleich 1, dann ist die Unterbrechung freigegeben, ist es gleich 0, dann liegt eine Sperrung vor. Die Zuordnung der Bits ist wie folgt:
**Bit 0** Rasterzeilen-IRQ
**Bit 1** Sprite/Hintergrund-Kollision
**Bit 2** Sprite/Sprite-Kollision
**Bit 3** Lichtgriffel-IRQ
**Bits 4 bis 7** sind ungenutzt und haben immer den Wert 1.

Das Register 25 wird Interrupt Latch Register genannt, was etwa zu übersetzen wäre mit »Unterbrechungs-Einrast-Register« (siehe Bild 4). Der englische Ausdruck »latch«, der nur umschreibend oder sehr technisch übersetzt werden kann, beschreibt eigentlich recht genau, was in diesem Register geschieht. Ein »latch« ist nämlich so etwas wie ein Schnappriegel, also ein Riegel, der bei der Betätigung einrastet. Wenn eines der 4 möglichen Ereignisse eintritt, schnappt im dazugehörigen Bit dieses Registers der Inhalt auf 1. Die Bit-Zuordnung ist die gleiche wie in Register 26. Aber das Bit 7 hat hier noch eine Bedeutung: Ist eines der Bits 0 bis 3 auf 1 gesetzt und das dazugehörige Ereignis in Register 26 auch zur Unterbrechung zugelassen (also auch dort gleich 1), dann taucht in Register 25, Bit 7 eine 1 auf. So kann durch einfaches Lesen dieses Bits festgestellt werden, ob ein IRQ durch den VIC-II-Chip ausgelöst wurde.

Will man in diesem Register ein gesetztes Bit löschen, muß man — außergewöhnlich! — eine 1 in die Bitposition schreiben.

Mit Recht erwarten Sie nun eigentlich eine Anwendung des bisher gelernten. Bei Unterbrechungsprogrammen ist es aber dringend nötig, immer den gesamten Komplex im Auge zu haben. Ich habe mich daher entschlossen, zuerst alles zu erklären und dann Anwendungsmöglichkeiten vorzustellen. Ihre Geduld wird auf eine harte Probe gestellt, aber ich hoffe, daß Sie ab der nächsten Folge feststellen, daß es sich gelohnt hat, etwas zu warten.

An sich sind die beiden CIAs in unserem Computer völlig identisch. Sie werden aber unterschiedlich eingesetzt. Sehen wir uns zunächst einmal an, was beiden in Bezug auf Unterbrechungen gemeinsam ist, um danach die Unterschiede festzuhalten. Die Unterbrechungs-Steuerung geschieht in Register 13 dieser Bausteine. Dieses Register hat 2 Funktionen: Es bestimmt, ob eine Unterbrechungsanforderung an die CPU gesandt werden soll, und es stellt fest, ob ein Ereignis stattgefunden hat, das zur Unterbrechung führen kann. Die Bedienung dieses Registers ist demzufolge auch etwas unübersichtlich, aber wir haben schon ganz andere Probleme gemeistert.

## Die beiden CIA-Bausteine als Unterbrechungsquellen

Sehen wir uns aber zuerst einmal an, welche Ereignisse vom Standpunkt eines CIA-Bausteines als Unterbrechungskriterium dienen können:
**1)**	Unterlauf der Uhr A
**2)**	Unterlauf der Uhr B
**3)**	Die interne Uhr hat eine Alarmzeit erreicht
**4)**	Am SP-Eingang (hängt mit dem seriellen Port zusammen) ist ein bestimmter Zustand erreicht
**5)**	An einem Eingang namens FLAG ist ein bestimmter Zustand erreicht.

Die Ereignisse 4 und 5 werden wir ebenfalls im weiteren weitgehend ausklammern.

Nun zum Register 13, dem Unterbrechungs-Kontroll-Register (siehe Bild 5).

Auch hier gehört zu jedem Ereignis ein Bit. Dabei — um Wiederholungen zu vermeiden — ist die Zuordnung schon durch die eben angegebene Ereignisaufzählung gegeben. Ziehen Sie von der vorangestellten Nummer immer eine 1 ab und Sie haben die Bitnummer. Die Bits 5 und 6 sind unbenutzt. Bit 7 hat eine dreifache Funktion, die eng mit den anderen Bitinhalten verknüpft ist. Sehen wir uns das mal der Reihe nach an:

### Lesen des Registers

Sind Unterbrechungsereignisse aufgetreten, dann sind die dazugehörigen Bits auf 1 gesetzt. Bit 7 ist gleich 1, wenn mindestens ein solches Ereignis stattgefunden hat und außerdem dieses Ereignis als Unterbrechungsauslöser freigegeben ist. Auf diese Weise kann — ähnlich wie beim VIC-II-Chip-Register 25 — festgestellt werden, ob die Unterbrechung durch einen der beiden CIAs angefordert wurde. Im Unterschied aber zum VIC-II-Register wird Register 13 durch das Lesen **gelöscht**. Braucht man den Inhalt also noch, sollte man ihn irgendwo zwischenspeichern.

### Schreiben in das Register

**Bit 7 = 0** erzeugt Sperren.
Das erkennt man am besten an einem Beispiel. Nehmen wir an, wir möchten die Unterbrechung sperren, die durch einen Unterlauf von Uhr A erzeugt werden kann. Das betrifft das Bit 0. Wir schreiben in das Register 13 folgende Zahl: 0000 0001

Wie Sie sehen, ist das Bit 7 gleich 0. Die 1 in Bit 1 bewirkt die Sperrung. Durch die Nullen in den anderen Bits wird bewirkt, daß die anderen Unterbrechungs-Ereignisse nicht beeinflußt werden. Wollten wir alle sperren, dann müßten wir einschreiben: 0001 1111

Auf diese Weise können selektiv einzelne Unterbrechungen durch Einschreiben der 1 bei gelöschtem Bit 7 gesperrt werden.
**Bit 7 = 1** erzeugt Freigabe.

Auch hier wieder ein Beispiel. Wenn wir ganz gezielt Unterbrechungen durch Unterlauf der Uhr A freigeben wollen, müssen wir die folgende Zahl in Register 13 schreiben: 1000 0001
Bit 7 (gleich 1) zeigt an, daß diejenigen Unterbrechungen freizugeben sind, deren Bits auf 1 gesetzt sind. Alle anderen Unterbrechungen, wo also in der dazugehörigen Bitposition der einzuschreibenden Zahl eine 0 steht, bleiben unverändert.

Ein wichtiger Unterschied zwischen den beiden CIAs ist der, daß der Unterbrechungsausgang von CIA 1 mit dem IRQ-Eingang der CPU verbunden ist, wohingegen der entsprechende Ausgang von CIA2 an den NMI-Eingang unseres Mikroprozessors führt. Daher löst der CIA 1 nur IRQs aus, er wird manchmal deshalb auch IRQ-CIA genannt. Der andere ist dann der NMI-CIA, weil er nur NMIs anfordern kann.

### Der IRQ-CIA

Das Register 13 des IRQ-CIA (der die Speicherstellen 56320 bis 56335 belegt), liegt in Zelle 56333 ($DC0D). Die einzelnen Bits sind wie folgt zugeordnet:
**Bit 0** Unterlauf Uhr A
Von hier kommt der IRQ, der 60mal pro Sekunde stattfindet zur Tastaturabfrage, zum Weiterstellen der TI$-Uhr etc.
**Bit 1** Unterlauf Uhr B
Spielt bei Kassettenoperationen und dem seriellen Port eine Rolle.
**Bit 2** ALARM bei interner Uhr. Spielt beim Zufallszahlengenerator (RND(0)) eine Rolle.
**Bit 3** Hier kommen durch den User-Port Unterbrechungs-Anforderungen.
**Bit 4** ist verbunden mit dem seriellen Port und der Kassetten-Lese-Leitung.

### Der NMI-CIA

Ebenso kurz und schmerzlos wie beim CIA 1 soll auch das besondere am CIA 2, dem NMI-CIA (er belegt den Speicher von 56576 bis 56831) vorgestellt werden. Sein Register 13 findet sich in Speicherstelle 56589 ($DD0D). Die Bits 0 und 1 (Unterläufe der beiden Uhren) spielen beim Senden beziehungsweise Empfangen von Daten über die RS232C-Schnittstelle eine Rolle, Bit 2 (ALARM) wird nicht verwendet, Bit 3 ist direkt mit dem User-Port verbunden ebenso wie Bit 4. Der NMI-CIA wird uns in seiner normalen Funktion nicht mehr beschäftigen.

### Die RESTORE-Taste und ein kleines Testprogramm

Die RESTORE-Taste ist direkt mit dem NMI-Eingang unseres Mikroprozessors verbunden. Das ermöglicht es uns, durch einfaches Drücken dieser Taste jederzeit ins Geschehen einzugreifen, ohne uns um Details kümmern zu müssen, ob sich der Computer gerade im Direktoder im Programm-Modus befindet und so weiter. Denn NMI hat die höchste Priorität der Unterbrechungen.

Ein kleines Testprogramm soll Ihnen hier noch vorgestellt werden, das Sie vielleicht aber noch nicht ganz verstehen werden, weil wir erst in der nächsten Folge die eingebauten Serviceprogramme kennenlernen werden. Schalten Sie also den SMON ein und geben Sie das Programm 1 ein (ab $6000):

Am besten speichern Sie nun das Programm ab und schalten dann mittels dem SMON-Kommando M 0318 die Anzeige der Bytes ab $0318 ein. Dort steht in den beiden ersten Speicherzellen 47 und FE. Mit dem Cursor fahren Sie in diese Zeile und ändern den Inhalt in 00 und 60, also unsere Programmstartadresse in der LSB/MSB-Form. Nach einem RETURN läuft nun jede NMI-Anforderung über unser Programm. Nun können Sie es ausprobieren, indem Sie mal die RESTORE-Taste drücken. Es genügt völlig, alleine diese Taste zu betätigen. Das wirkt — sichtbar durch die Änderung der Rahmenfarbe — in jedem Modus und jederzeit. Eine kleine Merkwürdigkeit ist, daß man manchmal etwas Geduld aufbringen muß, bis man die Wirkung sieht. Ich vermute, daß der NMI so schnell erledigt wird, daß sich mehrer NMIs pro Tastendruck ereignen. Man müßte sich noch eine kleine Routine überlegen, die die Wirkung etwas verzögert, denn 2 solche EOR-Kommandos nacheinander heben sich gegenseitig auf.

Damit sei’s für diesmal genug. In der nächsten Ausgabe werden wir uns die Unterbrechungs-Firmware ansehen und einige Programmbeispiele vorstellen. Zum Schluß noch wie üblich eine Aufstellung (Tabelle 2) mit den besprochenen Befehlen.

(Heimo Ponnath/gk)

# Dem Klang auf der Spur (Teil 7) [132,134-136,139-140]

> Die praktische Anwendung der bisher erarbeiteten Kenntnisse steht im Mittelpunkt dieser Folge: Ein universelles Synthesizer-Programm bringt den SID auf Trab.

Die meisten modernen digitalen Synthesizer haben eine Gemeinsamkeit: eine fast unüberschaubare Vielzahl von Einstellmöglichkeiten. Das in den letzten Folgen beschriebene Programm Modulator ist da keine Ausnahme. Um die reichhaltigen Möglichkeiten auszuloten, die dieses Programm bietet, benötigt man ein komfortables Editorprogramm, sonst läßt die Motivation beim Jonglieren mit Bits, Bytes, PEEK und POKE bald nach. Ein solches Programm wird hier vorgestellt. Es zeigt die über 70 Parameter des SID und von Modulator, übersichtlich nach Funktionsgruppen geordnet, auf dem Bildschirm an und erlaubt einen schnellen Zugriff auf alle Einstellwerte. Diese Einstellwerte können geändert werden, während ein Ton klingt, so daß die Wirkung der Einstellung unmittelbar überprüft werden kann. Zudem kann man Töne im Bereich von zwei Oktaven direkt über die Tastatur anspielen. Dabei können zwar nicht mehrere Tasten gleichzeitig gespielt werden, man kann aber zwei oder drei SID-Stimmen mit einem Tastendruck gleichzeitig erklingen lassen. Darüber hinaus verwaltet das Programm 24 Parametersätze, im folgenden Sounds genannt, im Arbeitsspeicher. Diese 24 Sounds können als eine Datei von Diskette geladen, bearbeitet und wieder abgespeichert werden.

## Wie man den Sound-Editor zum Laufen bringt

Das abgedruckte Programm kann man beim Listing-Service bestellen oder auch selbst abtippen, was bei 107 Blöcken leider etwas mühsam ist. Dabei kann man die Kommentare natürlich weglassen, denn man hat sie im Heft ja bereits vor sich. Man sollte dann aber trotzdem alle Zeilennummern eintippen, da viele Zeilen angesprungen werden, auch wenn sie nur Kommentare enthalten. Reine Kommentarzeilen kann man mit: »(Zeilennummer) REM« oder »(Zeilennummer) : « abkürzen. Man hüte sich aber davor, eine RENUMBER-Utility auf das Programm anzuwenden. Die meisten Sprünge werden nämlich nicht über die Basic-Befehle GOTO und GOSUB abgewickelt, sondern über zwei Maschinenprogramme GT und GS (darüber später mehr). Diesen Umstand kann eine RENUMBER-Utility natürlich nicht berücksichtigen.

Der Sound-Editor ist nur zusammen mit dem in Ausgabe 4/85 (MSE-Listing) und in Ausgabe 5/84 (Assembler-Listing) veröffentlichten Programm Modulator lauffähig. Dieses Programm muß auf Diskette als absolut zu ladende Datei (Bereich $0075 bis $C422) unter dem Namen »MODULATOR« vorliegen.

Im Programm Modulator steckt leider noch ein kleiner Bug: Es wird der Zeropage-Speicherplatz $FF verwendet, was hin und wieder den Basic-Interpreter stören kann. Wenn man statt $FF den vom Betriebssystem nicht verwendeten Speicherplatz $02 verwendet, treten keine Probleme mehr auf. Im Modulator-Code sind zehn Zeropage-Adressen von dieser Änderung betroffen. Die folgenden vier Basic-Zeilen enthalten die zehn Adressen und nehmen auch gleich die Änderung vor:

TODO
10 FORI=1 TO 10
20 READ AD:POKE AD,2:NEXT I
30 DATA 49339,49344,49734,49744,50115
40 DATA 50129,50162,50168,50173,50178

Der geänderte Modulator-Code sollte dann unter dem Namen »MODULATOR« auf Diskette zurückgespeichert werden. Jetzt müßte der Sound-Editor, sofern er fehlerfrei eingetippt wurde, laufen. Da es sich hier um ein Programm handelt, das überwiegend in Basic geschrieben ist, ist ein umfangreicher Setup-Teil, der etwa 30 Sekunden beansprucht, leider unvermeidbar. Das Warten wird dann allerdings durch Komfort und durchaus akzeptable Geschwindigkeit belohnt.

## Mit 8 Menüs über 70 Parameter im Griff

Zum Verständnis der Parameter sei auf Ausgabe 4/85 verwiesen, wo die Funktionen der Modulatorkomponenten beschrieben sind. Der Sound-Editor meldet sich mit dem Hauptmenü (Bild 1) mit dem Namen MODULATOR. Damit soll betont werden, daß Modulator der eigentliche Kern des Programms ist. Der Sound-Editor wird ausschließlich über die Tastatur bedient, wobei sich die meisten Funktionen mit einem einzigen Tastendruck auslösen lassen. Es ist durchgehend ' das WYSIWYG-Konzept (What You See Is What You Get) verwirklicht, das heißt, alle in einer Situation verfügbaren Kommandos werden am Bildschirm angezeigt. Eine Ausnahme bilden die sieben Kommandos zur Auswahl der Untermenüs, die zwar nur im Hauptmenü angezeigt werden, aber auch in jedem Untermenü funktionieren. Man kann also direkt von einem Untermenü ins andere springen. Den Umweg über das Hauptmenü benötigt man eigentlich nur, wenn man die Kommandos nicht mehr weiß.

Das untere Drittel des Bildschirms ist in allen Menüs identisch. Es zeigt eine stilisierte Klaviatur über zwei Oktaven, der auf dem Computer die oberen beiden Tastenreihen entsprechen. Mit diesen Tasten kann man bis zu drei SID-Stimmen mit einem Tastendruck anspielen. Mit dem Kommando V und einer Ziffer 1, 2 oder 3 können die zu spielenden Stimmen aktiviert oder desaktiviert werden. Angezeigt wird das rechts neben der Klaviatur. Die Funktion SUSTAIN bewirkt, daß der Ton nach dem Loslassen einer Ton-Taste weiterklingt, sofern ein SUSTAIN-Pegel größer als Null eingestellt ist. Die GATE-Bits des SID werden bei aktivierter SUSTAIN-Funktion nicht zurückgesetzt. Mit dem Drücken der Space-Taste wird das GATE-Bit des Software-Hüllkurvengenerators (Soft-EG) gesetzt, durch Loslassen zurückgesetzt. Der Soft-EG wird also durch SPACE ausgelöst, vorausgesetzt, seine Parameter haben sinnvolle Werte. Das Auslösen des Soft-EG kann man mit Shift Space an die Tontasten koppeln, was bei den meisten Soft-EG-Anwendungen sinnvoll sein dürfte. Auch die SUSTAIN-Funktion und die Koppelung des Soft-EG werden rechts neben der Klaviatur angezeigt.

Die Beeinflussung der Parameter in den Untermenüs erfolgt nach einheitlichem Schema: Der zu ändernde Parameter wird mit den Cursor-Tasten angewählt und mit den f-Tasten verstellt. Je nach Anzahl der Parameter sind dabei alle vier Cursortasten oder nur die Tasten Cursor-Links und Cursor-Rechts wirksam. Auch die Funktionsweise der f-Tasten ist einheitlich: Numerische Parameter werden durch fl und f7 in großer und durch f3 und f5 in kleiner Schrittweite verstellt. Bei nichtnumerischen Parametern wird die Funktion der f-Tasten am Bildschirm angezeigt.

Bei numerischen Parametern werden bis auf eine Ausnahme direkt die Werte der SID- oder Modulator-Register angezeigt. Bei der Ausnahme handelt es sich um die Basisfrequenzen der drei Stimmen (Bild 2, Parameter F). Bei dieser Basisfrequenz handelt es sich um die Frequenz des tiefsten spielbaren Tones (Taste Q). Sie wird nicht in Hertz, sondern in einer musikalisch sinnvollen Notation angegeben. Sie besteht aus Notennamen, einer Oktavnummer und einer Verstimmung in Cent. Die Oktavnummern bewegen sich im Bereich 0 bis 5. Dabei entspricht A 4 dem 440-Hz-Ton, der in der Musik korrekt »eingestrichenes a« heißt. Ein Cent ist ein hundertstel Halbton. Der Parameter bewegt sich von —49 bis + 50. Die etwas komplizierte Berechnung der Basisfrequenz in Hz und in SID-Registerwerten findet man in den Programmzeilen ab 3110.

Alle anderen Sound-Parameter sind anhand der Menübilder, in denen sie auftreten (Bild 2 bis 6), leicht identifizierbar und bedürfen keiner weiteren Erläuterung.

Im Menü SOUNDS (Bild 7) können ganze Parametersätze (jeweils 107 Byte, siehe auch Tabelle 4) mit Namen versehen und im Speicher abgelegt werden. Angewählt werden die Sounds hier nicht über die Cursor-Tasten, sondern über die Tastenkombinationen Al bis C8. Die 24 Sounds sind alle mit der Parametereinstellung, die beim Programmstart vorliegt, vorbesetzt. Eine Gruppe von 24 Sounds kann im Menü DISK (Bild 8) auf Diskette abgespeichert und wieder geladen werden.

## Bemerkungen zum Programm

Es soll hier nicht die Arbeitsweise des Sound-Editors im Detail beschrieben, sondern nur einige Bemerkungen zum Stil des Programms gemacht werden. In dem Programm werden sehr viele Tastenkommandos akzeptiert, die in verschiedenen Menüs und bei den verschiedenen Parametern auch noch unterschiedliche Bedeutung haben. Um in dieser Situation die Übersicht zu behalten (Anliegen des Programmierers) und um das Programm trotz Realisierung in Basic akzeptabel schnell zu halten (Anliegen des Anwenders), werden die vielen Einzelroutinen von zentraler Stelle aus über variable Vektoren angesprungen. Zwar unterstützt Basic mit den Befehlen ON GOTO und ON GOSUB Mehrfachverzweigungen, diese sind aber bei der hier in Frage kommenden sehr großen Zahl von Sprungzielen schlecht einzusetzen. Die beiden Maschinenprogramme GS und GT (siehe auch Tabelle 2) erlauben dagegen (Unterprogramm-) Sprünge zu Zeilen, deren Nummer ein beliebiger arithmetischer Ausdruck oder eine Variable, der Sprungvektor, sein kann.

Die Tastenkommandos werden nun sehr schnell und auf einfache Weise interpretiert. Der ASCII-Code A der zuletzt gedrückten Taste und die Nummer M des gerade aktiven Menüs (0 bis 7) werden als Indizes in eine Sprungvektor-Tabelle V% verwendet. Der gefundene Eintrag ist die Zeilennummer der Routine, die den Tastendruck bearbeitet. Diese Routine wird als Unterprogramm aufgerufen. Für diesen Vorgang benötigt man nur einen einzigen Befehl:
SYSGS,V%(M,A) (Zeile 1550).

Allen nicht definierten Tasten wird über die Tabelle der Sprungvektor 0 zugeordnet. Er führt in das leere Unterprogramm ganz am Anfang des Listings. Die Sprung-Tabelle wird über die Inhalte der DATA-Zeilen ab 9500 im Programm-Setup besetzt. Vierstellige DATAs stehen für Zeilennummern, dreistellige für ASCII-Codes, zweistellige wählen ein Menü (dabei bedeutet zum Beispiel Ml »Menü Nr. 1« und MA »alle Menüs«) und einstellige sind ASCII-Zeichen. »ENDE« schließt die Tabellen-DATAs ab. Der Programmteil ab Zeile 8110 interpretiert diese DATAs und besetzt die Tabelle.

Eine Ergänzung des Programms um weitere Funktionen gestattet sich mit diesem Konzept sehr einfach. Man schreibt ein Unterprogramm und trägt die Zeilennummer des Unterprogramm-Starts zusammen mit der Taste, durch die das Unterprogramm aufgerufen werden soll, in die Tabelle ein. Die Hardcopys entstanden auf diese Weise: Ab Zeile 7900 stand eine Hardcopy-Routine (im Listing hier nicht enthalten). Durch:
9760 DATA MA,7900,Z
wurde bewirkt, daß in allen Menüs durch den Tastendruck Z ein Hardcopy-Ausdruck ausgelöst werden konnte.

Im Sound-Editor werden noch weitere Sprungvektoren angewendet: Eine f-Taste führt grundsätzlich in die Dummy-Routine (leeres Unterprogramm) oder in eine der vier Zeilen 2550, 2560, 2570, 2580. Dort wird ein aktueller numerischer Parameterwert erhöht oder erniedrigt. Anschließend wird in eine der 21 Routinen ab Zeile 2600 weiterverzweigt. Die zugehörige Vektorvariable ist PV. Die 21 Einzelroutinen bringen den geänderten Parameter an seinen Platz in ein SID- oder ein Modulator-Register und geben ihn zudem an der richtigen Stelle am Bildschirm aus.

Der Parameter-Vektor PV wird von Parameter-Anwahl-Routinen gesetzt, von denen es in jedem Menü für jede Parameterart eine gibt, zum Beispiel »Filterfrequenz« wählen, Zeile 5200. Der Aufruf einer Parameter-Anwahl-Routine wird durch die Cursor-Tasten ausgelöst und geschieht durch einen weiteren Vektor AV. Beispiel: »Parameterwahl durch Cursor«, Zeile 5130. Von diesen Cursor-Routinen gibt es fünf Ausführungen, für jedes Menü, in denen die Cursor-Tasten wirksam sind, eine.

Einige Maschinenprogramme machen den Sound-Editor schneller und übersichtlicher. Erwähnt seien dabei Unterprogramme zum Zugriff auf Doppelbytes von Basic aus (»DEEK« und »DOKE«). Das lästige Berechnen von Low- und High-Byte entfällt so. Der »PRINT AT«-Befehl gestattet es, den Cursor an jede Stelle des Bildschirms zu positionieren, um dort etwas auszugeben. Die Tabellen 1 bis 4 sollen eine kleine Dokumentation des Sound-Editors darstellen. Der Leser, der das Programm selbst modifizieren oder erweitern will (zum Beispiel andere oder mehr Farben), findet dort die gesuchte Information.

Das Tabellen- und Vektor-Konzept wird einen weiteren Ausbau des Programms sehr erleichtern. Das schon einmal angekündigte Sequenzer-Programm wird bis zum Ende dieses Kurses den Sound-Editor zu einem kompletten Synthesizer-Programm erweitern, mit dem man dann auch virtuose Melodien mit Modulator-Sounds spielen lassen kann.

(Thomas Krätzig/ev)

# Memory Map mit Wandervorschlägen (Teil 8) [140-142]

> Neben der dynamischen Tastaturabfrage werden die Adressen 153 bis 158 behandelt. Deren Aufgabe ist die Ausgabe von Fehlermeldungen.

Die dynamische Tastaturabfrage ist das Kernthema mit dem wir uns heute beschäftigen wollen. Zuvor aber noch einige Speicherstellen, die wie beim letzten Mal das Betriebssystem als Zeiger für Ein/Ausgabeoperationen benutzt.

## Adresse 153 ($99)<br>Nummer des Eingabe-Gerätes

Das Betriebssystem verwendet diese Speicherzelle, um festzuhalten, welches Gerät zur Eingabe verwendet werden soll.

Die Nummern sind wie folgt festgelegt:

TODO

0	=	Tastatur
1	=	Datasette
2	=	RS232 (User-)Port
3	=	Bildschirm
4	, 5	=	Drucker
8-11	= Floppy-Laufwerke

Nach dem Einschalten oder nach RESET des Computers steht in 153 eine 0 (Tastatur). Nach jedem Einsatz eines anderen Gerätes wird diese Speicherzelle wieder auf 0 gesetzt, so daß wir immer die Tastatur zur Verfügung haben.

Für Maschinenprogrammierer ist diese Adresse sicherlich wertvoll. Die Routine, welche die Eingabegeräte festlegt, sobald der Befehl INPUT# beziehungsweise GET# ausgeführt wird, heißt CHKIN und beginnt beim C 64 ab Adresse 61966 ($F20E), beim VC 20 ab 62151 ($F2C7).

Für Basic-Programmierer habe ich in der Literatur nur eine Anwendung gefunden, und die wurde bereits bei der Besprechung der Speicherzelle 19 (Teil 3 des Kurses in Ausgabe 1/85, Seite 127) angekündigt.

Es ist dies eine MERGE-Routine. Leider funktioniert dieses Verfahren nicht bei dem 1541 Floppy-Laufwerk. Erfunden wurde die Routine von Brad Templeton und ist von Jim Butterfield unter dem Namen »Magic Merge« für den VC 20/C 64 adaptiert worden. Ich gebe zu, in der Zwischenzeit sind noch andere, vielleicht auch kürzere MERGE-Routinen veröffentlicht worden. Aber diese hier verwendet gleich drei interessante Ingredienzen, nämlich die Speicherzellen 19 und 153, außerdem die sogenannte »Dynamische Tastenabfrage«. Wer die letztere nicht kennt, sollte sich zum Verständnis den Texteinschub 1 gleichen Namens ansehen.

Ein MERGE (deutsch: zusammenführen, verschmelzen) besteht darin, ein auf Band gespeichertes Programm zu einem im Computer stehenden anderen Programm so dazuzuladen, daß dieses nicht überschrieben, sondern ergänzt wird. Wichtig ist dabei, daß das Programm vom Band höhere Zeilennummern hat als das Programm im Computer. Außerdem muß das Programm auf dem Band als Datei gespeichert sein. Das wird so erreicht:

TODO

1.	Programm eintippen
2.	Direkt eingeben:<br>OPEN 1,1,1,”Name”:CMD1:LIST
3.	Erst wenn READY kommt, direkt eingeben PRINT#1:CLOSE1

Damit ist das Programm auf dem Band gespeichert. Nun kommt der eigentliche MERGE-Vorgang.

TODO

4.	Es steht ein Programm im Computer
5.	Band mit dem Programm »Name« einlegen
6.	Direkt eingeben: POKE 19,l:OPEN 1
7.	Sobald READY erscheint, Bildschirm löschen (SHIFT-CLR).
8.	Dreimal Cursor-Down
9.	Direkt eingeben:<br>PRINT CHR$(19):POKE 198,1: POKE 631,13:POKE 153,1
10.	Das Band beendet den Ladevorgang mit einer Fehlermeldung, die wir ignorieren.
11.	Nach CLOSE 1 sind beide Programme zusammengefügt.

Wie gesagt, Schritt 6 verwendet Zelle 19 (bitte dort nachlesen), Schritte 8 und 9 sind die »Dynamische Tastenabfrage«, und Schritt 9 verwendet zusätzlich die hier zur Diskussion stehende Speicherzelle 153, um die Datasette als Eingabegerät zu definieren.

## Adresse 154 ($9A)<br>Nummer des Ausgabe-Gerätes

Diese Speicherzelle entspricht der Zelle 153, nur steht hier die Nummer des Gerätes, über das die Ausgabe läuft.

Nach dem Einschalten und nach Ausgabeoperationen wird der Wert immer auf 3 gesetzt. Das ist entsprechend der oben genannten Zuordnung der Bildschirm.

Für Maschinenprogrammierer sei erwähnt, daß Basic bei den Befehlen PRINT # oder CMD die Routine CHKOUT einsetzt, welche die Adresse 154 belegt. Sie steht im C 64 ab Adresse 62032 ($F250), im VC 20 ab 62217 ($F309).

## Adresse 155 ($9B)<br>Fehlerkontrolle bei Bandoperationen

Die Commodore-Datasette ist deswegen so zuverlässig, weil sie mehrere Methoden zur Fehlererkennung beziehungsweise Korrektur von Lese- und Schreibfehlern verwendet.

Eine der Methoden ist die sogenannte Parity-Prüfung. Sie ist nichts anderes als eine Quersummenbildung der einzelnen Stellen jedes Bytes, deren Resultat überprüft wird.

Die Speicherzelle 155 wird bei dieser Parity-Prüfung eingesetzt.

## Adresse 156 ($9C)<br>Flagge für korrektes Byte vom Band

In dieser Speicherzelle wird zwischengespeichert, ob das vom Band gelesene Byte die Prüfungen bestanden hat, also richtig ist oder nicht.

## Adresse 157 ($9D)<br>Flagge für Meldungen

Man muß zwischen zwei Arten von Meldungen unterscheiden:

* Meldungen des Betriebssystems
* Meldungen des Basic-Übersetzers

Die Meldungen des Betriebssystems kennen wir als Angaben zum Ablauf, wie SEARCHING FOR, FOUND, PRESS PLAY ON TAPE und so weiter. Normalerweise nicht bekannt ist die Meldung I/O ERROR #, wobei nach dem Zeichen # Zahlen von 0 bis 29 stehen können. Diese Zahlen beziehen sich auf Meldungen des Übersetzers (Interpreter), die ausschließlich Fehlermeldungen sind. Das mag verwirrend klingen, klärt sich aber sofort. Die Flagge in 157 kann vier Werte annehmen, 0, 64, 128 und 192.

1.	Der Wert 0 unterdrückt alle Meldungen des Betriebssystems. Dieser Modus tritt nach RUN beim Ablauf eines Programms ein.
2.	Der Wert 64 läßt nur Fehlermeldungen des Betriebssystems zu. Dieser Modus ist normalerweise nicht vorgesehen, kann aber künstlich erzeugt werden.
3.	Der Wert 128 unterdrückt die Fehlermeldung des Betriebssystems. Dieser Modus entspricht dem Normalfall.
4.	Der Wert 192 läßt alle Meldungen zu. Auch dieser Modus ist nur künstlich herzustellen.
Das folgende Beispiel macht das deutlich. Geben Sie direkt ein:
POKE 157,0:LOAD ”$”,9

Wir versuchen, vom Gerät mit der Nummer 9, das ist eine zweite Floppy, die Directory zu laden. Wir erhalten entsprechend Punkt 1 nur die Meldung des Übersetzers »? DEVICE NOT PRESENT«. Verändern wir den POKE-Befehl für Punkt 2: POKE 157,64:LOAD”$”,9

Wir erhalten jetzt »I/O ERROR #5 ? DEVICE NOT PRESENT«. POKE 157,128:LOAD"$',9 ergibt die Meldung »SEARCHING FOR $
? DEVICE NOT PRESENT«.

Schließlich nehmen wir noch den letzten Fall:
POKE 157,192:LOAD”$",9

Jetzt erhalten wir alles: »SEARCHING FOR $
I/O ERROR #5
? DEVICE NOT PRESENT«

Da die Fehlermeldung des Betriebssystems und die zugehörigen Nummern in keinem Handbuch erwähnt sind, habe ich sie interessehalber in der folgenden Tabelle zusammengefaßt.

TODO TABLE

 # MELDUNG (ERROR)
1	TOO MANY FILES
2	FILE OPEN
3 FILE NOT OPEN
4 FILE NOT FOUND
5 DEVICE NOT PRESENT
6 NOT INPUT FILE
7 NOT OUTPUT FILE
8 MISSING FILE NAME
9 ILLEGAL DEVICE NUMBER
10 NEXT WITHOUT FOR
11 SYNTAX
12 RETURN WITHOUT GOSUB
13 OUT OF DATA
14 ILLEGAL QUANTITY
15 OVERFLOW
16 OUT OF MEMORY
17 UNDEF’D STATEMENT
18 BAD SUBSCRIPT
19 REDIM’D ARRAY
20 DIVISION BY ZERO
21 ILLEGALDIRECT
22 TYPE MISMATCH
23 STRING TOO LONG
24 FILE DATA
25 FORMULA TOO COMPLEX
26 CAN’T CONTINUE
27 UNDEF’D FUNCTION
28 VERIFY
29 LOAD

Das nächste Mal fahren wir ab Speicherzelle 158 fort.

(Dr. Helmuth Hauck/ah)

TODO ASIDE

## Texteinschub 1. Dynamische Tastenabfrage

Jedesmal wenn Sie eine Taste drücken, wird der ASCII-Codewert des Zeichens oder der Funktion dieser Taste ermittelt und im »Tastaturpuffer« gespeichert. Dieser Pufferspeicher liegt in den Speicherzellen 631 bis 640.

Die eigentliche Abfrage und Umcodierung eines Tastendrucks habe ich im Kurs »Alle Tasten-, Zeichen- und Steuercodes« in den Ausgaben 4/84 bis 7/84 beschrieben. Die ASCII-Codetabelle finden Sie da auch. Sie ist natürlich in allen Handbüchern enthalten, leider aber nicht immer ganz vollständig. Zuerst will ich Ihnen die Arbeitsweise des Tastaturpuffers zeigen.

Der Computer holt sich den ASCII-Codewert aus dem Tastaturpuffer und wenn gerade kein Programm läuft, druckt er das Zeichen auf den Bildschirm oder führt die Funktion der Taste aus. Das ist der oft zitierte »Direkt-Modus«.

Wenn aber ein Programm läuft, dann bleiben die Codezahlen im Puffer so lange stehen, bis der Computer fertig ist. Dann erst werden sie herausgeholt und verarbeitet. Das will ich Ihnen beweisen.

Tippen Sie im Direkt-Modus ein:
FOR K = 1 TO 15000:NEXT K (RETURN)

Während diese an sich sinnlose Zeitschleife 15000mal im Kreise rumrennt, haben Sie genügend Zeit, mehrere Tasten zu drücken, zum Beispiel die erste Buchstabenreihe (QWERTYUIOP@*↑). Natürlich sehen Sie am Bildschirm gar nichts, denn das Programm der Schleife läuft ja noch. Sobald aber die Schleife zu Ende ist, erscheinen 10 der getippten Buchstaben. Quod erat demonstrandum!

Warum nur 10 Buchstaben? Nun, der Tastaturpuffer hat nur 10 Plätze, logisch?

Jetzt müssen wir noch eine weitere Speicherzelle ins Spiel bringen. In die Zelle 198 kann man nämlich eine Zahl hineinPOKEn, welche die Anzahl der Zeichen im Tastaturpuffer begrenzt.

Wiederholen Sie bitte das Experiment von oben, nur soll die direkt eingegebene Zeile erweitert werden:
FOR K = 1 TO 15000:NEXT K: POKE 198,6 (RETURN)

Und siehe da, jetzt werden nur die 6 Buchstaben Q bis Y ausgedruckt. Diese Anwendung des Tastaturpuffers nutzen wir für das Kochrezept »Dynamische Tastenabfrage« aus. Allerdings müssen wir dazu prinzipiell die ASCII-Codewerte verwenden, so wie im nächsten Beispiel.

Löschen Sie bitte den Bildschirm und geben Sie ein (identisch für VC 20 und C 64):
10 PRINT CHR$(65)
20 PRINT CHR$(156)
30 PRINT CHR$(66)CHR$(13)CHR$(67)

65 ist der Code für A, 156 für die Farbe »purple«, 66 für B, 13 für »RETURN« und 67 für C. Das heißt also, daß wir zuerst ein A drucken, dann auf »purple« umschalten, darunter dann das B schreiben, einmal RETURN geben und dann noch das C folgen lassen.

Bild 1 zeigt den Ausdruck auf dem Bildschirm, wenn Sie diese Zeilen LISTen und starten.

Zur Erklärung: Die Leerzeile zwischen A und B ist bedingt durch die PRINT-Anweisung in Zeile 20, welche nur die Farbe umschaltet. Obwohl die Codes für B und C zusammen in einer Zeile stehen, werden sie doch durch das »RETURN« (13) untereinandergesetzt.

Anstelle der 13 können Sie alle mögliche anderen Steuerfunktionen setzen. Bild 2 zeigt das Resultat von 17, nämlich »Cursor down«. Wenn Sie die 8 nehmen, können Sie den Zeichensatz nicht mehr ändern. Der Einsatz der gleichzeitig gedrückten SHIFT- und Commodore-Taste funktioniert erst nach CHR$(9) wieder.

Als nächstes wollen wir die ASCII-Codewerte und den Tastaturpuffer im »Programm-Modus« einsetzen.

Das Resultat von Bild 2 wollen wir jetzt durch POKEn der ASCII-Werte in den Tastaturpuffer wiederholen.

TODO

5	POKE 198,5
10	POKE 631,65
20	POKE 632,156
30	POKE 633,66: POKE 634,17: POKE 635,67
99	END

Prinzipiell macht dieses Programm das gleiche wie das Programm in Bild 2. Trotzdem erhalten wir nach LIST und RUN ein anders Ergebnis, nämlich das von Bild 3.

Ist das ein Fehler? Natürlich nicht. Nach RUN laufen zuerst mal alle POKE-Befehle ab. Zeile 5 gibt an, wieviele Zeichen im Puffer stehen sollen. In Zeile 99 findet das Programm das ENDe und meldet sich mit READY. Jetzt erst wird im Tastaturpuffer nachgeschaut. Dort findet der Computer zuerst das A, dann »purpur«, dann das B welches sofort neben das A gesetzt wird. Das ist auch logisch, denn es fehlt ja jede Angabe, eine Zeile tiefer zu gehen. Um das zu erreichen, müssen wir in der Zeile 10 den Codewert für RETURN einschieben:
10 POKE 631,65: POKE 632,13

Vorsicht! Sie müssen in Zeile 20 und 30 alle POKE-Adressen um 1 erhöhen und auch die Zahl in Zeile 5. Nehmen sie 10, dann haben Sie Platz für Erweiterungen. So, jetzt LIST und RUN eingeben und es erscheint Bild 4 — und wir haben schon wieder ein Problem! Aber alles im Computer ist logisch! Nach dem A findet er den Wert für »RETURN« also führt er den Befehl aus, auf dem der Cursor gerade steht. Der steht auf dem A. Da das kein gültiger Basic-Befehl ist, druckt der Computer die Fehler-Meldung und zeigt READY an. Danach allerdings macht er weiter wie oben.

Und jetzt kommt die ASCII-Zahl 141 (SHIFT-RETURN) voll zur Geltung. Diese Kombination nämlich setzt den Cursor an den Anfang der nächsten Zeile, ohne den Befehl »RETURN« auszuführen.

Ersetzen Sie also die 13 in Zeile 10 durch 141, dann läuft’s (Bild 5).

Es gibt übrigens noch eine interessante ASCII-Codezahl, die in keiner Tabelle steht, nämlich 131. Sie bedeutet dasselbe wie die geSHIFTete STOP-Taste, also die Funktion »LOAD + RUN«.

Wenn Sie diesen Code mit PRINT CHR$(131) ausprobieren, funktioniert er allerdings nicht. Deshalb steht er wohl auch nicht in den Tabellen.

In den Tastaturpuffer gePOKEt bringt er aber seine Wirkung.

Setzen Sie bitte in Zeile 30 an die Stelle von 67 die Zahl 131 und anstelle des C erscheint

LOAD und PRESS PLAY ON TAPE. Gut, nicht wahr?

So, jetzt haben wir alle Zutaten für unser Kochrezept zusammen.

Löschen Sie bitte alles bisherige und tippen Sie ein:

TODO

10 PRINT CHR$(147)
20 FORI=lTO5:PRINTI
30	FOR T=1 TO 500: NEXT T
40 NEXT I

Nach Löschen des Bildschirms (Zeile 10) drucken wir zum Ausschmücken die Zahlen 1 bis 5 untereinander (Zeile 20 und 40) und damit es nicht zu schnell geht, bremsen wir mit der Zeile 30.

TODO

50	PRINT ”LIST”	(Das ist natürlich sehr einfach, aber jetzt kommt’s!)
60	POKE 198,5
70	POKE 631,145:	POKE 632,	145:	POKE 633,145
80	POKE 634,13
90	END

Nach RUN erscheinen erst die fünf Zahlen, dann wird in einer neuen Zeile das Wort LIST geschrieben. Nach END wird erst (wie immer) eine Zeile ausgelassen, dann READY gedruckt und schließlich springt der Cursor an den Anfang der Zeile darunter. Während der Cursor anfangen will, drei Zeilen unter dem Wort LIST zu blinken, findet der Computer im Tastaturpuffer 3 den ASCII-Code für »Cursor up«. Also geht dieser auch drei Zeilen hoch und will jetzt auf dem Wort LIST blinken.

Damit wird es aber wieder nichts, denn im Puffer steht ja noch der Code für RETURN (13). Das wird ausgeführt und zwar für das LIST. Es hat dieselbe Wirkung, als ob Sie direkt LIST tippen und danach auf die RETURN-Taste drücken, nämlich das Programm wird ausgeLISTet.

Alle sinnvollen Basic-Befehle, die Sie in der Zeile 50 PRINTen, werden durch diese dynamische Manipulation des Cursors ausgeführt.

Versuchen Sie es mit

TODO

50	PRINT "PRINT 16 * 35”
50	PRINT ”LOAD”
50	PRINT ”GOTO 10”
50	PRINT ”RUN”
50	PRINT ”RUN 50”

und falls Sie dieses kleine Programm geSAVEt haben

TODO

50	PRINT ”SYS 64824”
50	PRINT ”SYS 64763”

Die Kunst ist also, mit entsprechenden Codezahlen den Cursor an diejenige Stelle des Bildschirms zu bringen, wo innerhalb eines Programms eine geeignete Anweisung gedruckt worden ist. Man kann damit getrennte Programmteile nachladen, mit SYS-Befehlen Maschinenprogramme aufrufen, oder gar Programme durch sich selbst ändern lassen.

# Logeleien (Teil 1) [143-146]

> In vielen Basic-Programmen tauchen sie auf, die logischen Operatoren wie NOT, AND und 0R. Bei sinnvollem Einsatz kann man eine Menge Basic-Speicherplatz sparen. Aber auch Ausdrücke wie IF A THEN ... bringen nicht nur den Anfänger manchmal ins Schleudern. Was steckt eigentlich im Endefekt dahinter?

Das hätte sich der »Vater der Logik«, Aristoteles, vor 2200 Jahren nicht träumen lassen können, was aus seinen Gedankengängen einmal werden würde. Man kann aber mit einiger Berechtigung behaupten, daß es ohne seine Werke und die von Leibniz (vor etwa 300 Jahren hat dieser die Logik modernisiert) keine Computer gäbe. Die Arbeiten der Begründer der mathematischen Logik, Boole (1815-64) und Frege (1848-1925), basieren auf dem jahrtausende alten Fundament. Wie für den Computer geschaffen — aber eigentlich ist es umgekehrt: Die logische Maschine ist ein Produkt der mathematischen Logik — ist die sogenannte zweiwertige Logik. Hier geht es um »Wahr« und »Falsch«, ein drittes gibt es nicht (tertium non datur, wie die alten Philosophen zu sagen pflegten). Die Verwandtschaft liegt auf der Hand: Die elektronische Maschine kennt die Zustände Strom an/Strom aus oder Ladung vorhanden/nicht vorhanden oder eben einfach 1 und 0, die Ziffern der Binärarithmetik.

Dazu noch eine technische Bemerkung: Sollten Sie mit dem System der binären Zahlen noch nicht vertraut sein, dann lesen Sie den beigefügten Kasten, in dem die wichtigsten Begriffe erklärt sind.

### 1.	Wahrheitswerte und Aussagen

Was sind Aussagen? Am besten sehen wir uns einfach einige Beispiele an:
* Rosen sind rot
* Die Zahl ist größer als 100.

Das sind einfache Aussagen. Eine zusammengesetzte Aussage ist beispielsweise:

Rosen sind rot **UND** Veilchen sind blau. Hier wurden zwei Aussagen UND-verknüpft. Keine Aussage ist:

* Wohin gehst Du?

Ich hoffe, daß auf diese Weise ohne tiefschürfende philosophische Erörterungen (denn die gibt es natürlich) das Wesen von Aussagen klar geworden ist.

Aussagen können wahr sein. Sie enthalten dann den Wahrheitswert »Wahr«. Sie können aber auch statt dessen falsch sein, was ihnen den Wahrheitswert »Falsch« verleiht. Der Wahrheitswert von zusammengesetzten Aussagen hängt zum einen von den Wahrheitswerten der Einzelaussagen ab und zum anderen von der Art ihrer Verknüpfung. Wir werden im folgenden für die Wahrheitswerte die Buchstaben W (für Wahr) und F (für Falsch) verwenden.

In der binären Arithmetik entspricht die 1 dem W und die 0 dem F. Keine Angst, falls Ihnen das noch unverständlich erscheint, wir werden noch allerlei Logeleien mit Binärzahlen treiben. Dann wird Ihnen das ganz geläufig sein. Was uns momentan interessiert, ist, wie der Computer Wahrheitswerte angibt. Dazu machen wir einen kleinen Test mit dem folgenden Programm:
10 INPUTA,B
20 C=(A=B)
30 PRINTA,B,C

In Zeile 20 ist eine Aussage enthalten: A = B. Wenn Sie A und B so eingegeben haben, daß beide gleich sind, dann ist diese Aussage wahr (W), und in C finden Sie den Wahrheitswert, den der Computer für W verwendet. Probieren Sie dies mal aus: Sie finden —1! Wenn aber A und B verschiedene Zahlen waren, ist die Aussage A = B falsch, und in C steht 0, was die Computerform von F ist. Weshalb —1 als Wahrheitswert des Commodore 64 für W? Das liegt daran, daß unser Computer für den Wahrheitswert ein ganzes Byte reserviert. Das schreibt er im Falle W voller Einsen:
1111 1111

Nach den Regeln von vorzeichenbehafteten Binärzahlen ist das aber die Erscheinungsform von —1.

### 2.	Das merkwürdige IF A THEN ...

Bei IF..THENVerzweigungen wird vom Computer der gesamte Ausdruck zwischen IF und THEN auf seinen Wahrheitswert untersucht (das kann dann eine Aussage sein, aber auch etwas anderes, zum Beispiel eine Variable). Dabei nimmt der C 64 alles für wahr an, was bei dieser Untersuchung ungleich Null ist.

Wenn also in einer Verzweigung der Form:
IF A THEN ...
A schon irgendeinen Wert angenommen hat, der ungleich Null ist, wird die Bedingung als erfüllt angesehen. Probieren Sie mal mit verschiedenen Eingaben für A:
10 INPUT A
20 IF A THEN PRINT ”TEST”
30 PRINT A

In der uns geläufigeren Form dieser Verzweigung tauchen zwischen IF und THEN Aussagen in mathematischer Form auf, in denen die Vergleichssymbole verwendet werden, zum Beispiel:
IF A > = 100 THEN GOTO ...

### 3.	Rechnen mit Wahrheitswerten

Außerhalb solch einer Verzweigung ist es manchmal gar nicht so einfach festzustellen, ob es sich bei einem Ausdruck um eine Aussage dreht oder vielleicht nur um eine Zuweisung. Es kommt hier sehr auf den Zusammenhang mit dem übrigen Programmtext an. Beispielsweise kann A = B sowohl eine Zuweisung sein (LET A = B) als auch eine Aussage (C = (A = B)). In Programmen, in denen viel mit logischen Operatoren gearbeitet wird, empfiehlt sich deshalb — um mehr Klarheit zu schaffen —, die vom C 64 verstandene, aber so gut wie nie verwendete Basic-Vokabel LET bei Zuweisungen zu verwenden.

Ein noch eklatanteres Beispiel ist enthalten in A = 5 + 2. Das ist offensichtlich keine Aussage, könnte deutlicher aber noch als LET A = 5 + 2 geschrieben werden. In einem anderen Zusammenhang ist es eine Aussage: C = 4 + (A = 5 + 2)

Ist hier A = 5 + 2 wahr (wenn A = 7), ergibt sich ein C von 3, weil ja der Wahrheitswert der Aussage —1 beträgt. Im anderen Fall ist C = 4. Man kann mit Aussagen — besser gesagt, mit ihren Wahrheitswerten — also auch rechnen.

Im folgenden Programmbeispiel sind gleich fünf Wahrheitswerte miteinander rechnerisch verknüpft. Es handelt sich um eine kurze Routine zur Umrechnung von ASCII-Code in Bildschirmcode:
10 INPUT”ASCII-WERT”;A
20 C = A-161-33*(A<255)-64*(A < 192)-32*(A < 160) + 32*(A < 96)-64*(A<64)
30 PRINT”ASCII = ”A,”POKE-CODE="C

Beispiel: ASCII = 65, Bildschirmcode = 1

Aussagen können auch mit Strings gebildet werden. Auch dabei ergeben sich die Wahrheitswerte —1 oder 0. Allerdings lassen sich hier sinnvoll nur die Vergleichsrelationen »=« und »ungleich« einsetzen. Alle anderen »größer als«, »kleiner als« etc. sind mit Vorsicht zu genießen. Zur Ermittlung des Wahrheitswertes werden nämlich von links nach rechts alle Buchstaben beider Strings in Form ihrer ASCII-Werte miteinander verglichen. Die erste auf diese Weise gefundene Abweichung führt dann zum Ergebnis. Ein Beispiel soll das Problem verdeutlichen:

Die Aussage (A$<B$) soll uns einen Wahrheitswert liefern. Wenn nun A$ = "DZZZ" und B$ = ”EAAA” definiert wurden, ergibt sich —1 als Wahrheitswert, weil der ASCII-Wert von D kleiner ist als der von E. Der Rest der Strings spielt keine Rolle mehr.

### 4.	Die logischen Operatoren in Basic

Drei Operatoren haben wir im Normalfall zur Verfügung für die sogenannte Boolesche Algebra, wie man manchmal auch das Rechnen mit logischen Operatoren nennt:
**NOT, AND, OR**

Die Tabelle 1 zeigt, wo in der Prioritätenreihenfolge aller Operatoren diese drei einzuordnen sind. Ebenso wie bei den arithmetischen Operatoren ( + ,*,t etc.) kann auch hier die Reihenfolge durch sinnvolle Anwendung von Klammern verändert werden.

### 5.	Wahrheitstabellen

Jede Verkoppelung von Aussagen (beziehungsweise ihren Wahrheitswerten) mittels logischer Operatoren ergibt ebenfalls wieder Wahrheitswerte. Wir hatten vorhin schon erwähnt, daß das Ergebnis abhängt:
a)	von den Wahrheitswerten der zu verknüpfenden Aussagen und
b)	von der Art der Verknüpfung.

Das kann manchmal schon reichlich schwer zu durchschauen sein, was welche Kombination ergibt. Deshalb schreibt man sich eine Übersicht, die alle möglichen Ausgangs-Wahrheitswerte enthält und die nach der Verknüpfung entstandenen Wahrheitswerte. Solche Tabellen nennt man Wahrheitstabellen. Wir werden diese Tabellen im folgenden bei der Erklärung der logischen Operatoren verwenden. Wie man sie erstellt und liest, wird Ihnen schnell geläufig sein.

Noch eine Bemerkung: Die Anwendung der logischen Operatoren auf Aussagen und auf Zahlen wird bei uns — aus Gründen der besseren Verständlichkeit — getrennt behandelt werden. Das ist eigentlich nicht nötig, denn im Grunde genommen sind ja die Wahrheitswerte von Aussagen auch nur Zahlen.

### 6.	Die Anwendung von NOT auf Aussagen

Der NOT-Operator erzeugt immer das Gegenteil des Wahrheitswertes der Ausgangsaussage. Wenden wir also NOT auf eine Aussage mit dem Wahrheitswert W an, dann ergibt das den Wert F. Dasselbe geschieht im umgekehrten Fall.

Dazu wollen wir uns eine Wahrheitstabelle schreiben (Tabelle 2). In der linken Spalte sind die beiden möglichen Wahrheitswerte einer Aussage A aufgeführt. Die rechte Spalte ergibt sich durch Anwendung von NOT auf die Werte der linken Spalte:
NOT W = F
NOT F = W

Das ist gar nicht so schwer, nicht wahr? An einem Beispiel wollen wir uns das auch noch mal ansehen. Die Zeile:
10 A = (3 = 5):PRINT NOT A
ergibt den Wert —1. Die Aussage 3 = 5 ist ja falsch (F oder für den Computer 0) und A deshalb 0. NOT A ergibt dann das Gegenteil, also W oder —1.

Eine Basic-Zeile wie die folgende:
10 A = NOT A
kann man wie einen Flip-Flop-Schalter einsetzen, falls man den Wahrheitswert von A zuvor als 0 oder —1 definiert hat. Jedesmal, wenn das Programm über diesen Ausdruck läuft, kippt der Wert von A.

### 7.	NOT auf Zahlen angewendet

Zahlen oder Variable, auf die der NOT-Operator angewandt wird, verkehren sich in ihr Einerkomplement. Falls Sie mit den Begriffen »Einerkomplement« und »Zweierkomplement« Schwierigkeiten haben, weise ich Sie nochmal auf den hier abgedruckten Kasten mit Erläuterungen hin. Jedes Bit wird also »gekippt«. Aus einer 0 wird 1 und umgekehrt. Die Wahrheitstabelle kann hier ähnlich aufgestellt werden wie für Aussagen, nur tauchen hier anstelle von W und F nun 1 und 0 (also die Bitwerte) auf (siehe Tabelle 3).

Eine Anwendung von NOT wäre beispielsweise das gezielte Kippen von Bytes oder 2-Byte-Werten. Besonders bei Sprite-Programmen ist sowas denkbar. Nehmen wir mal an, wir hätten acht Sprites definiert, von denen vier bis zu einem bestimmten Ereignis sichtbar sein sollen. Die anderen vier sind solange abgeschaltet. Wenn das Ereignis (Tastendruck oder Zusammenstoß ...) eintritt, werden die obersten vier ab- und gleichzeitig die anderen vier angeschaltet. Register 21 (53269) des VIC-II-Chip stellt für jedes Sprite ein Schalt-Bit zur Verfügung (0 steht dort für ein ausgeschaltetes und 1 für ein aktiviertes Sprite). Sollen also zuerst die Sprites 0,2,4,6 an- und 1, 3, 5, 7 abgeschaltet sein, dann enthält Register 21 das Bit-Muster:
0101 0101

Darauf nun eine NOT-Operation angewendet ergäbe genau das erwünschte Kippen: 1010 1010 nach NOT.

Es läge daher nahe, etwa so zu programmieren:
POKE 53269,NOT PEEK(53269)

Leider ist das nicht möglich. Versucht man es trotzdem, erhält man einen ILLEGAL QUANTITY ERROR. Woran liegt das? Die Ursache dafür liegt wieder in der Eigenart, wie der C 64 Integer-Zahlen interpretiert. Zwar erzeugt die NOT-Operation das Einerkomplement der Ausgangszahl, verstanden wird dieses Ergebnis aber als Zweierkomplementzahl. Daraus folgt, daß man mit der obigen Anweisung versucht, eine negative Zahl in die Speicherstelle zu POKEn, und da streikt unser Computer. Die Binärzahl 1010 1010 wird als —86 verstanden. Was kann man tun, daß der wahre Wert, also 170, in den Speicher gePOKEt wird? Bei 1-Byte-Zahlen ist das relativ einfach: Man wandelt sie durch Abziehen von 256 in eine 2-Byte-Zahl um, also NOT(A-256). In Bild 2 ist zu sehen, was dabei geschieht.

Ein anderer Weg für 1-Byte-Zahlen (also Zahlen, die kleiner als 255 sind) ist NOT A AND 255, was wir aber erst später verstehen werden, wenn wir die AND-Operation kennengelernt haben. Vorsicht muß man walten lassen, wenn auch negative A-Werte auftreten. Negative A können ohne Probleme der NOT-Operation unterzogen werden, weil das Ergebnis in jedem Fall positiv ist. Verwendet man NOT(A-256), kommt es zu Fehlern. Der Weg über NOT A AND 255 ist auch mit negativen 1-Byte-Zahlen möglich. Am sichersten wäre also diese Basic-Zeile:
POKE53269,NOTPEEK(53269)AND255

2-Byte-Zahlen spielen bei POKEs keine Rolle, weshalb wir auf die Umwandlung der negativen Zahl in den vorzeichenfreien Ausdruck hier nicht eingehen werden. Eine andere Sache muß bei der Anwendung von NOT noch bedacht werden: Diese Operation arbeitet mit Integer-Zahlen. Treten nun als Argumente »Komma-Zahlen« auf, dann führt der C 64 zuerst eine INT-Operation aus, die unter Umständen zu Fehlern führen kann: 3999 ergibt dann ein deutlich anderes Ergebnis als 4001.

Die NOT-Operation kann nur auf Zahlen, nicht aber auf Strings angewendet werden. Allerdings erfolgt die computerinterne Speicherung von Buchstaben ja als ASCII-Werte, also auch als Zahlen. Wenn wir daher die ASCII-Codes eines Textes der NOT-Verknüpfung unterziehen, haben wir auch Strings dieser Operation zugänglich gemacht. Genau das tut ein kleines Demo-Programm (Programm Logik-1): Es ver- und entschlüsselt Texte mittels NOT.

In diesem Demo-Programm wird Text Buchstabe für Buchstabe in die ASCII-Werte übertragen und diese dann durch NOT komplementiert und in C$ gespeichert. Der Ausdruck ist dann ein unverständliches Kauderwelsch, das aber durch eine zweite NOT-Operation wieder lesbar wird.

### 8.	Eine kleine Hilfe

Als Programm Logik-2 finden Sie eine kleine Denk- und Rechenhilfe hier abgedruckt. Dieses Programm kann Zahlen zwischen —32767 und +32767 den logischen Verknüpfungen unterziehen und zeigt Ihnen dabei, was sich im Binärformat abspielt und wie die Argumente — falls negative Zahlen auftreten — im vorzeichenfreien Format aussehen. Nach dem RUN bietet Ihnen ein Menü fünf Möglichkeiten an: NOT, AND, OR, EOR und Programmende. NOT kennen Sie ja schon, die anderen logischen Operatoren werden Ihnen in der nächsten Folge geläufig werden. Dort wird Ihnen dieses Programm dann einige Hilfestellungen geben für etwas kompliziertere Sachverhalte. Wenn Sie eine Option angewählt haben, werden zwei Zahleneingaben verlangt (bei NOT nur eine) und dann die entsprechenden Binärzahlen, die vorzeichenfreien Formen und das Ergebnis der Verknüpfung ausgedruckt. Innerhalb der gesteckten Grenzen sind alle Zahleneingabe-Formate möglich. Ein Tastendruck bringt Sie wieder ins Menü zurück.

In der nächsten Folge werden wir uns die Operatoren AND und OR ansehen. Ein in dem WAIT-Befehl versteckter weiterer Operator EOR soll aufgespürt werden, und wir werden wieder einige Anwendungen der Boole’schen Algebra in unserem Computer kennenlernen.

(Heimo Ponnath/gk)



TODO ASIDE

## Einige Erläuterungen zum Rechnen mit Binärzahlen

### a)	Dezimales und binäres Zahlensystem

Wir sind es gewohnt, im dezimalen Zahlensystem zu rechnen unter Verwendung der Ziffern 0 bis 9. Die Grundlage unseres Zahlensystems ist die Zahl 10. Reichen die Ziffern 0 bis 9 nicht aus, um eine Zahl (zum Beispiel 9 +1) darzustellen, dann führen wir den Stellenwert einer Zahl ein. Hierbei hat jede Stelle in einer Zahl einen Faktor, der sich berechnet aus 10<sup>Stelle</sup>. Zum Beispiel in der Zahl 132 befindet sich die Ziffer 2 an der nullten Stelle, und sie wird mit dem Faktor 10<sup>0</sup> multipliziert (10<sup>0</sup> = 1). Für unsere Beispielszahl können wir so schreiben:
132 = 1*10↑2 + 3*10↑1 + 2*10↑0 = 1*100 + 3*10 + 2*1

Nach demselben Prinzip wird im Binärsystem verfahren. Hier gibt es allerdings nur die Ziffern 0 und 1. Die Grundlage dieses Systems ist die Zahl 2. Auch hier spielt der Stellenwert die entscheidende Rolle. Der Faktor ist nun aber die entsprechende Zweierpotenz (2tStelle). Die Binärzahl 110 beispielsweise setzt sich dann so zusammen: 110 = 1*2↑2 + 1*2↑1 + 0*2↑0
= 1*4 + 1*2 + 0*1 = 6

### b)	Umrechnung Binär- in Dezimalzahl

Damit haben Sie praktisch schon gesehen, wie man Binärzahlen in Dezimalzahlen umrechnen kann: Jeder Stelle entspricht eine Zweierpotenz. Alle Zweierpotenzen, an deren Stelle eine 1 steht, werden zusammengezählt. Dabei gilt: 2<sup>0</sup> = 1 (siehe Bild 1).


### c)	Umrechnung Dezimal- in Binärzahl

Der umgekehrte Weg läßt sich durch eine Kettendivision der Dezimalzahl durch 2 realisieren. Jeweils die Divisionsreste ergeben eine Stelle der Binärzahl. Beispiel (die Zahl 29):

Die Kettendivision ist beendet, wenn sich als Ergebnis 0 zeigt. Die Zahl 29 lautet also im Binärformat 11101.

### d)	Bits und Bytes

Eine Stelle einer solchen Binärzahl nennt man ein »Bit«. Unser Computer ist so gebaut, daß er 8 Bit zu einer Einheit zusammenfaßt. Solch eine Einheit ist em Byte. Jede Speicherstelle des C 64 faßt genau ein solches Byte. Weil aber die größte in einem Byte darstellbare Zahl binär 11111111 ist — was dezimal 255 entspricht (rechnen Sie mal nach) —, meldet unser Computer einen ILLEGAL QUANTITY ERROR, wenn wir versuchen, eine größere Zahl in eine Speicherstelle zu POKEn.

Der C 64 ist darauf eingerichtet, ganze Zahlen als 2-Byte-Werte (also mit 16 Bit) zu verarbeiten. Die auf diese Weise größte darstellbare Zahl ist 11111111 11111111, was 65535 entspricht. Das ist übrigens genau die Anzahl der Speicherstellen unseres Computers. Allerdings erlaubt der C 64 bei Integerzahlen lediglich Eingaben zwischen 32767 und —32768. Die Ursache dafür ist die Art, wie negative Binärzahlen erzeugt und gespeichert werden.

### e)	Negative Binärzahlen

Bit 7 (also das ganz links stehende Bit eines Bytes: Die Zählung fängt rechts mit 0 an) einer 8-Bit-Zahl oder Bit 15 einer 16-Bit-Zahl wird als Vorzeichenkennung verwendet. Ist dieses Bit eine 0, dann liegt eine positive, ansonsten eine negative Zahl vor. Die Binärzahl 0111 1111 1111 1111(32767) ist daher die größte vorzeichenbehaftete 16-Bit-Binärzahl. Wenn also Bit 7 (oder bei der 16-Bit-Zahl Bit 15) eine 1 enthält, handelt es sich um eine negative Zahl. Unser Computer hat aber eine besondere Art, solche negativen Zahlen zu verstehen: Er interpretiert sie als »Zweierkomplementzahlen«. Ein Beispiel, in dem wir die Zahl —29 in dieses Format bringen, soll erläutern, worum es sich dabei handelt:
Schritt 1:

Man berechnet zuerst die Binärzahl der positiven Zahl, also von 29:
0000 0000 0001 1101
Schritt 2:

Davon wird nun das sogenannte Einerkomplement gebildet, wobei jedes Bit in sein Gegenteil verkehrt wird:
1111 1111 1110 0010
Schritt 3:

Aus dem so erhaltenen Einerkomplement bildet man das »Zweierkomplement« durch Addieren einer 1:

TODO

Das Ergebnis ist —29 im Zweierkomplement-Format.
Hat man eine Zahl im Zweierkomplementformat vorliegen, dann kann man auf genau demselben Weg ihren Wert feststellen. Das wollen wir uns noch an einer 8-Bit-Zahl ansehen:
Schritt 1:

Es liegt eine Binärzahl vor, die so aussieht:
1111 1110
Schritt 2:
Das Einerkomplement wird gebildet:
0000 0001
Schritt 3:

Das Zweierkomplement wird durch Addieren von 1 erzeugt:

TODO

Schritt 4:

Umrechnen der Binärzahl in die Dezimalzahl ergibt hier den Wert 2. Das Vorzeichen war negativ (Bit 7 ist ja 1 in der ursprünglichen Zahl). Es handelte sich also um die Zahl -2.

# Terminalprogramm der Spitzenklasse [149,151-154]

> Eine harte Nuß haben wir unseren Lesern mit diesem Wettbewerb zu knacken gegeben. Trotzdem erreichten uns viele Einsendungen als Anwärter auf den ersten Preis.

TODO ASIDE

## Lebenslauf

Ich wurde am 15.9.1966 geboren. Heute gehe ich in die 12. Klasse des Ratsgymnasiums in Stadthagen. Bevor ich mich mit dem Computer beschäftigte, hatte ich die Hobbys Modelleisenbahn und Elektronik. Weiterhin bin ich noch Modellflieger.

Den C 64 habe ich seit einem Jahr. In dieser Zeit lernte ich zunächst Basic und Pascal, was auch bei uns in der Schule im Informatikunterricht verwendet wird. Seit einiger Zeit beschäftige ich mich mit Assembler.

Vor zirka einem halben Jahr kaufte ich mir einen Akustikkoppler. Da ich kein passendes Terminalprogramm fand, begann ich mir ein eigenes Programm zu schreiben. Dieses wurde dann immer mehr erweitert, bis es die heutige Form hatte.

(Peter Falk)

TODO ASIDE

Peter Falk konnte mit seinem Programm »Super Term 64« diesen Wettbewerb für sich entscheiden. Besonders erwähnenswert ist neben der Leistung dieses Programmes der übersichtliche und gut durchschaubare Programmierstil.

Der Autor: »Ich habe bei dem Terminal-Programm einerseits darauf Wert gelegt, daß es möglichst komfortabel und benutzerfreundlich ist, andererseits war mir aber auch ein großer Terminal-Speicher sehr wichtig. Deswegen habe ich auf unnötige »Verzierungen« verzichtet. So kann man bei den Übertragungs-Parametern zum Beispiel nur Baudrate, Datenbits und Stop-Bits in begrenztem Umfang ändern. Ich habe jedoch die Erfahrung gemacht, daß man bei allen Mailboxen eine einwandfreie Verbindung hat, wenn man die Normalparameter (300 Baud, 7 Bit, 1 Stop-Bit) benutzt. Der C 64 empfängt nämlich auch dann richtig, wenn er zum Beispiel auf 7 Datenbit eingestellt ist und die Gegenstelle mit 8 Bit sendet. Nur wenn man auch Steuerzeichen übertragen will, muß man auf 8 Datenbit umstellen.

Der große Terminal-Speicher wurde unter anderem dadurch erreicht, daß der gesamte vom ROM überlagerte RAM genutzt wird, indem das Betriebssystem beim Zugriff auf den RAM mit einer Assembler-Routine abgeschaltet wird. Weitere Maschinen-Routinen werden für das Laden von Daten in den Terminal-Speicher und für das Listen des Directorys benutzt. Sie werden alle über DATA-Zeilen im Lader eingelesen, so daß sie nachher keinen Speicherplatz mehr verbrauchen.

Bei der Programm-Übertragung nach der »Teleterm-Norm« können natürlich die selben Fehler auftreten wie bei Teleterm, nämlich dann, wenn sich zwei Übertragungsfehler in einem Block gegenseitig aufheben. Trotzdem ist die Übertragungs-Routine etwas sicherer als bei Teleterm. Am Anfang der Übertragung kann man die Länge einer Übertragungseinheit einstellen (bei Teleterm: »Programmsatzlänge«). Bei einer guten Verbindung kann sie ruhig auf 256 Byte gestellt werden; die Übertragung ist dann etwas schneller.«

## Ladeprogramm

Nachdem man den Lader geladen und mit RUN gestartet hat, werden die Funktionstasten-Belegungen von der Diskette geladen, soweit sie schon vorhanden sind. Ansonsten wird der F-Tasten-Speicher gelöscht. Danach erscheint ein Menü, in dem man zwischen dem Terminal-Programm und dem Editor wählen kann. Wenn man 1 oder 2 gedrückt hat, wird das jeweilige Programm geladen und automatisch gestartet.

In die ersten Programmzeilen des Laders kann man individuelle Parameter schreiben. So kann man in Zeile 90 Hintergrund- und Rahmenfarbe eingeben (Schriftfarbe muß schwarz bleiben), in Zeile 110 den Preis für eine Telefon-Gebühreneinheit ändern und in den Zeilen 30 und 40 kann man Parameter zur Druckeranpassung eingeben (Sekundäradresse und maximal fünf sonstige Parameter).

In den Zeilen 350 bis 580 werden die Assembler-Routinen für Speicherzugriff, LOAD und Directory eingelesen.

Die vorhandenen Druckerparameter sind für einen Epson-Drucker mit Görlitz-Interface zugeschnitten (Sekundäradresse: 0, Parameter: »chr$(27)”t”«, also 27, 32, 84).

## Terminalprogramm

Das Terminal-Programm muß mit dem Lader geladen werden, damit es funktionstüchtig ist. Im folgenden werden die einzelnen Menüpunkte erklärt:
1.	Kommunizieren

Nachdem man 1 gedrückt hat, muß man eingeben, ob die Gegenstelle mit oder ohne Echo arbeitet. Danach wird man gefragt, ob man eine Berechnung der Telefongebühren wünscht. Wenn ja, dann müssen die Gebührenzone und der Gebührentarif (vor oder nach 18 Uhr plus Wochenende) eingegeben werden. Nachdem man die Verbindung hergestellt hat (was ja durchaus etwas länger dauern kann!), startet man den Terminal-Modus mit einem Tastendruck (die —-Taste führt ins Menü zurück). Im Terminal-Modus wird nun eine Help-Liste ausgegeben, in der alle Funktionen aufgeführt sind, die man über »Commodore«-Taste ansprechen kann. **»Commodore S«** bewirkt, daß alle empfangenen Zeichen in den Terminal-Speicher geschrieben werden, der eine Größe von 46000 Byte hat. Auf ein automatisches Abspeichern habe ich wegen der Time-Out-Regelung der meisten Mailboxen verzichtet. Außerdem muß man schon ganz schön lange telefonieren, um den Speicher voll zu bekommen. **»Commodore E«** beendet den Speichervorgang wieder.
**»Commodore A«** bewirkt, daß der Inhalt des Terminal-Speichers ausgesendet wird. So kann man zum Beispiel vorher abgefaßte Briefe übertragen. Abbruch mit ’ *- ’. Auch Basic-Programme, die in einer Sequenz vorliegen, können so übertragen werden. Diese Prozedur reagiert auf die Steuerzeichen
CTRL - S = Stop
CTRL - Q = Weiter
CTRL - X = Abbruch
**»Commodore L«** löscht den Terminal-Speicher.
**»Commodore B«** gibt an, wieviele Bytes im Speicher schon belegt und wieviele noch frei sind.
**»Commodore G«** zeigt die Zeit und die Gebühren an, die schon »vertelefoniert« sind.
**»Commodore H«** gibt die angezeigte Help-Liste nochmals aus.
**»Commodore P«** bietet eine Besonderheit: In diesem Modus ist es möglich Basic- und Maschinen-Programme zu übertragen und zwar nach der »TELETERM-Norm«. Man kann sich jetzt also Programme aus Mailboxen holen, die eine Teleterm-Box besitzen (zum Beispiel K.I.S., R.T.C., MHB etc.) oder man kann Programme unter Freunden und Bekannten austauschen, ohne Teleterm benutzen zu müssen. Es ist so eine weitgehend fehlerlose Übertragung von Programmen möglich.

Statt »Commodore £« und »1« bei Teleterm muß man hier »Commodore P« und »E« für empfangen drücken.
**»Commodore ↑«** unterbricht den Terminal-Modus, das heißt man kann jetzt alle Menüpunkte anwählen, ohne daß die eingestellten Parameter und die Gebühren verloren gehen. Man kann so also auch während man mit einer Mailbox kommuniziert, die anderen Menüpunkte ausführen.
**»Commodore ←«** beendet den Terminal-Modus. Hier werden jetzt die Zeit und die Gebühren angezeigt und abgespeichert, und dann der Gesamtbetrag angezeigt.
2.	Daten speichern

Hier wird der Inhalt des Terminal-Speichers auf Diskette gespeichert. Man muß dafür den Namen angeben, unter dem abgespeichert werden soll.

RETURN bewirkt den Rücksprung ins Menüs.
3.	Entspricht Punkt 2, nur daß hier geladen wird.
4.	Daten ausgeben

Unter diesem Menüpunkt wird der Inhalt des Terminal-Speichers auf dem Bildschirm oder dem Drucker ausgegeben.
F1 = Ausgabe auf dem Bildschirm
F3 = Ausgabe auf dem Drucker
F5 = Bildschirm-Hardcopy
← = Menü

SPACE hält die Ausgabe an. Sie kann dann mit einer beliebigen Taste fortgesetzt werden.
5.	Funktionstasten

Hier kann man sich eine Übersicht der F-Tasten-Belegungen ausgeben lassen und sie gegebenenfalls ändern und abspeichern.
6.	Parameter ändern

Die Baudrate und die Anzahl der Daten- und Stop-Bits können hier verändert werden.
7.	Gebühren ansehen

Wenn man mit der Gebühren-Berechnung arbeitet, kann man hier den abgespeicherten Gesamtbetrag abrufen und die Gebühren am Ablesetag löschen.
8.	Diskbefehle

Unter diesem Punkt kann man Befehle wie zum Beispiel Validate, Scratch, Rename etc. der Floppy übermitteln. Mit dem Dollarzeichen kann man das Inhaltsverzeichnis auflisten.

## Editor-Programm

Mit dem Editor kann man Anzeigen oder Briefe, die man in Mailboxen schreiben will, erstellen. Der Text wird nach dem Erstellen sofort in den Terminal-Speicher geschrieben, so daß er nicht erst auf Diskette gespeichert zu werden braucht, bevor man das Terminal-Programm lädt. Der Speicherplatz für Variablen ist deswegen nur so groß, daß der Editor maximal 100 Zeilen aufnehmen kann.

Wenn man den Menüpunkt 1 anwählt, wird man zuerst gefragt, ob der Terminal-Speicher gelöscht werden soll. Antwortet man mit »ja«, so kann man einen neuen Text schreiben. Ansonsten wird der Inhalt des Terminal-Speichers in den Editor übertragen. Hier kann man nun seinen Text eingeben und mit den Cursor-Tasten frei editieren. Man muß allerdings in jeder Zeile, die übernommen werden soll, RETURN drücken. Wenn der Cursor am Anfang einer Zeile steht, kann man vor dieser Zeile mit CTRL-I (Insert) eine Zeile einfügen und mit CTRL-D (Delete) kann man die Zeile löschen. Wenn die maximale Anzahl von 100 Zeilen erreicht ist, wechselt die Rahmenfarbe in Rot und es wird keine weitere Zeile mehr übernommen.

Die ←-Taste führt ins Menü zurück, nachdem der Text in den Terminal-Speicher geschrieben wurde.

Die anderen Menüpunkte entsprechen denen des Terminal-Programms.

(Peter Falk/rg)

TODO ASIDE

## Achtung! Achtung!

Die Qualitäten dieses Programmes zwangen uns zu einer etwas ungewöhnlichen Maßnahme.

Das hier abgedruckte Basic-Programm ist in dieser Form nicht lauffähig. Es muß erst mit dem Austro-Speed-Compiler compiliert werden. Was soll dann der Abdruck, beziehungsweise wer hat schon diesen Compiler, werden Sie wohl fragen. Nun, wir sind von diesem Terminalprogramm und seinen Leistungen überzeugt. Ein Abdruck der mit MSE einzugebenden compilierten Version würde mindestens zehn Seiten beanspruchen. Dies halten wir für nicht zumutbar. Um nun allen Lesern dieses Programm zugänglich zu machen, bieten wir in diesem Fall einen Extraservice. Alle, die an dem MSE-Listing interessiert sind, können dies gegen Einsendung eines Freiumschlages (DIN A6, frankiert mit 1,10 Mark) bei folgender Adresse anfordern:
Markt & Technik Verlag
Redaktion 64’er
Stichwort: Terminal
Hans-Pinsel-Straße 2
8013 Haar bei München

Eine weitere Möglichkeit, das Listing zu nutzen, bietet Ihnen natürlich auch der Leserservice. Auf der heftbegleitenden Diskette befindet sich natürlich auch die compilierte Version.

(rg)

# Commodore-Sportservice — Heimcomputer zur Turnierauswertung [157-160]

> Eine handvoll Unternehmen hat sich auf das Auswerten von Sportveranstaltungen spezialisiert. So auch der Commodore-Sportservice, der bei Veranstaltungen von Rang und Namen zu finden ist. Diesmal war er beim Berliner Springreiten, bei dem Conrad Homfeld den World Cup mit nach Hause nahm.

Sie kennen bestimmt die Spielstand-Einblendungen bei Sportübertragungen am unteren Rand Ihres Fernsehers. Was dahinter steckt, ist ein sehr großer Aufwand an Elektronik. Aber keine Riesen-Computer, sondern viele Kleine machen die Arbeit. Durch die Verwendung von Mikrocomputern wird das System so flexibel, daß jedes anfallende Problem damit gemeistert werden kann. Es ist ein großer Unterschied zwischen einer Hallenveranstaltung und einem Skirennen, bei dem Minusgrade nicht nur den Computern zu schaffen machen und die Anlage auf Pistenraupen durchgeschüttelt wird. Ebenso wechseln die Anforderungen an die Leistungsfähigkeit des Systems von Fall zu Fall.

Ein anderer Grund, der für ein System aus mehreren kleinen Computern spricht, ist die Fehlersuche. Denn ein großes System ist wesentlich servicefreundlicher, wenn es aus kleinen Einheiten zusammengesetzt ist. Stellen Sie sich vor, Sie hätten eine große EDV-Anlage bei einer Veranstaltung im Keller stehen und nur Terminals am Richterturm. Nun fällt ein Bauteil aus. Die anschließende Fehlersuche wird sich dann als sehr schwierig erweisen, da der Fehler erst lokalisiert werden muß. Außerdem liegt während der Reparaturzeit das System lahm und die Veranstaltung müßte unterbrochen werden. Im Gegensatz dazu lassen sich Fehler in einem System, das aus mehreren kleinen Computern zusammengesetzt ist, sehr schnell beheben. Man sieht schnell, welcher Computer defekt ist und tauscht ihn einfach gegen einen neuen aus. Dadurch kann ein Fehler so schnell behoben werden, daß der Außenstehende vielleicht gar nichts davon merkt.

Das System des Commodore-Sportservice besteht aus:
30 SX 64, der tragbaren C 64-Version mit integriertem Diskettenlaufwerk
25 CBM 8296 Personal Computer
25 CBM 4040 Floppy-Disk-Doppellaufwerken
25 MPP 1361 Drucker mit IEEE-Anschluß
2 Festplattenlaufwerke 20 MByte
8 Telefonmodems zur Fernübertragung von Daten
4 Videogeneratoren zur Fernsehdirekteinblendung
50 1701 Farbmonitore
6000 W Notstromversorgung, falls der Strom bis zu fünf Minuten ausbleiben sollte.

Mit diesen Geräten hat der Commodore-Sportservice, kurz COSS genannt, seit 1982 über 100nationale und internationale Sportveranstaltungen im europäischen Raum betreut und Veranstalter, Zuschauer, Presse und Fernsehen mit Informationen über den Wettkampf beliefert. Wenn beispielsweise Journalisten wissen möchten, wieviel ein Teilnehmer während des Wettkampfes schon an Prämien »kassiert« hat, können sie sich beim Sportservice jederzeit eine Gewinnliste holen.

Die SX 64-Computer werden vor allem bei Sportarten eingesetzt, die nach vielfältigen Kriterien beurteilt werden. Ein sehr gutes Beispiel dafür sind die nordischen Skimeisterschaften, wo verschiedene Disziplinen gleichzeitig ausgetragen werden. Es müssen dort viele Ranglisten gleichzeitig geführt werden: Skispringen, Langlauf, Biathlon, etc. Jeder SX 64 hat dazu ein Programm, das eine bestimmte Auswertung übernimmt.

Den Commodore-Sportservice gibt es seit Januar 1981, wo sich das Team mit der Betreuung des FIS-Slaloms der Herren in Lermoos profilieren konnte. Die siebenköpfige Mannschaft besteht aus Programmierern und Elektronikern, die auch die gesamte Software und Interface-Hardware entwickelt haben. Bei großen Vorhaben wird das Team entsprechend verstärkt, so daß auch schon mal 15 Mann Kabel hinter Deckenverkleidungen verlegen.

Inzwischen hat man bei Commodore Erfahrung mit alpinen und nordischen Skimeisterschaften, im Kanu-, Rad-, Reit- und Rudersport, bei Schwimmveranstaltungen und im Turmspringen. Bisher war die Betreuung von Veranstaltungen immer ein Erfolg für den Veranstalter und den COSS. Auch die Fernsehanstalten stellen dem Commodore-Sportservice ein sehr gutes Zeugnis aus.

Es werden aber nicht nur Zeitauswertungen gemacht. Die Computer nehmen dem Veranstalter auch viel organisatorische Arbeit ab. Zum Beispiel bei der Erstellung der Melde- und Startlisten. Die Melde- und Startlisten von Hand nach Klassen zu ordnen und mit Schreibmaschine zu tippen, kostet manuell sehr viel mehr Zeit.

Besonders kompliziert wird der Vorgang, wenn ein Reiter mit mehreren Pferden an einem Wettbewerb teilnehmen möchte. Der Reiter kann nämlich selbst bestimmen, mit welchen Pferden in welcher Reihenfolge er springen will. Das Reglement schreibt aber vor, daß zwischen zwei Durchgängen eines Reiters mindestens sechs andere Teilnehmer auf dem Parcour gewesen sein müssen. Bestehen nur vier oder fünf Reiter auf die selbst festgelegte Startreihenfolge, kommt die Meldestelle ins »Rotieren«.

Die Startliste ist aber nicht nur der einzige »Zusatzservice«. Ist eine Prüfung beendet, kann sofort eine Liste mit den Zwischenergebnissen gedruckt, vervielfältigt und verteilt werden. Diese Liste zeigt zugleich die Startreihenfolge der nächsten Prüfung.

## Bis zu 30 SX 64 in einem Informationssystem

Wie schon erwähnt, werden die SX 64 zum Erstellen von Punktelisten, Ranglisten, Startreihenfolgen verwandt, wenn eine große Informationsflut zu bewältigen ist. So liefert, etwa bei nordischen Skimeisterschaften, einer die augenblickliche Rangfolge im Sprunglauf, ein anderer die Langlaufergebnisse oder den Stand in der nordischen Kombination. Auch eine Aufstellung ausgeschiedener Teilnehmer der einzelnen Klassen kann erstellt werden.

Je nach Wichtigkeit wird der Videoausgang eines bestimmten SX 64 einem Videoverstärker (zur Ansteuerung von bis zu 50 Monitoren) zugeschaltet und das verstärkte Bild dem Infosystem zugeführt. Über dieses System werden Veranstalter, Teilnehmer und Zuschauer vom COSS mit aktuellen Informationen versorgt. Dazu werden, wo sich die Möglichkeit bietet, Farbmonitore aufgestellt. In Hallen oder in Korridoren (falls die Veranstaltung innerhalb eines Gebäudes stattfindet), in Sprecherkabinen von Rundfunkreportern und in Pressesälen. Über das Infosystem wird meist das momentane Geschehen mit einer aktuellen Auswertung gezeigt.

Über ein selbstentwickeltes Interface werden die SX 64 miteinander »vernetzt«, meist in Gruppen von fünf Computern. Die fünf Heimcomputer werden mitsamt dem Interface in einfach zu transportierenden HiFi-Turmartigen Schaltschränken untergebracht. Durch dieses vom COSS entwickelte Interface können die SX 64 auf eine der 20 MByte-Festplatten zugreifen und von dort ständig die neuesten Ergebnisse holen und auswerten. Es ist auch möglich, vom Richterturm aus, mit einem CBM 8296, den SX-64 Kommandos zu geben.

Das selbstentworfene Interface empfängt über eine V.24-Schnittstelle von einem CBM 8296 oder von Festplatte Daten und sendet sie über den User-Port an einen SX 64. Am User-Port wird softwareseitig eine 8-Bit-Parallelschnittstelle simuliert, die der Centronics-Norm recht ähnlich ist. Anhand einer Geräteadresse erkennt das Interface, an welchen SX 64 die Daten geleitet werden sollen. Die Geräteauswahl findet also im Interface statt, und nicht im SX 64.

## Drei Tage Aufbau

Der technische Aufwand läßt erahnen, welche Arbeit investiert werden muß, um die gesamte Anlage aufzubauen. Beim World Cup der Springreiter in Berlin mußten dazu innerhalb drei Tagen etliche hundert Meter Kabel verlegt werden, um aus den einzelnen Computern ein einziges System zu machen und um die Verbindung zum Übertragungswagen herzustellen.

Das Herz des Systems befindet sich mit auf dem Richterturm, hinter der Richterbank. In der Berliner Deutschlandhalle standen dort vier CBM 8296 mit Diskettenlaufwerken und Druckern und zwei Schriftgeneratoren (Aston 3). Anstelle der 8296 könnten genauso C 64 verwendet werden, so der COSS-Geschäftsführer Dr. Hehenwarter, aber die 8296 sind nun mal mit entsprechen-

den Programmen vorhanden. Mit drei der vier CBM 8296 wurde über Schriftgeneratoren das Bild fürs Fernsehen und das Infosystem erzeugt. Für das Fernsehbild hatte man zwei Computer: Einen für die Zeit- und Fehlerpunkte-Einspielung und einen für Rangliste. Dadurch konnten beiden Auswertungen abwechselnd dem Fernsehbild zugemischt werden. So lange ein Reiter sich auf dem Parcour befand, wurden in der Regel die Zeit und die Fehlerpunkte eingeblendet. Ansonsten zeigte man den World Cup-Stand. Über das Infosystem wurde der aktuelle Ritt mit dem Zeitstand gezeigt. War einmal kein Reiter auf dem Parcour, konnten von den SX 64 Logos oder Pictogramme abgerufen und übers Infosystem gezeigt werden. Das war beispielsweise ein stilisierter Reiter oder das Commodore-Firmenzeichen. Mit dem vierten der CBM 8296 wurde die Anzeigetafel in der Halle angesteuert.

Dem Infosystem waren in der Deutschlandhalle etwa 50 Monitore in den Gängen und im Pressesaal angeschlossen, wo das laufende Geschehen gezeigt wurde. Ins Kamerabild wurden ständig die aktuellen Zwischenergebnisse eingeblendet. Das laufende Geschehen nahm der Commodore-Sportservice mit einer eigenen Kamera auf.

In Berlin wurden die gemessenen Zeiten ausnahmsweise auf Zuruf eingegeben. Im Regelfall ist das nicht notwendig. Ein CBM 8296 wird dazu über eine V.24-Schnittstelle direkt mit der Elektronik der Zeitmessung verbunden. Vor dem Wettkampf werden die Nennungen eingegeben. Die Nennung umfaßt neben den Namen, mitgebrachte Punkte für die World Cup-Wertung, die Nation, die Klasse und den Verein. Aus diesen Daten wird eine Startliste für den Veranstalter erstellt. Was während des Turnieres noch getan werden muß, beschränkt sich auf die Eingabe der Fehlerpunkte.

Die Zeitnahme ist in diesem Zusammenhang auch das einzige, das der Commodore-Sportservice nicht selbst macht. Das übernehmen Spezialfirmen wie Omega, Longines und Alge, die Ihnen bestimmt als Uhrenhersteller bekannt sind. Diese Firmen erledigen die technische Zeiterfassung und stellen das Zeitsignal den Commodore-Leuten bereit. Der Vorteil dieser Direktverbindung liegt auf der Hand: keine Übertragungsfehler mehr beim Zurufen der Zeit und keine Eingabefehler mehr.

### Zuschauer verlangen gute Informationsdarstellungen

Damit die Zuschauer zu Hause vor dem Fernseher und die Zuschauer vor Ort gut über das Geschehen informiert werden können, sind viele Probleme zu lösen und hohe Investitionen nötig.

Ein Problem, das häufig auftrete, sei der Anschluß der Score-Boards, der großen Anzeigetafeln, die in jedem Stadion oder jeder Sporthalle zu finden sind, so Dr. Hehenwarter. Der Anschluß der Tafeln erfolgt zwar über RS232-Schnittstellen, die aber teilweise alles andere als genormte Baudraten haben.

Sehr hohe Investitionen waren für die zwei Schriftgeneratoren nötig. Ohne Zubehör wie Einstellmonitore, Floppy-Disk-Laufwerk kostet ein einziger Schriftgenerator (Aston 3) über 100000 Mark. Die Schriftgeneratoren erzeugen die Schrift, wie sie später im Fernsehen oder auf den Monitoren des Info-Systems zu sehen ist. Von den beiden Schriftgeneratoren erzeugt einer die Schrifteinblendungen für das Info-System, der andere liefert das Videosignal der Schrift dem Übertragungswagen. Diese Schriftgeneratoren können fast alles erdenkliche, was mit Schrift zu tun hat: verschiedene Schrifttypen, Farbwechsel, Blocksatz, verkleinern, vergrößern, verschieben oder schrägstellen der Schrift und mehr. Der Anzahl der Schrifttypen sind keine Grenzen gesetzt. Die einzelnen Typen können mit einer Kamera aufgenommen und durch den Schriftgenerator digitalisiert werden. Die Zeichensätze werden dann auf Diskette gespeichert und können jederzeit geladen werden.

Die Ansteuerung der Schriftgeneratoren durch den Computer erfolgt denkbar einfach: genau wie ein Drucker. Die Texte werden einfach im ASCII-Code an den Schriftgenerator gesandt und können dort bearbeitet werden. Die Generatoren haben auch eine eigene Tastatur und ein einfaches Textverarbeitungsprogramm zur direkten Texteingabe.

»Früher«, so Dr. Hehenwarter, »genügte das Schriftbild eines Computers noch den Qualitätsansprüchen. Heutezutage ist es aber undenkbar, eine Matrixschrift mit vielleicht 8x8 Punkten ins Fernsehbild einzublenden.«

## 90 Programme für ein Reitturnier

Neunzig Programme wurden in Berlin zur Auswertung des World Cup-Turniers gebraucht. Alle hat das COSS-Team selbst geschrieben. »Das geht auch nicht anders«, so ein Mitarbeiter, »denn die Programme müssen häufig noch am Richterturm umgeschrieben werden.« Es ist also sehr wichtig, daß mindestens ein Programmierer, der an der Softwareerstellung beteiligt war und deshalb das Programm sehr gut kennt, mit von der Partie ist. Man braucht sich dazu nur ein Programm näher betrachten. Man wird schnell feststellen, daß es professionelle Programme sind, die mit den meisten handelsüblichen Dateiverwaltungen nur den Namen gemeinsam haben. Hier, beim Schreiben, Verändern, Anpassen und Compilieren der Programme werden auch die 4040-Laufwerke benötigt.

## SX64-Garbage Collection in einer Sekunde

Ein Ansporn für C 64-Programmierer dürfte die Tatsache sein, daß die COSS-Leute für den SX 64 eine Garbage Collection geschrieben haben, die maximal eine Sekunde braucht, um den gesamten Stringspeicher des SX 64 oder C 64 »aufzuräumen«. Jeder SX 64/C 64-Programmierer hat wahrscheinlich schon mit dem Problem der Garbage Collection, die bis zu einer halben Stunde dauern kann, gekämpft. Ohne diese schnelle Garbage Collection-Routine wäre der Einsatz des SX 64 als Computer zur schnellen Auswertung gar nicht denkbar.

Sämtliche Datenleitungen haben einen gemeinsamen Knotenpunkt: zwei 20-MByte-Festplattenlaufwerke, die in Berlin in einem finsteren Loch »versteckt« waren. Die Verbindung der Computer mit dem Laufwerk erfolgt über eine Schnittstelle, die von den COSS-Mitarbeitern selbst entwickelt wurde. Im Gegensatz zu einer gewöhnlichen V.24-Schnittstelle, die maximal 19200 Bit/Sekunde übertragen kann, schafft die COSS-Schnittstelle um 160000 Bit/Sekunde, also etwa das 9fache. Diese Schnittstelle wird von den IEEE-Schnittstellen der Computer und Festplattenlaufwerke angesteuert.

## Datenübertragung nach eigenem Konzept

Warum man überhaupt eine Schnittstellenwandlung vornimmt und die Daten seriell sendet, liegt einfach an der Zuverlässigkeit dieser Art von Datenübertragung. Parallele Übertragung von IEEE-Signalen wäre auf der benötigten Kabellänge einfach viel zu anfällig gegen Störstrahlungen. Das Problem ist nämlich, daß die Datenleitungen in den gleichen Kabelschächten untergebracht werden müssen wie die Starkstromkabel. Und die Übertragungssicherheit muß auf jeden Fall gewährleistet sein. Schließlich holt sich jeder Computer des Systems von den Festplattenlaufwerken die Daten zu einer bestimmten Auswertung oder speichert welche ab.

## Auch Lösungen für kleinere Veranstaltungen

Aus der Erfahrung, die der Commodore-Sportservice bei nationalen und internationalen Großveranstaltungen gewann, wurde ein Programm für den C 64 entwickelt, das als Steckmodul erhältlich ist. Mit diesem Modul kann jeder kleinere Verein fast jede Art von Meisterschaften oder ähnliche Veranstaltungen auswerten. Was dazu nötig ist, ist ein C 64 mit Monitor, ein 1541-Diskettenlaufwerk und ein Drucker. Mit dem Steckmodul können die Daten von bis zu 400 Teilnehmer in 40 Klassen verwaltet werden. Für größere Vorhaben bietet Commodore auch andere Lösungen an. Zum Beispiel CBM 8296-Computer mit Diskettenlaufwerk, Drucker und den entsprechenden Programmen. Wem das nicht leistungsfähig genug ist, kann sich auch den Commodore-Sportservice mieten. Sollten Sie interessiert sein, erfahren Sie die Kosten auf Anfrage bei Commodore in Frankfurt.

(hm)

# Vorschau [164]

## Neueste Spiele

In dieser Ausgabe begannen wir mit einer neuen Art des Spieletests. Fortgesetzt werden diese Tests unter anderem mit den Spielen »Mail Order Monsters« und »Racing Destruction Set«. Weiterhin finden Sie einen ausführlichen Bericht über das neue Spiel zum James Bond-Film.

## Was macht der Sumpf?

Die Raubkopiererszene hat sich in der letzten Zeit geändert. Was ist aus den ehemaligen Crackern geworden, wie ist die Einstellung der heute noch Aktiven? Wir werden auch die rechtliche Seite des verbotenen Kopierens und Tauschens beleuchten.

## Alles über Grafik

Grafik ist wohl immer noch eines der interessantesten Themen für den C 64. In einem ausführlichen Vergleichstest stellen wir Ihnen die bekanntesten Grafik- und Malprogramme vor und machen Sie mit der Funktionsweise eines Lightpens, Trackballs und Grafiktabletts vertraut.

## Neuer Kurs: Commodore Extern — der Weg nach draußen

Interessiert es Sie, wie Sie über den User-Port alle möglichen Geräte steuern können? Möchten Sie sich einen Lichtgriffel für unter 5 Mark selber bauen? Oder wollen Sie wissen, wie man Meßgeräte über den Control-Port abfragt? Unser neuer Kurs führt Sie in die Geheimnisse der Hardware sowohl des C 64 als auch des VC 20 ein. Keine Angst, Sie brauchen nicht Elektronik studiert zu haben, um diesen Kurs mitverfolgen und mitmachen zu können. Anhand einfacher und nachbausicherer Bauanleitungen und kleiner Demo-Programme ist der leichte Einstieg in Theorie und Praxis des »Commodore Extern — der Weg nach draußen« garantiert — und das auch, wenn Sie sich bisher noch nicht mit Hardware-Basteleien auseinandergesetzt haben.

## Neuer Pascal-Compiler

Die 64’er-Redaktion hatte als erste die Möglichkeit, den neuen Pascal-Compiler von Data Becker zu testen. Handelt es sich nur um eine weitere Pascal-Version unter vielen, oder wird hier ein neuer Maßstab gesetzt? Jedenfalls sollten Sie mit der Anschaffung eines Pascal-Compilers bis zur nächsten Ausgabe des 64’er-Magazins warten — es könnte sich lohnen.

## Forth-Compiler zum Abtippen

Das Listing des Monats in der Ausgabe 8 ist wieder einmal ein ganz besonderer Leckerbissen: Ein Forth-Compiler für den C 64 erwartet Sie. Aber keine Angst, es kommen keine endlosen DATA-Wüsten auf Sie zu, denn dieser Compiler ist in Basic geschrieben. Dadurch ist das Compilieren selbst zwar etwas langsam, die übersetzten Programme laufen jedoch mit der von Forth gewohnten Geschwindigkeit. Und so ganz nebenbei lernen Sie beim Abtippen des Programms die Arbeitsweise eines Forth-Compilers kennen.

## Hypra-Save

Nachdem Hypra-Load bei den Lesern auf so großes Interesse gestoßen ist, werden wir in der nächsten Ausgabe das Gegenstück Hypra-Save veröffentlichen. Hypra-Save ist voll kompatibel zu Hypra-Load und ermöglicht ein erheblich schnelleres Abspeichern auf Diskette. Diese beiden Programme geben jedem Besitzer eines 1541-Diskettenlaufwerks ein Werkzeug an die Hand, das so manchen hardwaremäßigen Versuch, das langsame Diskettenlaufwerk zu beschleunigen, bei weitem übertrifft.

## Außerdem...

* Zwei Wettbewerbe mit tollen Preisen
* Disk-Monitor
* Berichte von der CES in Chicago
* und wieder viele Tips und Tricks für den C 64, VC 20 und C 16
