<!DOCTYPE html>
<html lang="de">

<head>
    <title>Hyperscreen</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../style.css">
    <meta name="author" content="Holger Gehrmann, ah">
    <meta name="64er.issue" content="12/85">
    <meta name="64er.pages" content="76-77">
    <meta name="64er.head1" content="Tips und Tricks">
    <meta name="64er.head2" content="C 64">
    <meta name="64er.toc_title" content="<b>Grafik: Sprites im Rahmen</b>">
    <meta name="64er.toc_category" content="Listings zum Abtippen">
    <meta name="64er.index_title" content="Hyper-Screen (Sprites auf dem Bildschirmrand)">
    <meta name="64er.index_category" content="Listings zum Abtippen|Tips & Tricks">
    <meta name="64er.id" content="hyperscreen">
</head>

<body>
    <article>
        <h1>Hyperscreen</h1>
        <p class="intro">Wir stellen hier ein Programm vor, das die Herzen der Spiele-Programmierer höher schlagen läßt. Denn von nun an lassen sich Sprites auch auf dem oberen und unteren Rand darstellen.</p>

        <p>Mit diesem Maschinenprogramm (Listing 1) kann man den oberen und unteren Bildschirmrand einfach verschwinden lassen, um dort zum Beispiel Sprites darzustellen. Damit ist es erstmals möglich, Spiele im »Hochformat« zu programmieren, wie man es von Videospielautomaten her kennt. Die Handhabung von Hyperscreen ist denkbar einfach. Das Programm verändert den IRQ-Vektor und ist daher besonders einfach in eigene Basic- oder Maschinenprogramme einzubauen. Startet man Hyperscreen mit SYS 49152, ändern sich die Bildschirmfarben. Der Text »Hyperscreen by Holger Gehrmann« erscheint, und der obere und untere Bildschirmrand ist verschwunden.</p>

        <p>Mit POKE 49209,27 kann man nun die Bildschirmränder »einschalten« und mit POKE 49209,19 wieder abschalten (leider ist es softwaremäßig nicht möglich, den linken und rechten Bildschirmrand ebenfalls verschwinden zu lassen). Benutzt man im Hyperscreen-Modus die Befehle LOAD und SAVE, erscheinen die Bildschirmränder wieder für kurze Zeit, da bei diesen Befehlen der IRQ abgeschaltet wird. POKEt man in die Speicherzelle 16383 einen Wert, erscheint dieser als Bitmuster dort, wo früher die beiden Bildschirmränder waren. Die Farbe des angezeigten Bitmusters ist immer schwarz, sie läßt sich nicht ändern. Die Spritehandhabung ist mit Hyperscreen genauso wie sonst, nur mit dem Unterschied, daß man das Sprite wirklich von ganz oben nach ganz unten bewegen kann, ohne daß es hinter einem Rand verschwindet.</p>

        <p>Sie werden sich sicher fragen, wie es möglich ist, softwaremäßig die beiden Ränder verschwinden zu lassen, da dies ja offiziell gar nicht möglich ist. Es scheint weltweit auch noch kein Programm erschienen zu sein, das diese Möglichkeit ausnutzt. Um den oberen und unteren Rand zu erzeugen, merkt sich der Video-Interface-Chip (VIC) zwei Rasterzeilen. Bei der einen Rasterzeile wird der Bildschirm eingeschaltet, bei der anderen wieder aus. Der Bereich zwischen Aus- und Einschalten ist der Rand. Den Wert dieser beiden Rasterzeilen kann man mit einem Bit im VIC verändern. Setzt man dieses Bit (es heißt RSEL), hat der Bildschirm die gewohnten 25 Zeilen. Löscht man es, hat er nur noch 24, der Bildschirmrand wird dafür oben und unten etwas verbreitert.</p>

        <p>Sorgt man nun dafür, daß der Bildschirm bei jedem Strahlendurchlauf kurz vor der Stelle, wo er abgeschaltet wird (kurz vor dem unteren Bildschirmrand), durch Löschen des Bits RSEL auf 24 Zeilen verkleinert wird, wird auch automatisch der Rasterzeilenwert für das Abschalten des Bildschirms etwas nach oben gesetzt. Da der Rasterstrahl über diese neue Abschaltposition schon hinweg ist, wird der Bildschirm nicht abgeschaltet und somit verschwindet auch der obere und untere Bildschirmrand.</p>

        <p>Das klingt vielleicht etwas kompliziert, funktioniert aber, wie man an Hyperscreen sieht, fehlerfrei und ist äußerst nützlich.</p>

        <p>Hyperscreen ist ein sehr kurzes und komprimiertes Maschinenprogramm, das den Speicherbereich von $C000 bis $C090 belegt. Es wird mit LOAD »HYPERSCREEN«, 8,1 geladen und durch den Befehl SYS 49152 aktiviert. Zu beachten ist, daß während des LOAD- oder SAVE-Vorgangs der obere untere Bildschirmrand wieder vorhanden ist. Gleiches passiert, wenn das Interruptflag im Prozessorstatusregister gesetzt wird (SEI). Die Demo-Listings 2, 3 und 4 zeigen die Leistungsfähigkeit dieses Programms. Bei Listing 5 handelt es sich um den mit Hypra-Ass erstellten Quelltext.</p>

        <address class="author">(Holger Gehrmann/ah)</address>


        <figure>
            <pre data-filename="hyperscreen.prg" data-name="Hyperscreen" data-mse=mse1></pre>
            <figcaption>Listing 1. Hauptprogramm »Hyperscreen«. Bitte beachten Sie die Eingabehinweise auf Seite 54</figcaption>
        </figure>
        <div class="binary_download" data-filename="hyperscreen.prg" data-name="Hyperscreen"></div>

        <figure>
            <pre data-filename="hauptdemo" data-name="Hyperscreen-Demo"></pre>
            <figcaption>Listing 2. Demoprogramm zu »Hyperscreen«</figcaption>
        </figure>

        <figure>
            <pre data-filename="bitmuster-demo" data-name="Bitmuster-Demo"></pre>
            <figcaption>Listing 3. Demo zum Ändern des Bitmusters</figcaption>
        </figure>

        <figure>
            <pre data-filename="sprite-demo" data-name="Spite-Demo"></pre>
            <figcaption>Listing 4. Sprite-Demo</figcaption>
        </figure>
        <figure>
            <pre>10   -.LI 4,4,7
100  -          .EQ IRQLO=$0314
110  -          .EQ IRQHI=$0315
140  -          .EQ STEUERREGISTER=$D011
150  -          .EQ RASTERZEILE=$D012
160  -          .EQ IRR=$D019
170  -          .EQ IMR=$D01A
180  -          .EQ RANDFARBE=$D020
190  -          .EQ HINTERGRUNDFARBE=$D021
200  -          .EQ CRA=$DC0E
210  -          .EQ IRQORG=$EA31
220  -          .EQ AUSGABE=$FFD2
     -;
240  -          .BA $C000
     -;
     -;IRQ-VEKTOR SETZEN
310  -          SEI
320  -          LDY #&lt;(IRQ)
330  -          LDX #&gt;(IRQ)
340  -          STY IRQLO
350  -          STX IRQHI
     -;
     -;VIC INITIALISIEREN INTERRUPT DES CIA AUSSCHALTEN
360  -          LDA #$00
370  -          STA CRA        ;CONTROL REGISTER A
380  -          LDA #$F1
390  -          STA IMR        ;INTERRUPT MASKENREGISTER
400  -          LDA #$F8
410  -          STA RASTERZEILE
420  -          LDA STEUERREGISTER
430  -          AND #$7F
440  -          STA STEUERREGISTER
450  -          LDX #$21
     -;
     -;BILDSCHIRM LOESCHEN UND EINSCHALTMELDUNG AUSGEBEN
460  -LOOP      LDA NAME,X
470  -          JSR AUSGABE
480  -          DEX
490  -          BNE LOOP
500  -          LDY #$07
510  -          STY RANDFARBE
520  -          LDY #$08
530  -          STY HINTERGRUNDFARBE
540  -          RTS
     -;
     -;HIER BEGINNT DIE EIGENTLICHE ROUTINE
600  -IRQ       LDX #$13       ;AUF 24 ZEILEN UMSCHALTEN
610  -          STX STEUERREGISTER
620  -WARTE     LDA RASTERZEILE
630  -          BNE WARTE
640  -          LDX #$1B       ;AUF 25 ZEILEN UMSCHALTEN
650  -          STX STEUERREGISTER
660  -          LDA #$01
670  -          STA IRR        ;INTERRUPT REQUEST
680  -          LDA #$F1
690  -          STA IMR        ;INTERRUPT MASKENREGISTER
700  -          JMP IRQORG
     -;
790  -NAME      .TX "NNAMRHEG REGLOH YB NEERCSREPYH"
800  -          .BY 147</pre>
            <figcaption>Listing 5. Quelltext zu »Hyperscreen«, erstellt mit Hypra-Ass</figcaption>
        </figure>
        <div class="binary_download" data-filename="quelltext.prg" data-name="Hyperscreen Quelltext"></div>
    </article>
</body>

</html>