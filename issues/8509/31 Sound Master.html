<!DOCTYPE html>
<html lang="de">

<head>
    <title>Sound Master</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../style.css">
    <meta name="author" content="Peter Menke, bs">
    <meta name="64er.issue" content="9/85">
    <meta name="64er.pages" content="31-33">
    <meta name="64er.head1" content="Musik">
    <meta name="64er.head2" content="C 64">
    <meta name="64er.toc_category" content="Musik und C 64">
    <!-- <meta name="64er.toc_category" content="Listings zum Abtippen|Musik"> -->
    <meta name="64er.index_title" content="Sound Master (Basic-Erweiterung)">
    <meta name="64er.index_category" content="Listings zum Abtippen|Musik">
    <meta name="64er.id" content="sound_master">
</head>

<body>
    <article>
        <h1>Sound Master</h1>
        <p class="intro">Musik und Soundeffekte auf dem C 64 zu programmieren war bisher sehr kompliziert, kam man doch nicht um den POKE-Befehl herum. Unsere Basic-Erweiterung Sound Master behebt dieses Übel.</p>

        <p>Das Programm Sound Master (Listing 1) muß mit dem MSE eingegeben werden. Später kann es dann mit »LOAD "SOUND MASTER",8« und »RUN« gestartet werden. Danach stehen Ihnen acht neue Basic-Befehle zur Verfügung.</p>

        <p>Zum Ausprobieren (nach dem Starten von Listing 1) sind noch drei Demoprogramme, Listings 2 bis 4, abgedruckt. Diese können aufgrund der neu definierten Basic-Befehle nicht mit dem Checksummer eingegeben werden! Nun zur Beschreibung der acht neuen Befehle:</p>

        <h3>SOUNDCLEAR</h3>

        <p>Initialisiert alle Tonregister neu (Ton aus; Frequenz 0 etc.).</p>

        <h3>VOLUME vo</h3>

        <p>Bestimmt die Gesamtlautstärke (vo). vo kann Werte von 0 bis 15 annehmen. Zum Beispiel Volume 15 = volle Lautstärke.</p>

        <p>Im folgenden gibt der Parameter tg immer den gewünschten Tongenerator an. Es stehen drei Tongeneratoren zur Verfügung (1 bis 3), die gleichzeitig gespielt werden können. Um einen Ton zu erzeugen, müssen zuerst mit den folgenden Befehlen die Tonparameter bestimmt werden. Mit PLAY wird der Ton dann eingeschaltet.</p>

        <h3>OSCILLATE tg,fq</h3>

        <p>Bestimmt die Frequenz (fg) von Tongenerator tg. Die Frequenz kann direkt in Hertz angegeben werden! Die maximale Frequenz liegt bei 3&thinsp;848 Hz. Die Genauigkeit beträgt mehrere Stellen nach dem Komma. Zum Beispiel Oscillate 1,1000 = Tongenerator 1 schwingt mit 1000 Hz.</p>

        <h3>TUNE tg,no$</h3>

        <p>Eine andere Möglichkeit, die Tonfrequenz zu bestimmen ist die Angabe einer Note (no$). Diese muß in einem String stehen. Die Syntax ist die gleiche wie in Anhang P des 64-Handbuchs beschrieben, das heißt Buchstabe der Note — Oktave. Der Bindestrich kann weggelassen werden. Die Programmierung eines Musikstücks mit dem TUNE-Befehl ist sehr gut in Listing 4 demonstriert. Zum Beispiel »TUNE 2,"D4" «spielt in TG 2 die Note D, Oktave 4; »TUNE 3,A$« spielt die Note aus A$ in TG 3</p>

        <h4>Anmerkung zu den OSCILLATE- und TUNE-Befehlen:</h4>

        <p>Die Umrechnung der Frequenz beziehungsweise der Note erfolgt auf Basis der deutschen PAL-Version des Commodore 64 (Prozessortakt 985 kHz). Bei der amerikanischen NTSC-Version ist eine andere Umrechnung erforderlich (Prozessortakt 1&thinsp;022 kHz). (In der Tabelle im Handbuch sind übrigens die amerikanischen Werte für die Noten vermerkt, auf einem deutschen 64 wird die Note also anders als beim Sound Master nicht genau getroffen!)</p>

        <h3>ENVELOPE tg,a,d,s,r</h3>

        <p>Dieser Befehl bestimmt die Hüllkurve des Tons.</p>

        <ul class="plain">
            <li>a = Anstiegszeit</li>
            <li>d = Abfallzeit</li>
            <li>s = Haltepegel</li>
            <li>r = Ausklingzeit</li>
        </ul>

        <p>Es können Werte von 0 bis 15 eingegeben werden.</p>

        <h3>WAVE tg,wf,(tv),ef&hellip;</h3>

        <p>Bestimmt die Wellenform (wf), mit der der Ton gespielt wird.</p>

        <ul class="plain">
            <li>1 = Dreieck</li>
            <li>2 = Sägezahn</li>
            <li>3 = Rechteck</li>
            <li>4 = Rauschen</li>
        </ul>

        <p>Wird Rechteck ausgewählt, muß zusätzlich eine Angabe des Tastverhältnisses (tv) folgen (0 bis 100 Prozent). Die Genauigkeit betätigt hier mehrere Stellen nach dem Komma. Effekte: Nach diesem Parameter können noch einzelne Buchstaben folgen, um bestimmte Toneffekte zu programmieren.</p>

        <p class="noindent">OFF: Waren die Angaben zur Wellenform für Stimme 3 bestimmt (tg = 3), so kann mit OFF diese (aus technischen Gründen leider nur diese) Stimme stumm geschaltet werden.</p>

        <p>S: Der ausgewählte Tongenerator (tg) wird mit einem anderen Tongenerator synchronisiert, und zwar 1 mit 3, 2 mit 1 und 3 mit 2 (siehe Listing 3).</p>

        <p>R: Die Dreieckspannung des ausgewählten Tongenerators (tg) wird durch eine Ringmodulation zweier Tongeneratoren ersetzt (1 mit 3, 2 mit 1 und 3 mit 2) (siehe Listing 2).</p>

        <p>Zum Beispiel »WAVE 2,2«: Stimme 2 spielt mit Sägezahn.</p>

        <p class="noindent">»WAVE 3,1OFF«: Stimme 3 spielt mit Dreieck, wird jedoch stumm geschaltet. Man hört also nichts. Dies braucht man zum Beispiel, wenn der Ton von Stimme 3 bei Synchronisation oder Ringmodulation nur stören würde.</p>

        <h3>PLAY, tg,td</h3>

        <p>Mit diesem Befehl wird der Ton eingeschaltet (td ist die Tondauer; maximal 65535, das sind zirka 46 Sekunden). Anstatt eine Tondauer anzugeben, kann mit »PLAY tg,ON« der Ton nur eingeschaltet werden. Das Basic-Programm wird dann sofort fortgeführt. Mit »PLAY tg,OFF« wird der Ton wieder ausgeschaltet.</p>

        <p class="noindent">»PLAY tg,ON«: Schaltet tg an</p>

        <h3>FILTER fh,fq,re,tg&hellip;.</h3>

        <p>Der SID bietet die Möglichkeit, eine oder mehrere Stimmen über einen Filter zu leiten, fh steht für einen einzelnen Buchstaben und dient zur Auswahl der gewünschten Filterart.</p>

        <ul class="plain">
            <li>H = Hochpaßfilter</li>
            <li>T = Tiefpaßfilter</li>
            <li>B = Bandpaßfilter</li>
            <li>N = Notchfilter</li>
        </ul>

        <p>Dann folgt die Filterfrequenz (fq) in Hertz (30 bis 11800 Hz).</p>

        <p>Die Resonanz (re) hebt die Frequenzen in der Nähe der Filterfrequenz hervor (Werte linear 0 bis 15). Nun folgen die Nummern der Tongeneratoren, die über den Filter geleitet werden sollen (4 = Audioeingang).</p>

        <p>Zum Beispiel »FILTER H,2000,10,l, 2«: Stimme 1 und 2 werden über den Filter geleitet. Filterfrequenz = 2000 Hz, Resonanz = 10, Hochpaß eingeschaltet.</p>

        <p>Nun noch ein kurzes Beispiel, wie man einen einfachen Ton programmiert.
            <code>VOLUME 15:REM Volle Lautstärke
                ENVELOPE 1,0,0,15,0:REM nur »Halten« auf voller Lautstärke
                WAVE 1,2:REM Sägezahn
                OSCILLATE 1,500:REM 500 Hertz
                PLAY 1,1000:REM Spielt Ton
                oder PLAY 1,ON:REM TG 1 an
                FOR I = 0TO1000:OSCILLATE 1,I: NEXT:REM Als Frequenz werden Werte von 0 bis 1000 eingesetzt. Es entsteht ein ansteigender Ton.
                PLAY 1,OFF:REM Ton aus
            </code>
        </p>

        <p>Alle Befehle sind nach dem Programmstart fest ins Basic eingebunden und bleiben bis zum Ausschalten erhalten.</p>

        <p class="noindent">Alle Befehle können normal abgekürzt werden, zum Beispiel »S + Shift-O« = SOUNDCLEAR.</p>

        <address class="author">(P. Menke/bs)</address>

        <figure>
            <pre data-filename="sound master.prg" data-name="Sound Master" data-mse=mse1></pre>
            <figcaption>Listing 1. Die Basic-Erweiterung Sound Master muß mit dem MSE abgetippt werden (siehe Seite 54)</figcaption>
        </figure>
        <div class="binary_download" data-filename="sound master.prg" data-name="Sound Master"></div>

        <figure>
            <pre>100 REM DEMONSTRATION
110 REM FUER RINGMODULATION
120 :
130 SOUNDCLEAR:VOLUME 15
140 ENVELOPE 1,0,0,15,0
150 ENVELOPE 3,0,0,15,0
160 :
170 WAVE 1,1,R  :REM RINGMODULATION
180 WAVE 3,3,30
190 :
200 PLAY 3,ON
210 PLAY 1,ON
220 :
230 FOR I=1 TO 3000 STEP 100
240 FOR X=1 TO 3000 STEP 50
250 OSCILLATE 3,X
260 NEXT
270 OSCILLATE 1,I
280 NEXT
290 :
300 SOUNDCLEAR
READY.</pre>
            <figcaption>Listing 2. Ein Demonstrationsprogramm zur Ringmodulation</figcaption>
        </figure>
        <div class="binary_download" data-filename="ringmod.prg" data-name="Ringmodulation"></div>

        <figure>
            <pre>100 REM DEMONSTRATION
110 REM FUER SYNCHRONISTION
120 :
130 SOUNDCLEAR:VOLUME 15
140 ENVELOPE 1,0,0,15,0
150 :
160 WAVE 1,3,40,S  :REM SYNCHRONISATION
170 WAVE 3,1,OFF
180 :
190 OSCILLATE 3,250
200 :
210 PLAY 1,ON
220 PLAY 3,ON
230 :
240 FOR I=100 TO 3000 STEP 3
250 OSCILLATE 1,I
260 NEXT
270 :
280 SOUNDCLEAR
READY.</pre>
            <figcaption>Listing 3. Ein Demonstrationsprogramm zur Synchronisation</figcaption>
        </figure>
        <div class="binary_download" data-filename="sync.prg" data-name="Synchronisation"></div>

        <figure>
            <pre>100 PRINT"."
110 PRINT"  MOONLIGHT SHADOW  "
120 PRINT"  VON MIKE OLDFIELD "
130 :
140 SOUNDCLEAR:VOLUME 15
150 :
160 REM NOTEN UND DAUER
170 REM FUER STIMME 1 UND 2
180 :
190 DIM N1$(200),D1(200)
200 DIM N2$(200),D2(200)
201 RESTORE
210 :
220 REM DATEN FUER STIMME 1
230 I=0
240 READ N1$(I),D1(I)
250 IFD1(I)>0THENI=I+1:GOTO240
260 :
270 REM DATEN FUER STIMME 2
280 I=0
290 READ N2$(I),D2(I)
300 IFD2(I)>0THENI=I+1:GOTO290
310 :
320 :
330 PRINT"  GESCHWINDIGKEIT (1-6) ?"
340 GET A$:IF A$=""THEN340
350 SP=VAL(A$):IFSP&lt;1ORSP>6THEN340
360 :
370 :
380 REM HUELLKURVEN
390 ENVELOPE 1,4,8,7,10
400 ENVELOPE 2,2,11,11,11
410 :
420 S1=0:S2=0:C1=0:C2=0
430 TUNE 1,N1$(S1)
440 TUNE 2,N2$(S2)
450 WAVE 1,3,18.75
460 WAVE 2,2
470 PLAY 1,ON:PLAY 2,ON
480 :
490 :
500 REM STIMME 1
510 C1=C1+1:IFC1>(D1(S1)*SP/2)THEN PLAY 1,OFF
520 IFC1&lt;(D1(S1)*SP)THEN 590
530 :
540 REM NAECHSTE NOTE
550 C1=0:S1=S1+1
551 IF D1(S1)&lt;0THEN PLAY 1,OFF:PLAY 2,OFF:END
555 PLAY 1,ON:TUNE 1,N1$(S1)
560 :
570 :
580 REM STIMME 2
590 C2=C2+1:IFC2>(D2(S2)*SP/2)THEN PLAY 2,OFF
600 IFC2&lt;(D2(S2)*SP)THEN 640
610 :
620 REM NAECHSTE NOTE
630 C2=0:S2=S2+1:PLAY 2,ON:TUNE 2,N2$(S2)
635 PLAY 2,ON:TUNE 2,N2$(S2)
640 GOTO510
650 :
670 :
680 REM DATEN FUER STIMME 1
690 DATA D5,3,D5,1,D5,1,E5,1,D5,1,C#5,1,H4,4,H4,4,C#5,1,C#5,1
700 DATA D5,1,E5,3,D5,1,E5,1,F#5,2,F#5,2,E5,1,A4,3
710 DATA D5,3,D5,1,D5,1,E5,1,D5,1,C#5,1,H4,4,H4,4,C#5,1,C#5,1
720 DATA D5,1,E5,3,D5,1,E5,1,F#5,2,F#5,2,E5,1,A4,3
730 DATA F#5,2,A5,2,G5,2,F#5,1,D5,1,E5,1,F#5,2,E5,5
740 DATA F#5,3,E5,1,D5,2,D5,1,H4,1,E5,1,F#5,2,E5,3,D5,1,E5,1
750 DATA F#5,2,A5,2,G5,2,F#5,1,D5,1,E5,1,C#5,1,H4,1,A4,5
760 DATA D5,3,C#5,1,H4,1,C#5,1,D5,2,E5,10
770 DATA F#5,2,E5,6,F#5,2,E5,2,D5,1,E5,1,F#5,2,A5,2,G5,2,F#5,1,D5,3,F#5,2,
E5,6
780 DATA F#5,2,E5,6,F#5,2,E5,2,D5,1,E5,1,F#5,2,A5,2,G5,2,F#5,1,D5,1
790 DATA E5,1,C#5,1,H4,1,A4,3,H4,1,C#5,1
800 DATA D5,3,D5,1,D5,1,E5,1,D5,1,C#5,1,H4,4,H4,4,C#5,1,C#5,1
810 DATA D5,1,E5,3,D5,1,E5,1,F#5,2,F#5,2,E5,1,A4,3
820 DATA D5,3,D5,1,D5,1,E5,1,D5,1,C#5,1,H4,4,H4,4,C#5,1,C#5,1
830 DATA D5,1,E5,3,D5,1,E5,1,F#5,2,F#5,2,E5,1,D5,7
840 DATA0,-1
850 :
860 :
870 REM DATEN FUER STIMME 2
880 DATA D3,4,D3,4,G3,4,H3,2,D3,2,A3,4,A3,4,D3,4,A3,2,E4,1,A3,1
890 DATA D3,4,D3,4,G3,4,H3,2,D3,2,A3,4,A3,4,D3,4,A3,2,E4,1,A3,1
900 DATA D3,4,D3,4,A3,4,A3,4,H3,4,G3,4,A3,4,A3,4
910 DATA D3,4,D3,4,A3,4,A3,4,H3,4,G3,4,A3,4,A3,3
920 DATA A3,1,A3,7,A3,1,A3,8,D3,4,D3,4,A3,4,A3,3
930 DATA A3,1,A3,7,A3,1,A3,8,D3,4,D3,4,A3,4,A3,4
940 DATA D3,4,D3,4,G3,4,H3,2,D3,2,A3,4,A3,4,D3,4,A3,2,E4,1,A3,1
950 DATA D3,4,D3,4,G3,4,H3,2,D3,2,A3,4,A3,4,D3,4,D3,8
960 DATA0,-1
READY.
            </pre>
            <figcaption>Listing 4. Sogar mehrstimmige Musikstücke lassen sich mit Sound Master programmieren</figcaption>
        </figure>
        <div class="binary_download" data-filename="moonlight.prg" data-name="Moonlight Shadow"></div>

        <div class="binary_download" data-filename="filter.prg" data-name="XXXXXXXXXXXXXXX"></div>
    </article>
</body>

</html>
