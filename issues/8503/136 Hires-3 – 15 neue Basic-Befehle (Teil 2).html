<!DOCTYPE html>
<html lang="de">

<head>
    <title>Hires-3 – 15 neue Basic-Befehle (Teil 2)</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../style.css">
    <meta name="author" content="Heimo Ponnath, gk">
    <meta name="64er.issue" content="3/85">
    <meta name="64er.pages" content="136,138-143">
    <meta name="64er.toc_category" content="Kurse">
    <!-- <meta name="64er.toc_title" content="XXX"> -->
    <meta name="64er.id" content="hires3">
</head>

<body>
    <article>
        <h1>Hires-3 – 15 neue Basic-Befehle (Teil 2)</h1>
        <p class="intro">Hier ist er, der 2. Teil von Hires-3, dem grafikunterstützenden Maschinenprogramm. Mit den diesmal gezeigten 15 neuen Basic-Befehlen kann Dornröschen (die hochauflösende Grafik) schnell und leicht ihr ganzes Können entfalten.</p>


        <p>Mit einigen der neu vorgestellten Funktionen werden vor allem diejenigen viel anfangen können, die ihren Computer für mathematische, technische oder naturwissenschaftliche Zwecke gebrauchen. Das sollte aber die künstlerisch Interessierten nicht vom Experimentieren abhalten. Es gibt eine unbegrenzte Anzahl von Möglichkeiten, Hires-3 zu nutzen.</p>

        <p>Wieder ist das Programm (Listing 1) mit dem MSE, den Sie an anderer Stelle in diesem Heft finden, einzugeben. Danach sollten Sie alles zunächst auf Kassette oder Diskette speichern.</p>

        <p>Sie werden sofort bemerkt haben, daß Sie damit auch den Bereich zwischen $89B7 und $9000 abspeichern, in dem kein Maschinenprogramm enthalten ist. Das ist ein Manko, das sich aus der Entstehungsgeschichte von Hires-3 erklärt. Andererseits kann jede Erweiterung in diesen Bereich gelegt werden, ohne daß man sich immer wieder neue Start- oder Endadressen merken muß.</p>

        <p>Jedesmal, wenn Sie jetzt Hires-3 benötigen, laden Sie es (mit Sekundäradresse 1); stellen Sie danach die Basic-Zeiger mittels NEW zurück, schützen Sie Hires-3 durch POKE52, 128:POKE56, 128, und starten Sie es dann mit SYS 36864. (Das wurde schon in der vorangegangenen Ausgabe beschrieben.)</p>

        <p>Nun sollen die neuen Befehle erklärt werden:</p>

        <h3>Einrichten eines frei wählbaren Koordinatensystems TRS, XU, X0, YU, Y0</h3>

        <p>Für alle nachfolgenden Befehle mit T oder LT am Anfang muß dieser TRS-Befehl vorher gegeben worden sein. TRS baut den Bildschirm nach unseren eigenen Wünschen um. Das normale Bildschirmkoordinatensystem, in dem X von 0 bis 319, Y von 0 bis 199 (abwärts) läuft, wird durch ein uns genehmes ersetzt. XU und XO sind dabei die kleinste und größte X-Koordinate, YU und YO entsprechend die kleinste und die größte Y-Koordinate, die wir wünschen.</p>

        <p>Beispiel: Wir wollen eine Sinus-Funktion zeichnen lassen. Uns interessiert der Verlauf von XU = -10 bis XO = 6. Wir wissen, daß die Y-Werte zwischen +1 und —1 hin- und herpendeln, wählen daher YU = -1.5 und YO = 1.5: Wir geben ein TRS, -10, 6, -1.5, 1.5. Unser Bildschirm istjetzt so organisiert, wie es Bild 1 zeigt.</p>

        <figure>
            <img src="136-1.png" alt="">
            <figcaption>Bild 1. Bildschirmorganisation nach: TRS,-10,6,-1.5,1.5</figcaption>
        </figure>

        <p>Dieser Befehl ist wohl der stärkste, der in Hires-3 enthalten ist. Innerhalb von Programmen kann er mehrmals verwendet werden, was zum Beispiel die Erstellung von 3D-Grafik erleichtert. Als Argumente dürfen beliebige Zahlen, arithmetische Ausdrücke oder mathematische Basic-Funktionen verwendet werden.</p>

        <p>Nehmen Sie mal an, Sie untersuchten eine Funktion, bei der Sie ein Maximum im X-Bereich —200 bis —300 vermuten, und wo der YWert irgendwo zwischen 1000 000 und 10 000 000 sein könnte. Dann benutzen Sie unseren Bildschirm wie ein Kameraobjektiv: Fahren Sie ihn auf diesen interessanten Ausschnitt mit TRS, -300, -200, 1E6, 1E7! Grenzen sind Ihnen nur insofern gesetzt, als unser Computer keine größere Zahl als 1.701411 83E38 und keine dem Betrag nach kleinere als 2.93873588E-39 kennt.</p>

        <p>Dazu noch eine Bemerkung. Alle Eingaben werden als Gleitkommazahlen verarbeitet. Der Prozessor 6510 unseres C 64 ist mit nicht ganz 1 MHz getaktet. Gleitkomma-Arithmetik ist eine recht aufwendige Angelegenheit. Je komplizierter die Ausdrücke werden, die als Argumente auftreten, desto längere Interpreterteile werden durchlaufen, und desto langsamer erfolgt die Befehlsausführung. Beispielsweise kann ein Argument 2.234 sofort verarbeitet werden, wohingegen bei einem Argument SIN(SQR(AtCOS(B))) ein erheblich längerer Rechengang erforderlich ist. Das sind eben die Grenzen unseres Systems, die wir hier spüren. Trotzdem geht alles noch erheblich schneller als in Basic.</p>

        <p>Auch nachdem Sie mittels des TRS-Befehls den Bildschirm neu organisiert haben, können Sie die Befehle benutzen, die sich auf den alten Bildschirm beziehen. Sie haben somit zwei Koordinatensysteme gleichzeitig zur Verfügung: Das normale (X von 0 bis 319, Y von 0 bis 199) und Ihr selbstdefiniertes.</p>

        <p>Die Abkürzung TRS kommt von dem Wort Transformation. Hier soll nicht näher erklärt werden, was das ist und wie das funktioniert. Wenn Sie mehr darüber wissen möchten, dann schlagen Sie mal die vergangenen Ausgaben des 64’er nach. In den Teilen 6 und 7 der Reise durch das Wunderland der Grafik ist der Begriff näher erläutert. Mehr dazu werden spätere Ausgaben bringen. Nur soviel soll dazu gesagt werden: Mittels geeigneter Transformationen können Sie wahre Wunderdinge auf dem Bildschirm vollbringen.</p>

        <h3>Zeichnen im selbstdefinierten System</h3>

        <p>Zu allen folgenden Befehlen sollte beachtet werden, daß vorher mit TRS das neue System definiert worden ist. Alle X und Y-Werte sollten möglichst innerhalb der damit festgelegten Grenzen XU-XO und YU-YO liegen. Überschreiten oder Unterschreiten der Grenzen führt im allgemeinen jedoch nicht zu Fehlermeldungen. Es können sich aber unter Umständen falsche Bildschirmdarstellungen ergeben. Im allgemeinen kann man diese dann deutlich erkennen und durch geeignete Neuwahl der TRS-Argumente beheben.</p>

        <h3>TPK, X, Y</h3>

        <p>zeichnet einen Punkt mit den Koordinaten X und Y in das vorher definierte System.</p>

        <p>Beispiel:</p>

        <p>TRS, -1,5, -2,6:TPK, 1,1 zeichnet in der in Bild 2 gezeigten Weise einen Punkt auf den Bildschirm.</p>

        <figure>
            <img src="136-2.png" alt="">
            <figcaption>Bild 2. Bildschirm nach: TRS,-1,5,-2,6 : TPK,1,1</figcaption>
        </figure>

        <h3>TLN, XA, YA, XB, YB</h3>

        <p>zeichnet eine Linie in das vorher selbstdefinierte Koordinatensystem ein, die vom Punkt A (XA,YA) bis zum Punkt B (XB,YB) verläuft. Mit TLN läßt sich nun recht einfach das Achsenkreuz des selbstgewählten Systems zeichnen: TLN, XU, 0, XO, 0 zeichnet die X-Achse und TLN, O, YU, 0, YO die Y-Achse.</p>

        <h3>TRE, XA, YA, XB, YB</h3>

        <p>zeichnet in das selbstgewählte System ein Rechteck. Der Punkt A (XA, YA) ist der linke obere, B (XB, YB) der rechte untere Eckpunkt.</p>

        <h3>TBK, XA, YA, XB, YB</h3>

        <p>zeichnet in das durch TRS definierte System ein ausgefülltes Rechteck. Die Bezeichungen sind dieselben wie bei TRE.</p>

        <h3>TKR, XM, YM, RX, RY, W</h3>

        <p>zeichnet in das neue Koordinatensystem eine Ellipse oder einen Kreis (dann ist RX = RY). Für die Bezeichnungen gelten die Regeln des GIR-Befehls (siehe letzte Ausgabe).</p>

        <h3>TRA, XM, YM, RX,RY, W</h3>

        <p>zeichnet ins TRS-System einen Radius ein. Es gelten dieselben Bezeichnungen wie beim RAD-Befehl (siehe vorangegangene Ausgabe).</p>

        <h3>FUNKT, Name, XA, XB</h3>

        <p>zeichnet in das mittels TRS definierte Koordinatensystem die Funktion »Name« ein. Gezeichnet wird dabei der Bereich von XA bis XB. Im Gegensatz zu den sonstigen Basic-Regeln für Funktionsnamen ist hier nur ein Buchstabe als Name erlaubt. Mehr als 26 (Buchstaben A bis Z) Funktionen gleichzeitig wird aber vermutlich kaum jemand auf dem Bildschirm darstellen wollen, oder?<br>
            Beispiel:<br>
            DEFFNA(X) = SIN(X)<br>
            TRS, -10, 10, -2, 2<br>
            FUNKT, A, 0, 3.14<br>
            zeichnet die definierte Sinus-Funktion in das durch TRS festgelegte System. Das Ergebnis zeigt Bild 3.</p>

        <figure>
            <img src="136-3.png" alt="">
            <figcaption>Bild 3. Bildschirm nach: DEFFNA(x)=SIN(x) TRS, -10,10-2,2 FUNKT,A,0,3.14</figcaption>
        </figure>

        <p>Auch für diesen Befehl gilt das für TRS Gesagte (nur deutlicher). Die Ausführungszeit steigt stark an, je komplexer die Funktion ist. Trotzdem geht alles noch schneller als in einer FOR&hellip; NEXT-Schleife, die Punkt für Punkt die Funktion zeichnet.</p>

        <h3>Löschen im selbstdefinierten System LTP, X, Y</h3>

        <p>löscht einen Punkt im TRS-System.</p>

        <h3>LTL, XA, YA, XB, YB</h3>

        <p>löscht eine Linie im neuen System.</p>

        <h3>LTR, XA, YA, XB, YB</h3>

        <p>löscht das Rechteck im neudefinierten Koordinatensystem.</p>

        <h3>LTB, XA, YA, XB, YB</h3>

        <p>löscht ein ausgefülltes Rechteck im selbstdefinierten System.</p>

        <h3>LTK, XM, YM, RX, RY, W</h3>

        <p>löscht eine Ellipse (einen Kreis) im TRS-System.</p>

        <h3>LTV, XM, YM, RX, RY, W</h3>

        <p>löscht einen Radius im neuen System.</p>

        <h3>LFUNK, Name, XA, XB</h3>

        <p>löscht die Funktion Name im Bereich XA bis XB im selbstgebauten Koordinatensystem.</p>

        <h3>Noch zwei Kleinigkeiten</h3>

        <p>Zwei Programmteile gibt es noch, die über SYS-Befehle anzuspringen sind.</p>

        <h3>SYS34647</h3>

        <p>zeichnet auf den Normalbildschirm einen schwarzen Rahmen mit einer Kopfzeile. Den Inhalt dieser Zeile können Sie verändern, indem Sie den neuen Inhalt in die Tabelle ($87FE bis &lsquo;$8830) einschreiben, durch Ein-POKEn des Commodore-ASCII-Codes ihres Textes. Nach dem Aufruf dieses Programmes ist die Zeichenfarbe Schwarz. Durch POKE 646, gewünschter Farbcode können Sie das schnell ändern.</p>

        <h3>SYS34865, Bit-Map-Start</h3>

        <p>Damit können Sie jede gewünschte Bit-Map per Drucker zu Papier bringen. Die Startadresse der Bit-Map ist in Hires-3 dez. 40960. Wenn dieser Befehl gegeben wird, während sich am Bildschirm die Hochauflösung tummelt, dann braucht die Bit-Map-Startadresse nicht angegeben werden.</p>

        <p>Zwei Wermutstropfen mischten sich in die freudige Anwendung dieser Hardcopy-Routine:</p>

        <p>Erstens muß sich irgendwo im Programm eine besonders gut versteckte Wanze (bug) befinden. Ich bin mir nicht einmal sicher, ob die Ursache nicht etwa im Druckerbetriebssystem versteckt liegt. Wenn man vor jedem Aufruf dieser Hardcopy-Routine den Drucker in die Ausgangsstellung bringt, durch OPENl,4,10:PRINT # 1:CLOSE1, dann funktioniert der Ausdruck fast fehlerfrei. Lediglich dann, wenn ganz links oben auf dem Bildschirm schon eine Information zu übermitteln ist, gibt der Drucker dort das Pi-Zeichen aus. Der Rest des Bildes ist einwandfrei.</p>

        <h2>Hardcopy für den Drucker 1526</h2>

        <p>Zweitens aber ist dieses Programm für den Commodore-Drucker 1526 erstellt worden. Jeder, der dieses Gerät besitzt, wird den Ärger mit den vielen verschiedenen Betriebssystemen des 1526 kennen. Vermutlich werden Sie gar nicht wissen, welches Sie nun in Ihrem Drucker haben. Da hilft nur eines: Probieren Sie mal den Aufruf der Hardcopy-Routine aus. Wenn’s funktioniert, dann haben Sie das richtige Betriebssystem, wenn nicht, dann wenden Sie sich doch mal vertrauensvoll an Manfred Böhmel, Am Töbele 2 in 7923 Königsbronn. Der hat meinen nicht grafikfähigen 1526 in ein mich zufriedenstellendes Gerät verwandelt. In Tabelle 5 sind die Startadressen aller Hires-3 Programmteile angegeben. In vielen Zeitschriften finden sich Maschinenprogramme für Hardcopies auf diversen Druckern. Sollten Sie solch ein Programm für Ihren Drucker finden, können Sie es leicht gegen das hier vorgestellte austauschen.</p>

        <p>Damit kennen Sie Hires-3 von der Anwendung her. In Listing 2 finden Sie wieder ein kleines Testprogramm, das alle neuen Funktionen überprüft (Bild 4 bis 7). Profis der Programmierung in Maschinensprache wird nun natürlich noch einiges interessieren: Welche Zeropage-Adressen benötigt Hires-3 und welche Adressen aus den Seiten 1-3? Welche Routinen werden aufgerufen? Wo findet man welche Programmteile? Um all diese Fragen zu klären, sind die Tabellen 1 bis 5 angefügt.</p>

        <figure>
            <img src="136-4.png" alt="">
            <figcaption>Bild 4. Das 1. Bild des Testprogramms.</figcaption>
        </figure>
        <figure>
            <img src="136-5.png" alt="">
            <figcaption>Bild 5. Das 2. Bild des Testprogramms.</figcaption>
        </figure>
        <figure>
            <img src="136-6.png" alt="">
            <figcaption>Bild 6. Das 3. Bild des Hires-3-Testprogramms</figcaption>
        </figure>
        <figure>
            <img src="136-7.png" alt="">
            <figcaption>Bild 7. Das letzte Bild des Hires-3-Testprogramms</figcaption>
        </figure>

        <p>Tabelle 1 gibt alle durch Hires-3 ausdrücklich verwendeten Zeropage-Adressen an. Ausdrücklich deshalb, weil im Rahmen von Interpreter- oder Betriebssystem-Routinen ebenfalls Zeropage-Adressen angesprochen werden, die aber hier nicht benannt sind (es handelt sich dann ja um die normale Ansprache dieser Speicherstellen, wie sie ständig auch vom herkömmlichen Basic aus geschieht). Die meisten Zeropage-Speicherplätze werden in derselben Weise benutzt, wie es Interpreter und Betriebssystem vorgeben. Nur dort, wo Hires-3 eine andere Bedeutung eingeführt, ist das dann angegeben. Die Seiten 1 bis 3 unseres Speichers bergen ebenfalls wichtige Parameter unseres Computers. Deshalb ist die Tabelle 2 angefügt, die Auskunft gibt über Aktivitäten von Hires-3 in diesem Bereich.</p>

        <figure>
            <table>
                <tbody>
                    <tr>
                        <th>Speicherstelle (hex.)</th>
                        <th>Normale Verwendung</th>
                        <th>Hires-3-Verwendung</th>
                    </tr>
                    <tr>
                        <td>01</td>
                        <td>Prozessor-Port</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>02</td>
                        <td>leer</td>
                        <td>DEEK-Ergebnis<br>Farbcodespeicher</td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td>Flagge: Sperren der Annahme von Integer- oder Feldvariablen</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>14/15</td>
                        <td>Zwischenspeicher für Adressen und Integers</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>22/23</td>
                        <td>Diverse Zeiger</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>24/25</td>
                        <td>Zwischenspeicher bei NEXT</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>26</td>
                        <td>Ergebnis bei Gleitkommarechungen (*,/)</td>
                        <td>Zwischenspeicher bei DUMP</td>
                    </tr>
                    <tr>
                        <td>2B/2C</td>
                        <td>Zeiger auf Basic-Start</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>’ 2D/2E</td>
                        <td>Zeiger auf Basic-Variablen-Start</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>2F/30</td>
                        <td>Zeiger auf Basic-Array-Start</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>37/38</td>
                        <td>Zeiger auf Basic-Speicher-Ende</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>3D/3E</td>
                        <td>Zeiger: Aktueller Basic-Befehl (für CONT)</td>
                        <td>Zwischenspeicher für RENUMBER</td>
                    </tr>
                    <tr>
                        <td>3F/40</td>
                        <td>Zeiger: Aktuelle DATA- Zeile</td>
                        <td>Zwischenspeicher für RENUMBER</td>
                    </tr>
                    <tr>
                        <td>41/42</td>
                        <td>Zeiger: Nächstes DATA- Element</td>
                        <td>Zwischenspeicher für RENUMBER</td>
                    </tr>
                    <tr>
                        <td>43/44</td>
                        <td>Zeiger Auswertung einer Eingabequelle (INPUT, GET, READ)</td>
                        <td>Zwischenspeicher für RENUMBER<br></td>
                    </tr>
                    <tr>
                        <td>45/46</td>
                        <td>Zeiger: Aktueller Basic-<br>Variablen-Name</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>47</td>
                        <td>Tabellenzeiger Zwischenspeicher</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>47/48</td>
                        <td>Zeiger: Aktueller Basic-Variablen-Wert</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>4E/4F</td>
                        <td>Zeiger: FN-Variable<br>Auch als Zwischenspeicher bei Gleitkommaoperationen</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td rowspan="2">57-5B<br>58/59</td>
                        <td>Fließkommaregister (Polynomauswertung, TAN)</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Diverse Zeiger</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>57/58</td>
                        <td></td>
                        <td>Ergebnis des UP 16-Bit-Multiplikation Diverse Zwischenspeicher</td>
                    </tr>
                    <tr>
                        <td>5C-60</td>
                        <td>Fließkommaregister (Zwischenspeicher Polynomauswertung)</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>5D,5F</td>
                        <td>Diverse Zähler und Flaggen (TI$, 16-Bit-Multiplik., STRFAC, FACSTR)</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>5F,60</td>
                        <td>Startadresse einer Programmzeile, Variablenverw., Stringtransfer</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>60</td>
                        <td>Vorzeichen des Exponenten</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>5C,5D</td>
                        <td></td>
                        <td>Ergebnis des UP 16-Bit-Division Diverse Zwischenspeicher</td>
                    </tr>
                    <tr>
                        <td>61-66</td>
                        <td>FAC</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>69-6E</td>
                        <td>ARG</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>7A/7B</td>
                        <td>CHRGET-Zeiger</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>8B-8F</td>
                        <td>Gleitkommawert der letzten RND-Zahl</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>8E,8F</td>
                        <td></td>
                        <td>UP 16-Bit-Division: Divisionsrest</td>
                    </tr>
                    <tr>
                        <td>B9</td>
                        <td>Aktuelle Sekundäradresse</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>C5</td>
                        <td>SCNKEY (Aktueller Wert des Tastatur-Matrixcodes) = gedrückte Taste</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>C6</td>
                        <td>Anzahl gültiger Zeichen im Tastaturpuffer</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>CB</td>
                        <td>Tastatur-Matrixcode, Zeiger in Decodierungstabelle für Tastatur</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>CE</td>
                        <td>Zeichen unter dem Cursor</td>
                        <td>Zwischenspeicher für RENUMBER</td>
                    </tr>
                    <tr>
                        <td>D1/D2</td>
                        <td>Zeiger: Aktueller Anfang der Cursor-Zeile im Bildschirm-RAM</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>D3</td>
                        <td>Cursorspalte innerhalb der Cursorzeile</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>FB-FE</td>
                        <td>leer</td>
                        <td>Diverse Zwischenspeicher und Zeiger</td>
                    </tr>
                    <tr>
                        <td colspan="3">Die Hires-3-Verwendung ist nur dann angegeben, wenn sie von der normalen Verwendung abweicht.</td>
                    </tr>
                </tbody>
            </table>
            <figcaption>Tabelle 1. Von Hires-3 verwendete Zeropage-Adressen</figcaption>
        </figure>

        <figure>
            <table>
                <tbody>
                    <tr>
                        <th>Speicherstelle (hex.)</th>
                        <th>Normale Verwendung</th>
                        <th>Hires-3-</b><br><b>Verwendung</th>
                    </tr>
                    <tr>
                        <th colspan="3">Page 1</th>
                    </tr>
                    <tr>
                        <td>101 und folgende</td>
                        <td>Prozessorstack (auch für Datenspeicherung bei FOR...NEXT und GOSUB</td>
                        <td>Zwischenspeicher für RENUMBER</td>
                    </tr>
                    <tr>
                        <th colspan="3">Page 2</th>
                    </tr>
                    <tr>
                        <td>277 ff.</td>
                        <td>Tastaturpuffer</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>288</td>
                        <td>Startseite der Videomatrix</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>28D</td>
                        <td>Flagge für Shift, Commodore</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>28F/290</td>
                        <td>Vektor: Tastaturabfrage</td>
                        <td>Wird verbogen auf 900B</td>
                    </tr>
                    <tr>
                        <td>2A7-2FF<br>2A7,2AF-2B5</td>
                        <td>leer</td>
                        <td>Diverse Zwischenspeicher und Zeiger</td>
                    </tr>
                    <tr>
                        <th colspan="3">Page 3</th>
                    </tr>
                    <tr>
                        <td>302/303</td>
                        <td>Vektor: Eingabewarteschleife (nach READY)</td>
                        <td>AUTONUMBER verbiegt nach $90BC und zurück zum Normalwert $A483</td>
                    </tr>
                    <tr>
                        <td>308/309</td>
                        <td>Vektor: Routinenaufruf (Interpreter)</td>
                        <td>Die Basic- Befehlserweiterungen verbiegen nach $9292 und zurück zum Normalwert $A7E4</td>
                    </tr>
                    <tr>
                        <td>314/315</td>
                        <td>IRQ-Vektor</td>
                        <td>UHR verbiegt nach $852D und zurück zum Normalwert $EA31</td>
                    </tr>
                    <tr>
                        <td colspan="3">Die Hires-3-Verwendung ist nur dann angegeben, wenn sie von der normalen Verwendung abweicht.</td>
                    </tr>
                </tbody>
            </table>
            <figcaption>Tabelle 2. Von Hires-3 verwendete Adressen der Seiten 1 bis 3</figcaption>
        </figure>

        <p>Einige Zeiger werden verbogen und durch Hires-3 auch wieder gerade gerückt. Das geschieht zum Beispiel mittels AUS oder aber spätestens bei RUN/ STOP und RESTORE.</p>

        <p>Tabelle 3 gibt einen Überblick über alle durch Hires-3 angesteuerten Interpreter-Routinen. Es wird jeweils die verwendete Einsprung-Adresse und die Bedeutung dieser Programmsegmente angegeben.</p>

        <figure>
            <table>
                <tbody>
                    <tr>
                        <th>Einsprungadresse (hex.)</th>
                        <th>Interpreter-Routine</th>
                    </tr>

                    <tr>
                        <td>A3BF</td>
                        <td>Block-Verschiebe-Routine</td>
                    </tr>
                    <tr>
                        <td>A437</td>
                        <td>Ausdruck einer Fehlermeldung und READY</td>
                    </tr>
                    <tr>
                        <td>A483</td>
                        <td>Eingabewarteschleife</td>
                    </tr>
                    <tr>
                        <td>A533</td>
                        <td>Neuberechnung des Linkpointers für Basic-Zeilen</td>
                    </tr>
                    <tr>
                        <td>A613</td>
                        <td>Berechnung der Startadresse einer Basic-Zeilennummer</td>
                    </tr>
                    <tr>
                        <td>A6S5</td>
                        <td>Zurücksetzen des CHRGET-Zeigers und Ausführen von CLR</td>
                    </tr>
                    <tr>
                        <td>A660</td>
                        <td>Ausführen von CLR</td>
                    </tr>
                    <tr>
                        <td>A68E</td>
                        <td>Zurücksetzen des CHRGET-Zeigers auf den Programmstart</td>
                    </tr>
                    <tr>
                        <td>A69C</td>
                        <td>LIST-Routine</td>
                    </tr>
                    <tr>
                        <td>A7AE</td>
                        <td>Interpreterschleife. Routinenaufruf</td>
                    </tr>
                    <tr>
                        <td>A7E7</td>
                        <td>Interpretation und Routinenaufruf, danach Interpreterschleife</td>
                    </tr>
                    <tr>
                        <td>A96B</td>
                        <td>Lesen eines Zeichens aus einer Basic-Textzeile und Umwandlung in 16-Bit-Integer</td>
                    </tr>
                    <tr>
                        <td>AB1E</td>
                        <td>Ausdrucken eines Strings</td>
                    </tr>
                    <tr>
                        <td>AD8A</td>
                        <td>Auswerten und Prüfen von Ausdrücken</td>
                    </tr>
                    <tr>
                        <td>AD9E</td>
                        <td>Auswerten von Ausdrücken</td>
                    </tr>
                    <tr>
                        <td>AEFD</td>
                        <td>Prüfen auf Komma</td>
                    </tr>
                    <tr>
                        <td>AF08</td>
                        <td>Ausdrucken von SYNTAX ERROR und Herstellen des READY-Zustandes</td>
                    </tr>
                    <tr>
                        <td>B113</td>
                        <td>Prüfung, ob Zeichen im Akku ein Buchstabe ist</td>
                    </tr>
                    <tr>
                        <td>B248</td>
                        <td>Ausdrucken von ILLEGAL QUANTITY ERROR und Herstellen des READY-Zustandes</td>
                    </tr>
                    <tr>
                        <td>B391</td>
                        <td>Umwandlung einer 16-Bit-Integer-Zahl in eine Gleitkommazahl</td>
                    </tr>
                    <tr>
                        <td>B3A2</td>
                        <td>Umwandlung einer 8-Bit-Integer-Zahl in eine Gleitkommazahl</td>
                    </tr>
                    <tr>
                        <td>B44F</td>
                        <td>Alten Wert der FN-Variablen wiederherstellen = Abschluß der FN-Auswertung</td>
                    </tr>
                    <tr>
                        <td>B6A3</td>
                        <td>Stringverwaltungsroutine</td>
                    </tr>
                    <tr>
                        <td>B79B</td>
                        <td>Liest eine Zahl zwischen 0 und 255 aus dem Basic-Text ins X-Register ein</td>
                    </tr>
                    <tr>
                        <td>B79E</td>
                        <td>Wertet einen numerischen Ausdruck (0 bis 255) aus</td>
                    </tr>
                    <tr>
                        <td>B7EB</td>
                        <td>Lesen einer Adresse und eines Bytes aus dem Basic-Text</td>
                    </tr>
                    <tr>
                        <td>B7F7</td>
                        <td>Lesen einer Adresse (0 bis 65535) aus dem Basic-Text</td>
                    </tr>
                    <tr>
                        <td>B850</td>
                        <td>Gleitkommasubtraktion, Variante 1</td>
                    </tr>
                    <tr>
                        <td>B853</td>
                        <td>Gleitkommasubtraktion, Variante 2</td>
                    </tr>
                    <tr>
                        <td>B867</td>
                        <td>Gleitkommaaddition</td>
                    </tr>
                    <tr>
                        <td>BA28</td>
                        <td>Gleitkommamultiplikation</td>
                    </tr>
                    <tr>
                        <td>BB05</td>
                        <td>Gleitkommadivision, Variante 1</td>
                    </tr>
                    <tr>
                        <td>BB0F</td>
                        <td>Gleitkommadivision, Variante 2</td>
                    </tr>
                    <tr>
                        <td>BBA2</td>
                        <td>Konstante in den FAC laden als Gleitkommazahl</td>
                    </tr>
                    <tr>
                        <td>BBD4</td>
                        <td>FAC abspeichern</td>
                    </tr>
                    <tr>
                        <td>BC0C</td>
                        <td>FAC nach ARG übertragen</td>
                    </tr>
                    <tr>
                        <td>BC2B</td>
                        <td>Vorzeichen der Gleitkommazahl im FAC prüfen</td>
                    </tr>
                    <tr>
                        <td>BC44</td>
                        <td>Umwandlung Integerzahl in Gleitkommazahl im FAC</td>
                    </tr>
                    <tr>
                        <td>BC5B</td>
                        <td>Zahlenvergleich FAC mit Konstante</td>
                    </tr>
                    <tr>
                        <td>BC9B</td>
                        <td>Umwandlung einer Gleitkommazahl in eine 4-Byte-Integerzahl</td>
                    </tr>
                    <tr>
                        <td>BDCD</td>
                        <td>Ausdruck der laufenden Zeilennummer</td>
                    </tr>
                    <tr>
                        <td>BDDD</td>
                        <td>Umwandlung des FAC-Inhaltes in einen Zahlenstring</td>
                    </tr>
                </tbody>
            </table>

            <figcaption>Tabelle 3. Von Hires-3 verwendete Interpreter-Routine</figcaption>
        </figure>

        <p>Aus zwei Gründen ist diese Tabelle interessant: Zum einen gibt sie Assembler-Programmierern eine kleine Orientierungshilfe für eigene Programme. Das kann in diesem Zusammenhang aber nur in relativ kurzer Form geschehen. Ausführlich wird zu einem späteren Zeitpunkt in der Serie »Assembler ist keine Alchimie« uns dieser ganze Komplex noch beschäftigen. Sie sind herzlich eingeladen, daran teilzunehmen.</p>

        <p>Zum anderen haben mich verschiedene Gerüchte erreicht, daß Commodore klammheimlich mehrere Änderungen des Betriebssystems und eventuell auch des Interpreters durchgeführt habe. Ich habe gerade ein neueres Betriebssystem untersucht, um die Unterschiede benennen zu können (siehe »Hokus-Pokus&hellip;« in dieser Ausgabe). Es könnte deswegen sein, daß im Falle eines Falles auch Routinen geändert wurden, die Hires-3 verwendet. Ob dadurch Fehlfunktionen auftreten und wenn ja, welche, kann man kaum vorhersagen — es kommt eben sehr auf die Art der Veränderungen an. Testläufe auf verschiedenen C 64 gaben keinen Hinweis darauf: Alles lief — wie bei mir — einwandfrei.</p>

        <p>Routinen aus dem oberen ROM-Bereich $E000 bis $FFFF, die Hires-3 anwendet, zeigt die Tabelle 4.</p>

        <figure>
            <table>
                <tbody>
                    <tr>
                        <th>Einsprungadresse (hex.)</th>
                        <th>ROM-Routine</th>
                    </tr>
                    <tr>
                        <td>E1D4</td>
                        <td>Parameter für LOAD, SAVE, VERIFY aus Basic-Text lesen</td>
                    </tr>
                    <tr>
                        <td>E264</td>
                        <td>Basic-Funktion COS</td>
                    </tr>
                    <tr>
                        <td>E26B</td>
                        <td>Basic-Funktion SIN</td>
                    </tr>
                    <tr>
                        <td>E716</td>
                        <td>Ausgabe eines Zeichens auf den Bildschirm</td>
                    </tr>
                    <tr>
                        <td>EA31</td>
                        <td>IRQ-Routine</td>
                    </tr>
                    <tr>
                        <td>EB42</td>
                        <td>Abschluß der Tastaturabfrage</td>
                    </tr>
                    <tr>
                        <td>EB48</td>
                        <td>Umschaltung auf Decodierungstabelle per Shift, Commodore, CTRL</td>
                    </tr>
                    <tr>
                        <td>F6ED</td>
                        <td>Abfrage der RUN/STOP-Taste</td>
                    </tr>
                    <tr>
                        <th colspan="2">Kernal-Routinen</th>
                    </tr>
                    <tr>
                        <td>FFBA</td>
                        <td>SETLFS: Festsetzung der Parameter für OPEN</td>
                    </tr>
                    <tr>
                        <td>FFBD</td>
                        <td>SETNAM: Festsetzung des File-Namens</td>
                    </tr>
                    <tr>
                        <td>FFC0</td>
                        <td>OPEN: Spezifiziertes File setzen</td>
                    </tr>
                    <tr>
                        <td>FFC3</td>
                        <td>CLOSE: File schließen</td>
                    </tr>
                    <tr>
                        <td>FFC9</td>
                        <td>CHKOUT: Vorbereitung der File-Ausgabe</td>
                    </tr>
                    <tr>
                        <td>FFCC</td>
                        <td>CLRCHN: Schließen der aktiven Ein-/Ausga- bekanäle</td>
                    </tr>
                    <tr>
                        <td>FFD2</td>
                        <td>CHROUT: Ausgabe des Akku-Inhaltes auf aktiven Ausgabekanal</td>
                    </tr>
                    <tr>
                        <td>FFD5</td>
                        <td>LOAD: Load und Verify von Programmen</td>
                    </tr>
                    <tr>
                        <td>FFD8</td>
                        <td>SAVE: Abspeichern von Programmen</td>
                    </tr>
                </tbody>
            </table>
            <figcaption>Tabelle 4. Von Hires-3 verwendete Routinen aus dem oberen ROM-Bereich</figcaption>
        </figure>

        <h2>ROM-Änderungen bei Commodore</h2>

        <p>Der untere Teil dieser Tabelle enthält die sogenannten Kernal-Sprungadressen. Für diesen Bereich garantiert Commodore, keine Änderungen durchzuführen. Leider — wie man aus dem vorangegangenen schnell ersehen kann — ist die Aufgabenvielfalt dieser Kernal-Adressen recht begrenzt. Man kommt ohne die anderen Routinen kaum aus.</p>

        <p>Es wäre ja mal etwas völlig Neues, wenn Commodore etwas Vergleichbares wie die Kernal-Adressen auch für Gleitkomma- und auch andere Operationen einrichten würde. Dem steht aber die allgemein bekannte Publikationsfreundlichkeit des Hauses Commodore entgegen.</p>

        <p>Im Gegensatz dazu sollen Sie Hires-3 geradezu durchleuchten können. Daher ist als Tabelle 5 noch eine Liste aller Teile von Hires-3 angegeben.</p>

        <figure>
            <table>
                <tbody>
                    <tr>
                        <th>Startadresse</th>
                        <th colspan="2">Unterprogramm</th>
                    </tr>
                    <tr>
                        <td>9000</td>
                        <td colspan="2">Belegung der Funktionstasten</td>
                    </tr>
                    <tr>
                        <td>909A</td>
                        <td colspan="2">Autonumber</td>
                    </tr>
                    <tr>
                        <td>916B</td>
                        <td colspan="2">Old</td>
                    </tr>
                    <tr>
                        <td>91BA</td>
                        <td colspan="2">Merge</td>
                    </tr>
                    <tr>
                        <td>927A</td>
                        <td colspan="2">Basic-Befehlserweiterungen</td>
                    </tr>
                    <tr>
                        <td>93E7</td>
                        <td>DEEK</td>
                        <td>PEEK für RAM unter ROM</td>
                    </tr>
                    <tr>
                        <td>9410</td>
                        <td colspan="2">16-Bit-Multiplikation</td>
                    </tr>
                    <tr>
                        <td>9434</td>
                        <td colspan="2">16-Bit-Division</td>
                    </tr>
                    <tr>
                        <td>9522</td>
                        <td>FAR</td>
                        <td>Farbgebung für Hochauflösungsbild</td>
                    </tr>
                    <tr>
                        <td>9546</td>
                        <td>LOE</td>
                        <td>Bit-Map löschen</td>
                    </tr>
                    <tr>
                        <td>955D</td>
                        <td>HAN</td>
                        <td>Hochauflösung an</td>
                    </tr>
                    <tr>
                        <td>9572</td>
                        <td>HOF</td>
                        <td>Hochauflösung aus</td>
                    </tr>
                    <tr>
                        <td>9587</td>
                        <td>HFL</td>
                        <td>Kombination aus HAN, FAR und LOE</td>
                    </tr>
                    <tr>
                        <td>9590</td>
                        <td>PKT</td>
                        <td>Punkt setzen</td>
                    </tr>
                    <tr>
                        <td>961C</td>
                        <td>LIN</td>
                        <td>Linie zeichnen</td>
                    </tr>
                    <tr>
                        <td>97D2</td>
                        <td>REC</td>
                        <td>Rechteck zeichnen</td>
                    </tr>
                    <tr>
                        <td>9888</td>
                        <td>BLO</td>
                        <td>Rechteck ausfüllen</td>
                    </tr>
                    <tr>
                        <td>98FA</td>
                        <td>CIR</td>
                        <td>Ellipse (Kreis) zeichnen</td>
                    </tr>
                    <tr>
                        <td>99E8</td>
                        <td>RAD</td>
                        <td>Radiusvektor zeichnen</td>
                    </tr>
                    <tr>
                        <td>9A74</td>
                        <td>PAU</td>
                        <td>Pause machen</td>
                    </tr>
                    <tr>
                        <td>9AC4</td>
                        <td>HIS</td>
                        <td>Hochauflösungsbild extern abspeichern</td>
                    </tr>
                    <tr>
                        <td>9AE8</td>
                        <td>HIL</td>
                        <td>Hochauflösungsbild einladen</td>
                    </tr>
                    <tr>
                        <td>9AF7</td>
                        <td>LPK</td>
                        <td>Punkt löschen</td>
                    </tr>
                    <tr>
                        <td>9AFF</td>
                        <td>LLN</td>
                        <td>Linie löschen</td>
                    </tr>
                    <tr>
                        <td>9B07</td>
                        <td>LRE</td>
                        <td>Rechteck löschen</td>
                    </tr>
                    <tr>
                        <td>9B0F</td>
                        <td></td>
                        <td>Ausgefülltes Rechteck löschen</td>
                    </tr>
                    <tr>
                        <td>9B17</td>
                        <td>LKR</td>
                        <td>Ellipse (Kreis) löschen</td>
                    </tr>
                    <tr>
                        <td>9BlF</td>
                        <td>LRA</td>
                        <td>Radiusvektor löschen</td>
                    </tr>
                    <tr>
                        <td>9B27</td>
                        <td>TRS</td>
                        <td>Transformation</td>
                    </tr>
                    <tr>
                        <td>9BA6</td>
                        <td><b>TPK</b></td>
                        <td>Punkt in transformiertes System zeichnen</td>
                    </tr>
                    <tr>
                        <td>9C0B</td>
                        <td>TLN</td>
                        <td>Linie in transformiertes System zeichnen</td>
                    </tr>
                    <tr>
                        <td>9CEB</td>
                        <td>TRE</td>
                        <td>Rechteck in transformiertes System zeichnen</td>
                    </tr>
                    <tr>
                        <td>8000</td>
                        <td>TBK</td>
                        <td>Ausgefülltes Rechteck in transformiertes System zeichnen</td>
                    </tr>
                    <tr>
                        <td>80E0</td>
                        <td>TKR</td>
                        <td>Ellipse (Kreis) in transformiertes System zeichnen</td>
                    </tr>
                    <tr>
                        <td>814C</td>
                        <td>TRA</td>
                        <td>Radiusvektor in transformiertes System zeichnen</td>
                    </tr>
                    <tr>
                        <td>81B8</td>
                        <td>LTP</td>
                        <td>Punkt im transformierten System löschen</td>
                    </tr>
                    <tr>
                        <td>81C0</td>
                        <td>LTL</td>
                        <td>Linie im transformierten System löschen</td>
                    </tr>
                    <tr>
                        <td>81C8</td>
                        <td>LTR</td>
                        <td>Rechteck im transformierten System löschen</td>
                    </tr>
                    <tr>
                        <td>81D0</td>
                        <td>LTB</td>
                        <td>Ausgefülltes Rechteck im transformierten System löschen</td>
                    </tr>
                    <tr>
                        <td>81D8</td>
                        <td>LTK</td>
                        <td>Ellipse (Kreis) im transformierten System löschen</td>
                    </tr>
                    <tr>
                        <td>81E0</td>
                        <td>LTV</td>
                        <td>Radiusvektor im transformierten System löschen</td>
                    </tr>
                    <tr>
                        <td>81E8</td>
                        <td colspan="2">Renumber</td>
                    </tr>
                    <tr>
                        <td>83DA</td>
                        <td>DUMP</td>
                        <td>Anzeige aller einfachen Variablen</td>
                    </tr>
                    <tr>
                        <td>849D</td>
                        <td>UHR</td>
                        <td>Anzeige einer Uhrzeit</td>
                    </tr>
                    <tr>
                        <td>85B8</td>
                        <td>FUNKT</td>
                        <td>Zeichnen einer vorher definierten Funktion im transformierten System</td>
                    </tr>
                    <tr>
                        <td>874F</td>
                        <td>LFUNK</td>
                        <td>Löschen einer vorher definierten<br>Funktion im transformierten System</td>
                    </tr>
                    <tr>
                        <td>8757</td>
                        <td colspan="2">Rahmen mit Kopfzeile</td>
                    </tr>
                    <tr>
                        <td>87FE-8830</td>
                        <td colspan="2">Texttabelle für Kopfzeile</td>
                    </tr>
                    <tr>
                        <td>8831</td>
                        <td colspan="2">Hardcopy des Hochauflösungsbildes auf Drucker Commodore 1526</td>
                    </tr>
                    <tr>
                        <td></td>
                    </tr>
                </tbody>
            </table>
            <figcaption>Tabelle 5. Die einzelnen Routinen von Hires-3</figcaption>
        </figure>

        <p>Sollten Sie bei der Gelegenheit noch Bugs (Programmfehler) finden, dann würde ich mich über Information darüber freuen. Außerdem sollen Sie durch einige schwächere Programmteile animiert werden, sich bessere Lösungen auszudenken. Da gibt es viele Möglichkeiten. Veröffentlichungen — denke ich — können hervorragend dazu dienen, daß jeder etwas neues lernen kann, Anregungen für seine eigenen Programme erhält, etc.</p>

        <p>In Hires-3 sind viele solcher Anregungen verarbeitet. Als besonders hilfreich haben sich erwiesen:</p>

        <ol>
            <li>Schneider, Ebert »Das Commodore 64-Buch«, Band 1, Markt &amp; Technik Verlag</li>
            <li>»Computerspiele und Wissenswertes, Commodore 64«, Markt &amp; Technik Verlag</li>
            <li>Angerhausen, Englisch, Gerits, »64 Tips &amp; Tricks«, Data Becker</li>
            <li>H.-J. Kutz, mc6 (1984) S. 78f.</li>
        </ol>


        <p>Murphys Gesetze gehen natürlich nicht an so einer guten Gelegenheit wie Hires-3 vorbei. Wenn ich also weiter oben sagte, ich würde mich freuen, wenn Sie noch Bugs entdecken, ist das durchaus erst gemeint.</p>

        <p>Ich benütze Hires-3 in dieser Form seit mehreren Monaten ausgiebig. Dasselbe tun einige meiner Freunde. Einer hat festgestellt, daß — aus welchen Gründen auch immer — sich Probleme ergeben können, wenn man direkt nach der Zeilennummer einen Doppelpunkt eingibt. Ich habe bisher noch keine Notwendigkeit gefunden, so etwas zu tun.</p>

        <p>Sollten Sie’s vorhaben oder aber gewohnt sein, dann achten Sie auf mögliche Störungen. Ein selten benutztes Programm-Segment hat mir in letzter Minute noch einen Fehler offenbart. Es geht um eine Fehlermeldung bei falscher Eingabe des FUNKT-Befehls. Anstelle einer 8 ist da ein B hineingerutscht. Der Fehler ist schnell behoben durch diesen POKE:<br>
            POKE34249,8</p>

        <p>Geben Sie diese Anweisung ein, bevor Sie mittels SMON das gesamte Hires-3 abspeichern, dann ist alles in Ordnung.</p>

        <p>Nun wünsche ich Ihnen viel Vergnügen mit Hires-3. Testen Sie, probieren sie, verbessern Sie&hellip; In den nächsten Ausgaben werden in lockerer Reihenfolge weitere Grafik-Artikel erscheinen, in denen auf die praktische Anwendung von Grafik besonderer Wert gelegt wird. Ich werde dabei dann Hires-3 als Grundlage verwenden. Falls Sie noch besondere Wünsche oder Fragen haben sollten, dann melden Sie sich doch einfach mal.</p>

        <p>Ich versuche dann die interessantesten und wichtigsten Fragen im 64’er zu beantworten.</p>

        <address class="author">(Heimo Ponnath/gk)</address>

        <figure>
            <!-- TODO <pre data-filename="hir.2$8000-89b6.prg" data-name="Hires 3, 2. Teil"></pre> -->
            <figcaption>Listing 1. Hires 3, 2. Teil. Dieses Programm muß mit dem MSE (als Listing in dieser Ausgabe) eingegeben werden</figcaption>
        </figure>
        <figure>
            <pre data-filename="hires-3_2-test" data-name="Hires-3 Test"></pre>
            <figcaption>Listing 2. Mit diesem Programm testen Sie Hires-3</figcaption>
        </figure>
        <div class="binary_download" data-filename="hires-3.prg" data-name="Hires-3"></div>
    </article>
</body>

</html>