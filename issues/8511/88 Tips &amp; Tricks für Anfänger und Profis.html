<!DOCTYPE html>
<html lang="de">

<head>
    <title>Tips &amp; Tricks für Anfänger und Profis</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../style.css">
    <meta name="author" content="Karlheinz Boss, Wolfgang Horak, Michael Schmidt, Guido Schuhmacher, Thomas Uttendorfer, tr">
    <meta name="64er.issue" content="11/85">
    <meta name="64er.pages" content="88-90,95">
    <meta name="64er.head1" content="Tips und Tricks">
    <meta name="64er.head2" content="C 64">
    <!-- <meta name="64er.toc_title" content="Screen-Dump"> -->
    <meta name="64er.toc_category" content="Tips und Tricks">
    <!-- <meta name="64er.toc_title" content="Pseudo-Interrupt"> -->
    <!-- <meta name="64er.toc_category" content="Tips und Tricks"> -->
    <!-- <meta name="64er.toc_title" content="Listschutz für Basic-Programme"> -->
    <!-- <meta name="64er.toc_category" content="Tips und Tricks"> -->
    <!-- <meta name="64er.toc_title" content="Sichere Input-Routine in Basic"> -->
    <!-- <meta name="64er.toc_category" content="Tips und Tricks"> -->
    <!-- <meta name="64er.toc_title" content="Synthetische Melodien"> -->
    <!-- <meta name="64er.toc_category" content="Tips und Tricks"> -->
    <!-- <meta name="64er.toc_title" content="Super-Pokes"> -->
    <!-- <meta name="64er.toc_category" content="Tips und Tricks"> -->
    <!-- <meta name="64er.toc_title" content="Sichere Input-Routine in Basic"> -->
    <!-- <meta name="64er.toc_category" content="Misch-Masch"> -->
    <meta name="64er.index_title" content="Versch. Routinen für Anfänger und Profis">
    <meta name="64er.index_category" content="Software-Tips|Tips & Tricks">
    <meta name="64er.id" content="tips_tricks">
</head>

<body>
    <article>
        <h1>Tips &amp; Tricks für Anfänger und Profis</h1>
        <p class="intro">In der Rubrik Tips &amp; Tricks können wir Ihnen diesmal einige Routinen anbieten, die sich besonders zum Einbau in eigene Programme eignen.</p>

        <h2>Screen-Dump</h2>

        <p>Eine Bildschirmmaske kann auf viele verschiedene Arten auf den Bildschirm gebracht werden. Die einfachste ist wohl:
            <code>FOR I = 0 T0 999 : POKE 1024 + I, PEEK (STADR + I) : NEXTI</code>
            wobei STADR die Startadresse der Maske ist. Doch das ist zu langsam und eintönig. Das gleiche Programm in Assembler ist zirka 200 mal schneller, aber immer noch eintönig.</p>

        <p>Das Programm »Screen-Dump« (siehe Listing 1) hilft dem ab. Auf über 100 verschiedene Arten kann hiermit das oben genannte Programm ablaufen (das heißt 100 verschiedene Reihenfolgen), von denen einige verblüffen, fast alle aber besser »aussehen« als dieses Programm. Auch die verstellbare Geschwindigkeit ermöglicht interessante Veränderungen.</p>

        <p>Die Handhabung ist denkbar einfach:
            <code>SYS 680, Art, Stadr., Geschwindigkeit</code>
        </p>

        <ul class="plain">
            <li>Art: Eine Zahl zwischen 0 und 127</li>
            <li>Stadr: Die Startadresse der Maske geteilt durch 256 (Highbyte).</li>
            <li>Geschwindigkeit: zwischen 1 und 255 verstellbar.</li>
        </ul>

        <p>Also SYS 680, 20, 64, 8 kopiert den Bereich von 16384 bis 17383 auf sehr originelle Weise in den Bildschirm.</p>

        <p>Andere »schöne Versionen« sind:</p>

        <table class="plain right">
            <tr class="separator"><td>Art</td><td>Geschw.</td><td>Art</td><td>Geschw.</td></tr>
            <tr><td>2</td><td>1</td><td>6</td><td>4</td></tr>
            <tr><td>9</td><td>4</td><td>13</td><td>8</td></tr>
            <tr><td>19</td><td>2</td><td>20</td><td>8</td></tr>
            <tr><td>28</td><td>8</td><td>33</td><td>4</td></tr>
            <tr><td>36</td><td>10</td><td>44</td><td>4</td></tr>
            <tr><td>46</td><td>20</td><td>61</td><td>20</td></tr>
            <tr><td>64</td><td>4</td><td>65</td><td>10</td></tr>
            <tr><td>66</td><td>4</td><td>84</td><td>4</td></tr>
            <tr><td>88</td><td>2</td><td>98</td><td>8</td></tr>
            <tr><td>104</td><td>4</td><td>106</td><td>2</td></tr>
            <tr><td>120</td><td>20</td><td>125</td><td>20</td></tr>
        </table>

        <h3>Funktionsweise</h3>

        <p>Wie funktioniert Screen-Dump, wo es doch nur 100 Byte lang ist? Am besten ist das an folgendem Beispiel zu erkennen: Wir nehmen eine Gruppe von zwölf Elementen. Wie greift man nun nacheinander auf alle zwölf Elemente zu, so daß keine Reihenfolge erkennbar wird? Ganz einfach:</p>

        <p>Wir nehmen eine Zahl, die mit 12 keinen gemeinsamen Teiler hat, zum Beispiel 5. Jetzt beginnen wir bei 0 und zählen 5 hinzu. Diese Zahl nehmen wir heraus. Dann zählen wir wieder 5 hinzu. Ergebnis 10. Unser zweites Element. Dann wieder + 5 = 15. Element 15 ist nicht vorhanden, also ziehen wir die Gesamtanzahl der Elemente ab. 15—12=3 und so weiter. Es ergibt sich die Reihenfolge: 5 10 3 8 1 6 11 4 9 2 7 12. Augenscheinlich völlig wahllos. Es funktioniert immer, wenn folgende Voraussetzungen erfüllt sind:</p>

        <ol>
            <li>Die Additionszahl (hier: 5) muß kleiner sein als die Gesamtzahl der Menge.</li>
            <li>Die Additionszahl darf mit der Gesamtzahl keinen gemeinsamen Teiler haben.</li>
        </ol>


        <p>Im Screen-Dump wird dieses System mit einer Menge von 1&thinsp;024 Elementen angewandt. Die möglichen Additionszahlen sind somit alle ungeraden Zahlen zwischen 0 und 255.</p>

        <address class="author">(Michael Schmidt/tr)</address>

        <figure>
            <pre data-filename="screen-dump" data-name="Screen-Dump"></pre>
            <figcaption>Listing 1, »Screen-Dump«, mit dem Checksummer
                eingeben.</figcaption>
        </figure>

        <h2>Pseudo-Interrupt</h2>

        <p>Diese Befehlserweiterung erlaubt es, ein Basic-Programm zu jedem beliebigen Zeitpunkt per Tastendruck durch die F1-Taste unterbrechen zu lassen. Es kann dann in eine vorher definierte Basic-Routine gesprungen werden. Diese könnte zum Beispiel den noch freien Speicherplatz oder die Uhrzeit anzeigen.</p>

        <p>Das Programm (Listing 2) bitte mit dem MSE eingeben. Es liegt dann im Speicherbereich von 40499 bis 40768. Geladen wird es absolut mit LOAD "PSEUDO-IRQ",8,1. Da das Programm im Bereich für die Basic-Variablen steht, muß es durch POKE 56,158:CLR vor Überschreiben geschützt werden. Nach dem Start durch »SYS 40541« stehen die neuen Befehle zur Verfügung:</p>

        <ul class="plain">
            <li>!F1JUMP <Zeilennummer> legt fest, in welche Zeile im Falle einer Unterbrechung durch die F1-Taste gesprungen werden soll. Tritt der Befehl mehrmals auf, so gilt die zuletzt angegebene Zeilennummer.</li>
            <li>!JBACK bewirkt die Fortsetzung des Basic-Programms ab der Stelle, an der unterbrochen wurde.</li>
            <li>!SF1 verhindert Unterbrechungen. Dies kann zum Beispiel beim Aufbau einer Grafik oder bei Arbeiten mit der Diskettenstation wichtig sein.</li>
            <li>!CF1 läßt gesperrte Unterbrechungen wieder zu.</li>
        </ul>

        <address class="author">(Guido Schuhmacher/tr)</address>

        <figure>
            <pre data-filename="pseudo-irq.prg" data-name="Pseudo-IRQ" data-mse=mse1></pre>
            <figcaption>Listing 2. »Pseudo-IRQ«. Bitte mit dem MSE eingeben.</figcaption>
        </figure>
        <div class="binary_download" data-filename="pseudo-irq.prg" data-name="Pseudo-IRQ"></div>

        <h2>List-Schutz für Basic-Programme</h2>

        <p>Dieser List-Schutz ist für Nichteingeweihte sehr verblüffend. Die Grundidee dazu stammt aus dem Bericht »Disketten-Manipulationen« aus 64’er, Ausgabe 6/85. Er wurde jedoch etwas ausgebaut, so daß hier beim Listen alle Steuercodes aktiv werden. Dies wird dadurch erreicht, daß man in eine Speicherstelle vor den Codes die Zahl 141 schreibt. Um nun ein Programm zu schützen, lädt man es und gibt folgende zwei Zeilen ein:</p>

        <figure>
            <pre data-filename="list-schutz" data-name="List-Schutz"></pre>
        </figure>

        <p>Danach gibt man im Direktmodus POKE 2067,71 : POKE 2073,141 : POKE 2118,0 : POKE 2119,0 ein und speichert das Programm.</p>

        <p>Listet man nun das Programm, so wird der Bildschirm gelöscht und der Text in der REM-Zeile ausgegeben. Durch das künstlich erzeugte Basic-Programm-Ende-Zeichen (drei Nullen) wird das Listen abgebrochen. Wird im Programm dann auch noch durch POKE 788,52 die RUN-STOP-, und durch POKE 792,193 die RESTORE-Taste ausgeschaltet, kann keiner mehr an das Programm. Aufheben läßt sich dieser List-Schutz nur mit einem Monitor und mit der Kenntnis der Funktionsweise des Schutzes.</p>

        <address class="author">(Thomas Uttendorfer/tr)</address>

        <h2>Sichere INPUT-Routine in Basic</h2>

        <p>Ich habe bisher immer eine leistungsfähige INPUT-Routine in Basic vermißt. Das ging anscheinend nicht nur mir so, denn in einigen abgedruckten Programmen (zum Beispiel Ligatab, Listing des Monats, 3/85) fehlt eine solche Routine, was zu chaotischen Ergebnissen führen kann. (Wenn man zum Beispiel aus Versehen an Stelle der Shift-Taste die Crsr-Down-Taste gedrückt hat, so nützt es dem Anwender wenig, wenn er mit der Crsr-Up-Taste wieder in das Eingabefeld zurückkehrt, weil jetzt der INPUT-Befehl die ganze Zeile als Eingabe ansieht.) Deshalb hier eine INPUT-Routine, die folgende Vorteile hat:</p>

        <ol type="a">
            <li>Da die Routine (Listing 3) in Basic geschrieben ist, ist sie für jeden Programmierer leicht verständlich und abänderbar,</li>
            <li>Der Programmierer kann beim Aufruf der Routine gleich Ort, mini- und maximale Länge und die zulässigen Zeichen der Eingabe festlegen.</li>
            <li>Jedes Zeichen wird gleich bei der Eingabe auf seine »Richtigkeit« überprüft.</li>
            <li>Es wird nur die tatsächliche Eingabe als Eingabe übernommen (und nicht noch eventuell Teile der Maske).</li>
            <li>Es funktionieren noch sämtliche Sonderfunktionstasten (inst, del, home, clr und so weiter).</li>
            <li>Der Anwender kann das Eingabefeld nicht verlassen.</li>
            <li>Die Routine ist mit 1,5 KByte relativ kurz.</li>
        </ol>

        <p>Benutzung der Routine:</p>

        <ol type="a">
            <li>Setzen des Parameterstrings</li>
            <li>Aufruf mit gosub 60000</li>
            <li>Übergabe von in$ an gewünschte Variable</li>
        </ol>

        <p>Der Parameterstring:</p>

        <p class="noindent">Er setzt sich zusammen aus:</p>

        <table class="plain">
            <tr><td>Stelle 1,2</td><td>Zeile der Eingabe</td></tr>
            <tr><td>Stelle 3,4</td><td>Spalte der Eingabe</td></tr>
            <tr><td>Stelle 5,6</td><td>minimale Länge der Eingabe</td></tr>
            <tr><td>Stelle 7,8</td><td>maximale Länge der Eingabe</td></tr>
            <tr><td>Stelle 9</td><td>Code (siehe weiter unten)</td></tr>
        </table>

        <p>Es ist darauf zu achten, daß einstellige Angaben (zum Beispiel: 3. Zeile) mit 03 angegeben werden, da sonst keine klare Trennung der einzelnen Parameter vorgenommen werden kann.</p>

        <p>Die Routine sieht Standardwerte für die minimale und maximale Länge und für den Code der Eingabe vor (Zeile 60200). Diese können natürlich frei nach eigenem Bedarf eingerichtet werden. Entspricht die geforderte Eingabe den Standardwerten, so braucht der Programmierer beim Setzen des Parameterstrings diese Werte nicht anzugeben, sondern nur noch Zeile und Spalte. Dies führt natürlich zu einer weiteren Vereinfachung (Beispiel: pa$ = "0510", das heißt Eingabe in Zeile 5 ab Spalte 10 mit den Standardwerten).</p>

        <p class="noindent">Code (c)</p>

        <p>Der Code dient dazu, die eingegebenen Zeichen sofort zu überprüfen. Selbstverständlich kann auch er frei programmiert werden. In Zeile 60490 wird entsprechend dem Code in die Unterprogramme verzweigt. Dort wird die gedrückte Taste überprüft. Entspricht sie nicht dem Code, wird f1 auf 1 gesetzt.</p>

        <p>In der vorliegenden Routine sind Code 1 bis 4 schon programmiert, wobei</p>

        <ul class="plain">
            <li>1 bedeutet, daß nur Zahlen</li>
            <li>2 bedeutet, daß nur Buchstaben</li>
            <li>3 bedeutet, daß alles</li>
            <li>4 bedeutet, daß nur Kleinbuchstaben</li>
        </ul>

        <p class="noindent">zulässig sind.</p>

        <p>Diese Codes oder auch neue Codes können spielend leicht geändert oder neu programmiert werden.</p>

        <p>Funktionen der Sondertasten:</p>

        <table class="plain">
            <tr><td>CRSR UP,CRSR DOWN</td><td>sind abgeschaltet</td></tr>
            <tr><td>INST,DEL</td><td>funktionieren innerhalb des Eingabefensters wie gewohnt (Rest der Maske wird nicht berührt)</td></tr>
            <tr><td>HOME</td><td>springt an Anfang des Eingabefensters</td></tr>
            <tr><td>CLR</td><td>löscht Eingabefenster und springt an den Anfang desselben</td></tr>
            <tr><td>CRSR LEFT,RIGHT</td><td>funktionieren wie gewohnt, nur Eingabefeld kann nicht verlassen werden.</td></tr>
        </table>

        <address class="author">(Karlheinz Boss/tr)</address>

        <figure>
            <pre data-filename="input-routine" data-name="Input-Routine"></pre>
            <figcaption>Listing 3. Die bedienungssichere Input-Routine mit eingebautem Demo.</figcaption>
        </figure>

        <h2>Synthetische Melodien</h2>

        <p>Das wahrscheinlich kürzeste und erstaunlichste Musiksynthesizer-Sequencer-Programm, das je veröffentlicht wurde. Es handelt sich um ein 47 Byte langes Assemblerprogramm, das im Listing 4, in Form eines DATA-Laders vorliegt. Die Melodie und die Klangfarbe kann man über die Speicherstellen 1022 und 1023 einstellen. Dabei kommt es allerdings nur auf die Differenz der beiden Byte an. Es empfiehlt sich also, die Speicherstelle 1022 mit 0 zu belegen und für 1023 alle Werte von 0 bis 128 auszuprobieren.</p>

        <p>Melodische Tonfolgen erreicht man mit POKE 1023,7 + 8*n, wobei n eine ganze Zahl zwischen 0 und 16 sein darf. Effektvolle Klänge erreicht man zum Beispiel über folgende Werte (POKE 1023,&hellip;): 11, 28, 62, 96, 130.</p>

        <h3>Funktionsweise</h3>

        <p>Zuerst werden Kurven- und Wellenform festgelegt. Die beiden Speicherinhalte von 1022 und 1023 werden erhöht beziehungsweise erniedrigt. Dann werden sie miteinander durch die AND-Funktion verknüpft. Das Ergebnis kommt ins High-Byte des Tonhöhenregisters. Eine kleine Warteschleife macht die Komposition hörbar.</p>

        <address class="author">(Wolfgang Horak/tr)</address>

        <figure>
            <pre data-filename="synth.melodien" data-name="Synthetische Melodien"></pre>
            <figcaption>Listing 4 »Synthetische Melodien«. Bitte mit dem Checksummer eingeben.</figcaption>
        </figure>

        <h2>Die Super-POKEs</h2>

        <p>POKE 792,226: POKE 793,252</p>

        <p>Sobald die RESTORE-Taste gedrückt wird, wird ein Reset ausgelöst.</p>

        <p class="noindent">POKE 774,226: POKE 775,252</p>

        <p>Sobald der LIST-Befehl eingetippt wird, wird ein Reset ausgelöst.</p>

        <p class="noindent">POKE 818,226: POKE 819,252</p>

        <p>Sobald der SAVE-Befehl eingetippt wird, wird ein RESET ausgelöst.</p>

        <address class="author">(tr)</address>

        <h2>Tips &amp; Tricks — Mischmasch</h2>

        <p>Und hier noch ein paar Kleinigkeiten für die Tips &amp; Tricks-Sammlung:</p>

        <ul>
            <li>Neustart eines Basic-Programms nach Drücken von RUN-STOP-RESTORE:
                <code>1 DATA 169, 49, 141, 20, 3, 76, 113, 168
                    2 FOR I=700 T0 707: READ A: POKE I,A: NEXT
                    3 POKE 770,188: POKE 771,2
                </code>
                <p>Einzige Bedingung ist, daß Ihr Programm eine Zeile 0 enthält, da der Interpreter einen RUN 0-Befehl ausführt.</p>
            </li>
            <li>Nachladen von Datasette mit Autostart:
                <code>POKE 56335,2</code>
                <p>Dem Betriebssystem wird vorgegaukelt, daß SHIFT-RUN-STOP gedrückt wäre.</p>
            </li>
            <li>Nützliche SYS-Adressen:
                <ul class="plain">
                    <li>43121: entspricht dem Befehl RUN 0</li>
                    <li>42039: Ausgabe von Fehlermeldungen. Im X-Register des Prozessors muß die Fehlernummer stehen (Speicherstelle Nummer 781).</li>
                    <li>64763: RESET, ohne Initialisierung der Vektoren (IRQ etc.).</li>
                </ul>
            </li>
        </ul>

        <address class="author">(tr)</address>
    </article>
</body>

</html>