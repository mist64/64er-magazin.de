<!DOCTYPE html>
<html lang="de">

<head>
    <title>29 Druckerbefehle für Epson</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../style.css">
    <meta name="author" content="Olaf Amblank, gk">
    <meta name="64er.issue" content="Sonderheft 4/85">
    <meta name="64er.pages" content="36-37">
    <meta name="64er.toc_category" content="Basic-Erweiterung">
    <meta name="64er.id" content="epson29">
    <meta name="64er.head1" content="Basic-Erweiterung">
</head>

<body>
    <article>
        <h1>29 Druckerbefehle für Epson</h1>
        <p class="intro">Oft ist es recht mühsam, die vielen Fähigkeiten der Epson-Drucker auszunutzen. »Epson 29« macht das ständige Nachschlagen im Handbuch überflüssig.</p>

        <p>Diese kurze, aber doch recht wirkungsvolle Erweiterung ermöglicht es auf einfachste Weise, Steuercodes an einen Epson-Drucker zu senden. Es belegt den freien RAM-Bereich zwischen den Speicherzellen 50000 und 50503, und arbeitet auch mit dem Centronics-Interface, das Sie in dieser Äusgabe finden, zusammen. Doch hier zuerst eine alphabetisch geordnete Übersicht:</p>

        <table class="plain">
            <tr><td>←A</td><td>— Adresse: ←A, gefolgt von einer Zahl, legt fest, über welchen Kanal die folgenden Kommandos zum Drucker gesendet werden sollen. Beispiel: ←A4, die nachfolgenden Befehle werden über Kanal 4 zum Drucker geschickt. Wird dieser Befehl nicht gesendet, geht der Computer davon aus, daß Sie Kanal 1 benutzen.</td></tr>
            <tr><td>←B</td><td>— Breitschrift an</td></tr>
            <tr><td>←D</td><td>— Doppeldruck an</td></tr>
            <tr><td>←E</td><td>— Eliteschrift an</td></tr>
            <tr><td>←F</td><td>— Fettdruck an</td></tr>
            <tr><td>←G</td><td>— Glocke, sendet Bell-Code an Drucker, um zum Beispiel den Druckbeginn akustisch anzukündigen.</td></tr>
            <tr><td>←I</td><td>— Indexschrift an</td></tr>
            <tr><td>←K</td><td>— Kursivschrift an</td></tr>
            <tr><td>←L</td><td>— Linken Rand setzen. Beispiel: — L15 setzt linken Rand auf die 15. Druckposition.</td></tr>
            <tr><td>←N</td><td>— unidirektionaler Ausdruck (verbessert Qualität des Schriftbildes).</td></tr>
            <tr><td>←O</td><td>— Potenzieren an</td></tr>
            <tr><td>←P</td><td>— Pica an</td></tr>
            <tr><td>←R</td><td>— Rechten Rand setzen (parallel zu «- L)</td></tr>
            <tr><td>←S</td><td>— Schmalschrift an</td></tr>
            <tr><td>←U</td><td>— Unterstreichen an</td></tr>
            <tr><td>←6</td><td>— Zeilenabstand auf 1/6 Zoll</td></tr>
            <tr><td>←7</td><td>— Zeilenabstand auf 1/72 Zoll</td></tr>
            <tr><td>←8</td><td>— Zeilenabstand auf 1/8 Zoll</td></tr>
            <tr><td>←2</td><td>— Zeilenabstand auf n/216 Zoll. Beispiel: ←2 159 setzt Zeilenabstand auf 159/216 Zoll.</td></tr>
            <tr><td>←@</td><td>— Drucker-Reset</td></tr>
            <tr><td>←0B</td><td>— Breitschrift aus</td></tr>
            <tr><td>←0D</td><td>— Doppeldruck aus</td></tr>
            <tr><td>←0F</td><td>— Fettdruck aus</td></tr>
            <tr><td>←0I</td><td>— Indizieren aus</td></tr>
            <tr><td>←0K</td><td>— Kursivschrift aus</td></tr>
            <tr><td>←0N</td><td>— unidirektionaler Druck aus</td></tr>
            <tr><td>←0O</td><td>— Potenzieren aus</td></tr>
            <tr><td>←0S</td><td>— Schmalschrift aus</td></tr>
            <tr><td>←0U</td><td>— Unterstreichmodus aus</td></tr>
        </table>

        <p>Als Kennzeichen für einen neuen Befehl steht ein Pfeil nach links (Taste in der linken oberen Ecke der Tastatur). Anstelle dieses Pfeiles kann man jedoch auch ein anderes Zeichen verwenden (zum Beispiel»!«), indem man in die Speicherzelle 50020 den ASCII-Wert dieses Zeichens POKEt. Falls Sie einen nicht definierten Wert senden, dies wäre zum Beispiel ←*, gibt der Computer die Fehlermeldung »PRINTER COMMAND ERROR« aus.</p>

        <h3>Hier noch zwei weitere Vorteile des Programms:</h3>

        <ol>
            <li>Die Befehle sind bis zu 6mal schneller. Um auf Breitschrift umzuschalten, benötigt der C 64 mittels CHR$-Codes zirka 0,013 Sekunden, mit dem Befehl — B sind es nur noch 0,002 Sekunden.<br>
                . 2. Der Basic-Speicherplatzbedarf ist wesentlich geringer! So benötigt das Demoprogramm 1 (Listing 2) im Vergleich zu dem in Standard-Basic geschriebenen Demoprogramm 2 (Listing 3) 66 Bytes weniger, dies sind nur 57% des benötigten Speicherplatzes von Listing 2.</li>
        </ol>


        <p>Ich empfehle Ihnen zum besseren Verständnis, sich einmal die Listings der Demoprogramme anzuschauen, um den Umgang mit den neuen Befehlen kennenzulernen.</p>

        <h3>Achtung:</h3>

        <p>Wenn einem Druckerbefehl kein PRINT#-Befehl folgt (eigentlich unlogisch, denn warum sollte man einen Befehl an den Druckersenden, wenn man gar nichts ausdrucken will?), . befindet man sich im CMD-Modus. Angenommen, Sie geben ←F und danach LIST ein, erscheint das Listing auf dem Drucker statt auf dem Bildschirm.</p>

        <p>Wollen Sie einen dieser neuen Befehle innerhalb einer IF&hellip;THEN-Schleife verwenden, so müssen Sie nach THEN einen Doppelpunkt setzen (Beispiel: IF A=1 THEN:←S)</p>

        <p>Haben Sie den Basic-Lader eingetippt, können Sie das Programm als reinen Maschinencode auf Diskette oder Kassette abspeichern; geben Sie dazu folgendes im Direktmodus ein:</p>

        <p>POKE 43,80</p>

        <p>POKE 44,195</p>

        <p>POKE 45,22</p>

        <p>POKE 46,197</p>

        <p>SAVE "DRUCKERBEF.MC",8,1 (für Diskette)</p>

        <p>oder</p>

        <p>SAVE "DRUCKERBEF.MC",1,1 (für Kassette)</p>

        <address class="author">(Olaf Amblank/gk)</address>

        <figure>
            <pre data-filename="epson29.prg" data-name="29 Druckerbefehle" data-mse=mse1></pre>
            <figcaption>Listing 1. 29 Druckerbefehle.</figcaption>
        </figure>
        <div class="binary_download" data-filename="epson29.prg" data-name="29 Druckerbefehle"></div>

        <figure>
            <pre data-filename="demo 1" data-name="Demo 1"></pre>
            <figcaption>Listing 2. Demo mit Druckerkurzbefehlen</figcaption>
        </figure>
        <figure>
            <pre data-filename="demo2" data-name="Demo 2"></pre>
            <figcaption>Listing 3. Demo mit normalen Druckerbefehlen</figcaption>
        </figure>
    </article>
</body>

</html>
