<!DOCTYPE html>
<html lang="de">

<head>
    <title>Hypra-Load</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../style.css">
    <meta name="author" content="Ernst Schöberl, aw, bs, Karsten Schramm, bs">
    <meta name="64er.issue" content="Sonderheft 6/85">
    <meta name="64er.pages" content="10,94-97">
    <meta name="64er.toc_category" content="Hilfsprogramm">
    <meta name="64er.toc_title" content="Hypra-Load (64’er, 11/84)<br>Die Floppy fünfmal schneller machen beim Laden von Programmen">
    <meta name="64er.head1" content="Hilfsprogramm">
    <meta name="64er.head2" content="C 64">
    <meta name="64er.id" content="hypra-load">
</head>

<body>
    <article>
        <h1>Hypra-Load</h1>
        <p class="intro">Ist Ihnen die 1541 zu langsam? Wollen Sie nicht mehrere hundert Mark für ein Hardware-Beschleunigungssystem ausgeben? Dann sind Hypra-Load und Hypra-Save genau das richtige für Sie, denn diese Programme machen das Laufwerk bis zu fünfmal schneller. Für dieses Sonderheft wurde das beliebte Hypra-Load sogar völlig neu geschrieben und verbessert!</p>

        <figure>
            <img src="10-4.png" alt="">
        </figure>

        <p class="intro">Kaffeepause! Dieses Wort kommt wohl jedem Commodore 64-Besitzer in den Sinn, der ein längeres Programm laden möchte. Es geht aber fünfmal schneller. Alles, was Sie benötigen ist das Programm »Hypra-Load« oder das neue Betriebssystem »Hypra-Perfekt«.</p>

        <p>Das die Floppy 1541 nicht gerade die schnellste ist, ist wohl allgemein bekannt. Zumindest ein Vorgang läßt sich mit relativ geringem Aufwand stark beschleunigen: das Laden von Programmen.</p>

        <p>Das Funktionsprinzip von Hypra-Load sieht folgendermaßen aus. Im Computer wie auch im Floppy-Laufwerk werden neue Laderoutinen installiert, die neue Busroutinen enthalten. Mit diesen neuen Busroutinen wird die Datenübertragung um den Faktor 8 bis 10 beschleunigt, so daß die Ladegeschwindigkeit auf das softwaremäßig erreichbare Maximum gebracht wird.</p>

        <p>Eine Software-Lösung hat allerdings zwei entscheidende Nachteile: Einerseits muß vor dem schnellen Laden die neue LOAD-Routine in den Speicher gebracht werden, andererseits funktionieren manche Originalprogramme mit Kopierschutz nicht mehr. Diese Nachteile wurden bei den beiden hier vorgestellten Versionen so gut wie möglich umgangen.</p>

        <p>»Hypra-Load 2.1« ist eine besonders komfortable Hypra-Load-Version mit integriertem Auto-Starter und Auto-Lader. Sie wurde von den Autoren des original »Hypra-Load« (aus der 64’er, Ausgabe 10/85) völlig neu geschrieben. Dies dürfte wohl die beste Lösung für diejenigen sein, die sich kein neues Betriebssystem in ein EPROM brennen wollen oder können.</p>

        <p>»Hypra-Perfekt« ist ein solches Betriebssystem. Neben den schnellen Lade-Routinen sind hier auch eine Funktionstastenbelegung und einige andere Extras eingebaut.</p>

        <h2>Hypra-Load</h2>

        <p>Um Hypra-Load beim späteren Betrieb möglichst komfortabel zu halten, ist die Eintipparbeit etwas komplizierter. Sie benötigen als allererstes eine leere Diskette, die Sie am besten formatieren. Nun tippen Sie das Listing 1 mit dem MSE ab und speichern es auf genau dieser leeren Diskette. Sie sollten keinesfalls probieren, auf eine Diskette zu speichern, auf der schon Programme stehen, weil diese beim nächsten Schritt unrettbar verloren gehen!</p>

        <p>Nun tippen Sie das kurze Listing 2 ab. Legen Sie die Diskette, auf der sich das gespeicherte MSE-Listing befindet, ein und starten Sie das Basic-Programm. Nach wenigen Sekunden meldet sich der Computer mit READY. Nun ist Ihre Hypra-Load-Version fertig. Um sie auf andere Disketten zu überspielen, können Sie jedes beliebige Kopierprogramm für Einzelfiles verwenden. Die Disketten, auf die Hypra-Load dann kopiert werden soll, dürfen ruhig schon Programme enthalten, es müssen aber insgesamt fünf Blöcke auf der Diskette frei sein, damit noch Platz für Hypra-Load ist.</p>

        <p>Wie arbeitet man nun mit Hypra-Load? Es gibt zwei Betriebsarten: In der normalen Betriebsart lädt man Hypra-Load mit LOAD":* ",8,1. Daraus folgt, daß es das erste Programm auf der Diskette sein muß! Hypra-Load installiert sich dann vollautomatisch, ohne daß RUN eingetippt werden muß, und meldet sich mit den Namen der Autoren. Ab sofort wird von Diskette fünfmal schneller geladen. Zusätzlich sind als Standardwerte für den LOAD-Befehl »,8,1« schon fest vorgegeben. »LOAD-"name"« lädt also immer von Diskette.</p>

        <p>Bei einem Reset schaltet sich Hypra-Load ab, ebenso wenn wichtige Speicherbereiche überschrieben werden und somit ein Systemabsturz provoziert wird.</p>

        <p>Viel interessanter und komfortabler, Hypra-Load zu nutzen, ist allerdings die zweite Methode. Wenn Hypra-Load sich zusammen mit anderen Programmen auf einer Diskette befindet, genügt der Befehl »LOAD"↑*name",8,1« um mehrere Vorgänge gleichzeitig in Gang zu setzen: Hypra-Load wird geladen und gestartet, danach wird vollautomatisch das Programm mit dem Namen »name« schnell nachgeladen und ebenfalls gestartet. Voraussetzung dabei ist, daß die Hypra-Load-Version auf der Diskette genau mit dem im MSE-Listing angegebenen Namen (»↑Hypra-Load«) gespeichert ist.</p>

        <p>Einige Anmerkungen zum Auto-Lader: Nach der Installation von Hypra-Load wird überprüft, ob der aktuelle Filename mit einem "↑" (Pfeil nach oben) beginnt. Dann werden die ersten beiden Buchstaben vom Filenamen abgetrennt und das gewünschte Programm nachgeladen. Nach dem Laden desaktiviert sich Hypra-Load sofort und startet das geladene Programm durch Simulation des RUN-Befehls. Mehrteilige Programme laufen also ab dem zweiten Teil in der normalen Ladegeschwindigkeit ab. Für die meisten Anwendungsfälle ist diese Lösung allerdings vollkommen befriedigend.</p>

        <p>Diese Hypra-Load-Version läuft unserer Erfahrung nach sowohl auf C 64- wie auch SX 64-Computern und dem C 128 im 64-er Modus. Als Laufwerke sind die 1541 und die 1571 von Commodore verwendbar.</p>

        <p>Der Bildschirm bleibt während des Ladevorgangs ausgeschaltet, da sonst der VIC-Chip die schnellen Bus-Routinen aus dem Takt bringen würde. Das Blinken der roten Laufwerks-LED ist völlig normal, es zeigt jeweils einen übertragenen Programmblock an. Damit läßt sich optisch die Arbeit von Hypra-Load verfolgen.</p>

        <p>Weitere, am seriellen Bus angeschlossene, Geräte dürften die Übertragung nicht stören. Solange Hypra-Load aktiviert ist, führen Kassetten-Zugriffe zum System-Absturz!</p>

        <p>Soll Hypra-Load abgeschaltet werden, genügt die Befehlsfolge »POKE 1,55«.</p>

        <p>Der VERIFY-Befehl funktioniert nicht bei aktiviertem Hypra-Load.</p>

        <p>Für diejenigen, die sich für die Programmierung des Autostarts von Hypra-Load interessieren: Er wurde durch Verbiegen des Stop-Vektors realisiert.</p>

        <address class="author">(Karsten Schramm/bs)</address>

        <h2>Hypra-Perfekt</h2>

        <p>Unsere zweite Hypra-Load-Version ist eine Betriebssystem-Version. Das Original-Betriebssystem des Commodore 64 wird durch ein modifiziertes Betriebssystem ersetzt, welches die schnellen Lade-Routinen sowie eine Funktionstastenbelegung enthält.</p>

        <p>Somit muß das Kernal-ROM ausgetauscht werden. Als neuer Programmträger dient ein 2764-EPROM, dessen Inhalt mit dem nachfolgend abgedruckten Programm (Listing 3) erzeugt wird. Wie das von statten geht, läßt sich mit wenigen Worten erklären. Das Betriebssystem (Kernal) des Commodore 64 befindet sich im Speicherbereich von $E000 bis $FFFF und hat somit die Länge von 8 KByte. Das gesamte Kernal als MSE-Listing abzudrucken würden den Rahmen des Sonderheftes sprengen. Dies wäre auch gar nicht notwendig, daja nur Teile des Betriebssystems geändert werden. Deswegen haben wir die Form des, dank des MSEs etwas altmodischen, aber hier angebrachten DATA-Laders gewählt.</p>

        <p>Das abgedruckte Programm kopiert zunächst das Kernal in den Speicherbereich von $6000 bis $7FFF. Wer einen anderen Speicherbereich verwenden möchte, muß die Leseschleife in Zeile 30 on den Offset-Wert in Zeile 15 (OF) verändern.</p>

        <p>Nach dem Kopieren befindet sich ein originalgetreues Abbild des Kernals im RAM. Der nächste Schritt, der automatisch vom Programm durchgeführt wird, ist die Veränderung der einzelnen Speicherstellen. Ist dieser Vorgang beendet, steht unser neues Kernal von $6000 bis $7FFF im Speicher und sollte sofort mit einem Monitor abgespeichert werden. Danach kann man es dann auf ein 2764-EPROM brennen.</p>

        <p>Bis hierhin war alles relativ einfach, jetzt aber kommt die schwierigste Hürde auf dem Weg zum neuen Betriebssystem. Ein Adaptersockel muß gebaut werden, denn leider sind die Pin-Belegungen des Original-Kernals und des 2764-EPROMS nicht identisch. Wer sich diese Arbeit nicht machen möchte, der kann diesen Adaptersockel im 64’er-Hardware-service demnächst auch kaufen. Sollten Sie schon eine Kernal-Umschaltplatine besitzen, wie wir sie ebenfalls anbieten werden, entfällt der Bastelaufwand für Sie ebenfalls.</p>

        <p>Wer sich nun den Sockel selber bauen will, oder muß, der besorge sich einen 24poligen und einen 28poligen Sockel. Das Bild 1 zeigt, welche Pins der Sockel miteinander verbunden werden müssen. Nach der Fertigstellung sieht das Ganze wie ein Doppeldecker-Bus mit überhängendem Dach aus. Im oberen Stockwerk dieses Busses nimmt nun der 2764 mit dem neuen Betriebssystem seinen Platz ein. Die 24 Pins des unteren Fahrwerks finden im Steckplatz U4 des Computers ihre Heimat. Das überhängende Dach zeigt, zusammen mit der Kerbe des EPROMs, in Richtung des User-Ports.</p>

        <figure>
            <table class="plain">
                <tbody>
                    <tr class="strong">
                        <td>28poliger Sockel</td>
                        <td>24poliger Sockel</td>
                    </tr>
                    <tr>
                        <td>1,28,27,26</td>
                        <td>24</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>21</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>1</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>2</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>3</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>4</td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>5</td>
                    </tr>
                    <tr>
                        <td>8</td>
                        <td>6</td>
                    </tr>
                    <tr>
                        <td>9</td>
                        <td>7</td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td>8</td>
                    </tr>
                    <tr>
                        <td>11</td>
                        <td>9</td>
                    </tr>
                    <tr>
                        <td>12</td>
                        <td>10</td>
                    </tr>
                    <tr>
                        <td>13</td>
                        <td>11</td>
                    </tr>
                    <tr>
                        <td>14,20</td>
                        <td>12</td>
                    </tr>
                    <tr>
                        <td>15</td>
                        <td>13</td>
                    </tr>
                    <tr>
                        <td>16</td>
                        <td>14</td>
                    </tr>
                    <tr>
                        <td>17</td>
                        <td>15</td>
                    </tr>
                    <tr>
                        <td>18</td>
                        <td>16</td>
                    </tr>
                    <tr>
                        <td>19</td>
                        <td>17</td>
                    </tr>
                    <tr>
                        <td>20,14</td>
                        <td>12</td>
                    </tr>
                    <tr>
                        <td>21</td>
                        <td>19</td>
                    </tr>
                    <tr>
                        <td>22</td>
                        <td>20</td>
                    </tr>
                    <tr>
                        <td>23</td>
                        <td>18</td>
                    </tr>
                    <tr>
                        <td>24</td>
                        <td>22</td>
                    </tr>
                    <tr>
                        <td>25</td>
                        <td>23</td>
                    </tr>
                    <tr>
                        <td>1,28,27,26</td>
                        <td>24</td>
                    </tr>
                </tbody>
            </table>
            Pin 1 eines jeden Sockels ist links von der Kerbe, Pin 24 beziehungsweise 28 ist rechts davon.
            <figcaption>Bild 1. Das Verbindungsschema für den Adaptersockel</figcaption>
        </figure>

        <p>Sollte sich der Computer nach dem Einschalten mit geändertem Farbbild, aber sonst gewohnter Anzeige melden, haben Sie es geschafft. Ihnen steht nun eine recht leistungsfähige Hypra-Load-Version zur Verfügung. Neben dem Schnell-lade-System wurden noch die Funktionstasten belegt. Die Belegung können Sie Bild 2 entnehmen. Das Laden eines Direc-torys zerstört nicht mehr das aktuelle Programm im Speicher.</p>

        <figure>
            <ul class="plain">
                <li>F1 = LOAD”$”,8 ohne Programmverlust</li>
                <li>F2 = LOAD</li>
                <li>F3 = LIST</li>
                <li>F4 = SAVE</li>
                <li>F5 = RUN</li>
                <li>F6 = SYS64738</li>
                <li>F7 = OPEN1,8,15,</li>
                <li>F8 = CLOSE1</li>
                <li>SHIFT &amp; RUN/STOP lädt und startet das erste Programm von der Diskette</li>
            </ul>
            <figcaption>Bild 2. Die Belegung der Funktionstasten</figcaption>
        </figure>

        <p>Um die Kompatibilität zu fertigen Softwareprodukten möglichst groß zu halten, wurde auch hier eine Abschaltautomatik installiert. Sollte schnelles Laden nicht mehr möglich sein, wird auf langsames Laden umgestellt. Wenn diese Automatik versagt, kann das schnelle Laden auch von Hand abgeschaltet werden. Die Speicherstelle 2 ist zum Steuerregister umfunktioniert worden. Die einzelnen Funktionen von Hypra-Perfekt lassen sich folgendermaßen schalten:</p>

        <p>POKE 2,0: Grundzustand von Hypra-Perfekt, alles eingeschaltet<br>
            POKE 2,32: Funktionstasten abschalten<br>
            POKE 2,64: Directory wieder normal laden<br>
            POKE 2,128: Schnelles Laden abschalten.</p>

        <p>Natürlich sind auch Kombinationen möglich, so zum Beispiel »POKE 2,32+64+128« schaltet alle Funktionen ab.</p>

        <p>Besitzer eines Hypra-Perfekt-Kernals müssen, sofern Sie keine Umschaltplatine besitzen, leider auf die Kassetten-Routinen verzichten. Die RS232-Schnittstelle ist aber voll erhalten geblieben.</p>

        <p>Wer seine individuelle Farbkombination beim Einschalten haben möchte, braucht nur in den Zeilen 50 bis 70 die Farbwerte zu ändern.</p>

        <p>Und viel Spaß mit »Hypra-Perfekt«.</p>

        <address class="author">(Ernst Schöberl/aw/bs)</address>

        <figure>
            <pre data-filename="^  hypra-load  ^.prg" data-name="Hypra-Load 2.1" data-mse=mse1></pre>
            <figcaption>Listing 1. »Hypra-Load 2.1«. Bitte beachten Sie die Hinweise im Text und die Eingabehinweise auf Seite 18.</figcaption>
        </figure>
        <div class="binary_download" data-filename="^  hypra-load  ^.prg" data-name="Hypra-Load 2.1"></div>

        <figure>
            <pre data-filename="hypra-load hilfs" data-name="Hypra-Load 2.1 Hilfsprogramm"></pre>
            <figcaption>Listing 2. Hilfsprogramm zur Erstellung von »Hypra-Load 2.1«. Bitte beachten Sie die Hinweise im Text!</figcaption>
        </figure>

        <figure>
            <pre data-filename="hypra-perfekt" data-name="Hypra-Perfekt"></pre>
            <figcaption>Listing 3. Programm zur Erstellung von »Hypra-Perfekt«</figcaption>
        </figure>


        <aside class="fehlerteufelchen" id="fehlerteufelchen">
            <h2>Fehlerteufelchen</h2>

            <p>Im Listing (Hypra-Load 2.1) ist eine MSE-Zeile vergessen worden. Es handelt sich um folgende Zeile:</p>
            <pre>1200: b8 ad 01 1c c5 24 f0 09 a6</pre>
            <!-- 64'er 12/1985 -->
        </aside>
    </article>
</body>

</html>
